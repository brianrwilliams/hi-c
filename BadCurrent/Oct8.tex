\documentclass[10pt]{amsart}

\usepackage{macros,slashed}

\linespread{1.25}

\def\sAd{\sA{\rm d}}

\usepackage[final]{pdfpages}

\setcounter{tocdepth}{3}

\title{New title}

\def\brian{\textcolor{blue}{BW: }\textcolor{blue}}
\def\owen{\textcolor{magenta}{OG: }\textcolor{magenta}}

\def\opp{{\rm op}}
\def\Ch{{\rm Ch}}
\def\dgLie{{\rm dgLie}}
\def\Lcat{L_\infty{\rm Alg}}
\def\Cur{{\rm Cur}}


\begin{document}
\maketitle
\tableofcontents

%\chapter{Local symmetries of holomorphic theories}\label{chap: symmetries}

\owen{Obviously we'll write a new intro when we know what we want to accomplish in this paper.}

In this chapter we investigate the symmetries that generic holomorphic quantum field theories possess.
Our overarching goal is to develop tools for understanding such symmetries that provide a systematic generalization of methods used in chiral conformal field theory on Riemann surfaces, especially for the Kac-Moody and Virasoro vertex algebras \cite{IgorKM, KacVertex, BorcherdsVertex}. 
We will utilize the tools of BV quantization and factorization algebras that have already heavily percolated this thesis.
The primordial example of a holomorphic theory we consider is the holomorphic $\sigma$-model studied in the previous chapter. 

We will focus on two main types of symmetries: holomorphic gauge symmetries and symmetries by holomorphic diffeomorphisms (or holomorphic reparametrizations). 
An ordinary gauge symmetry is characterized as being local on the spacetime manifold. 
Each of the types of symmetries we consider share this characteristic, but they also enjoy an additional structure: they are holomorphic (up to homotopy) on the spacetime manifold. 
This means that they are specific to the type of theories we consider.
Moreover, they store more information about the geometry of the underlying manifold as compared to the smooth version of such symmetries.

Infinitesimally speaking, a symmetry is encoded by the action of a Lie algebra.
For the holomorphic gauge symmetry this will become a sort of current algebra which is equivalent to holomorphic functions on the complex manifold with values in a Lie algebra.
For the holomorphic diffeomorphisms this Lie algebra is that of holomorphic vector fields.
Locality implies that this actually extends to a symmetry by a sheafy version of a Lie algebra. 
The precise sheafy version we mean is called a {\em local Lie algebra}, which we will recall in the main body of the text. 
To every local Lie algebra we can assign a factorization algebra through the so-called enveloping factorization algebra:
\[
\mathbb{U} : {\rm Lie}_X \to {\rm Fact}_X .
\]
Here, ${\rm Lie}_X$ is the category of local Lie algebras.
By this construction, we see that the Lie algebra of symmetries of a theory define a factorization algebra on the manifold where the theory lives. 

One compelling reason for constructing a factorization algebra model for Lie algebras encoding the symmetries of a theory is that it allows one to consider universal versions of such objects.
There is a variation of the definition of a factorization algebra that lives, in some sense, on the entire category of manifolds (or complex manifolds). 
Such a perspective has been developed in great generality by Ayala-Francis in \cite{AFTopMan}.
In the case of the symmetry by a current algebra on Riemann surfaces a universal version of the Kac-Moody has been studied in \cite{CG1}.
For the case of conformal symmetry our work in \cite{BWVir} provides a factorization algebra lift of the ordinary Virasoro vertex algebra that exists uniformly on the site of Riemann surfaces. 
In this chapter, we extend each of these objects to arbitrary complex dimensions.
Our formulation lends itself to an explicit computation of the factorization homology along certain complex manifolds, for which we will focus on a class of examples called {\em Hopf manifolds}.

Studying such local symmetries involves rich geometric input even at the classical level, but the skeptical mathematician may view this as a repackaging of already familiar objects in complex geometry.
The main advantage of working with factorization algebra analogs of such symmetries is in their relationship to studying quantizations of field theories.
A similar obstruction deformation theory for studying quantizations of classical field theories also allows us to study the problem of {\em quantizing} the action of a (local) Lie algebra on a theory.
Moreover, we already know that factorization algebras describe the operator product expansion of the observables of a QFT.
A formulation of Noether's theorem in Chapter 12 of \cite{CG2} makes the relationship between the associated factorization algebra corresponding to a symmetry and the factorization algebra of observables of the theory.

Of course, quantizing a symmetry of a field theory may not always exist.
In fact, this failure sheds light into subtle field theoretic phenomena of the underlying system. 
For example, in the case of conformal symmetries of a conformal field theory, the failure is exactly measured by the {\em central charge} of the theory. 
It is well established that the central charge is a very important invariant associated to a conformal field theory.
At the Lie theoretic level, this failure is measured by a cocycle which in turn defines a central extension of the Lie algebra. 
It is this central extension that acts on the theory. 

For this reason, an essential aspect of studying the local symmetries of holomorphic field theories we mentioned above is to characterize the possible cocycles that give rise to central extensions. 
As we have already mentioned, for vector fields in complex dimension one this is related to the central charge and the central extension of the Witt algebra (vector fields on the circle) known as the Virasoro Lie algebra.
In the case of a current algebra associated to a Lie algebra, central extensions are related to the {\em level} and the corresponding central extensions are called affine algebras. 

\begin{thm}\label{thm: chap3 1}
The following is true about the local Lie algebras associated to holomorphic diffeomorphisms and holomorphic gauge symmetries.
\begin{enumerate}
\item Let $\fg$ be a Lie algebra and $\fg^X$ is associated current algebra defined on any complex manifold $X$. 
There is an embedding of the cohomology $H^*_{Lie}(\fg , \Sym^{d+1} g^\vee [-d-1])$ inside of the local cohomology of $\fg^X$.
\item There is an isomorphism between the local cohomology of holomorphic vector fields on any complex manifold $X$ of dimension $d$ and $H_{dR}^*(X) \tensor H^*_{GF}(\W_d)[2d]$, where  $H^*_{GF}(\W_d)$ is the Gelfand-Fuks cohomology of vector fields on the formal disk.
\end{enumerate}
\end{thm}

The central extensions we are interested in come from classes of degree $+1$ of the above local Lie algebras.
In the case of holomorphic vector fields the result above implies that all such extensions are parametrized by $H^{2d+1}(\W_d)$. 
It is a classical result of Fuks \cite{Fuks} that this cohomology is isomorphic to $H^{2d+2}(BU(d))$. 
In complex dimension one this cohomology is one dimensional corresponding to the class $c_1^2$. 
In general, we obtain new classes, which are shown to agree with calculations in the physics 
literature in dimensions four and six. 

In general, any of these cohomology classes define factorization algebras by twisting the enveloping factorization algebra. 
We especially focus on this construction in the case that the complex $d$-fold is equal to affine space $\CC^d$, or some natural open submanifolds thereof.
In the case of the current algebra, our result is compatible with recent work of Kapranov et. al. in \cite{FHK} where they study higher dimensional versions of affine algebras, and their relationship to the (derived) moduli space of $G$-bundles in an analogous way that affine algebras are related to the moduli of bundles on curves via Kac-Moody uniformization.  
Our second main result shows how to recover these higher affine algebras from our factorization algebra on punctured affine space $\CC^d \setminus\{0\}$, see Theorem \ref{thm sphere alg}.

The extensions of part (1) of Theorem \ref{thm: chap3 1} are related to cohomology classes in the moduli of $G$-bundles on complex $d$-folds.
We will show how techniques in equivariant BV quantization lead to natural families of QFTs defined over formal neighborhoods in the moduli space of $G$-bundles. 
Our techniques allow us to study quantizations of such families, in particular there are anomalies to quantization. 
An explicit analysis of Feynman diagrams leads to a computation of certain classes in the local cohomology which we relate to Chern classes of natural line bundles on ${\rm Bun}_G(X)$.
This leads us to our next main result which is to prove a version of the Grothendieck-Riemann-Roch (GRR) theorem using the aforementioned methods of BV quantization, see Theorem \ref{thm ggrr}.

%\begin{thm}
%Let $V$ be a finite dimensional $\fg$-module and $X$ any compact affine complex manifold. 
%There exists a BV quantization of the $\beta\gamma$-system on $X$ with values in $V$ that is equivariant for the local Lie algebra $\fg^X$. 
%Moreover, the first Chern class of the line bundle on $B \fg^X$ defined by the factorization homology of the quantization is equal to
%\[
%c_1(\Obs^\q(X)) = C \ch_{d+1}(V) \in \Sym^{d+1}(\fg^\vee)^\fg 
%\]
%where $C$ is some nonzero number.
%\end{thm}

\section{Current algebras on complex manifolds}

This paper takes general definitions and constructions from \cite{CG1} and specializes them to the context of complex manifolds.
In this subsection we will review some of the key ideas but refer to \cite{CG1} for foundational results.

\owen{In the introduction (or somewhere else TBD), we should explain that while the symmetries of the fields and action functional are encoded by a sheaf of Lie algebras, the associated observables/operators (under a Noether-type relationship) for a (pre)cosheaf. This is a simple consequence of the fact that observables are covariant in spacetime while fields are contravariant.}

\owen{The following appear later but I think it would fit more naturally here or in the intro}

Let us recall the familiar complex one-dimensional case that we wish to extend. 
Let $\Sigma$ be a Riemann surface, and let $\fg$ be a simple Lie algebra with Killing form $\kappa$.
Consider the local Lie algebra $\sG_\Sigma = \Omega^{0,*}_c(\Sigma) \tensor \fg$ on $\Sigma$.
There is a natural cocycle depending precisely on two inputs:
\[
\theta( \alpha \otimes M, \beta \otimes N) = \kappa(M,N) \, \int_\Sigma \alpha \wedge \partial \beta  ,
\]
where $\alpha, \beta \in \Omega^{0,*}_c(\Sigma)$ and $M,N \in \fg$.
In Chapter 5 of \cite{CG1} it is shown how the twisted enveloping factorization of $\sG_X$ via this cocycle recovers the Kac-Moody vertex algebra and the affine algebra extending $L\fg = \fg[z,z^{-1}]$.


\subsection{Local Lie algebras}

\brian{fix these
...
The factorization algebras we study in this paper all arise from Lie algebras that are sufficiently local on the manifold in an analogous way that associative algebras arise from Lie algebras via the universal enveloping construction.
...
We recall some definitions that we will use throughout the paper.
The first concept we introduce is that of a {\em local Lie algebra}. 
This is the central object needed to discuss symmetries of field theories that are local on the spacetime manifold. 
}

A key notion for us is a sheaf of Lie algebras on a smooth manifold.
These often appear as infinitesimal automorphisms of geometric objects,
and hence as symmetries in classical field theories.

\begin{dfn} 
A {\em local Lie algebra} on a smooth manifold $X$ is 
\begin{itemize}
\item[(i)] a $\ZZ$-graded vector bundle $L$ on $X$ of finite total rank;
\item[(ii)] a degree 1 operator $\ell_1:\sL^{sh} \to \sL^{sh}$ on the sheaf $\sL^{sh}$ of smooth sections of~$L$, and
\item[(iii)] a degree 0 bilinear operator
\[
\ell_2 : \sL^{sh} \times \sL^{sh} \to \sL^{sh}
\]
\end{itemize}
such that $\ell_1^2 = 0$, $\ell_1$ is a differential operator, and $\ell_2$ is a bidifferential operator, and
\[
\ell_1(\ell_2(x,y)) = \ell_2(\ell_1(x), y) + (-1)^{|x|} \ell_2(x, \ell_1(y))
\]
for any sections $x,y$ of $\sL^{sh}$.
We call $\ell_1$ the {\em differential} and $\ell_2$ the {\em bracket}.
\end{dfn}

In other words, a local Lie algebra is a sheaf of dg Lie algebras 
where the underlying sections are smooth sections of a vector bundle and 
where the operations are local in the sense of not enlarging support of sections. 
(As we will see, such Lie algebras often appear by acting naturally on the local functionals from physics, namely functionals determined by Lagrangian densities.)

\begin{rmk}
For a local Lie algebra, we reserve the more succinct notation $\sL$ to denote the precosheaf of {\em compactly supported} sections of $L$,
which assigns a dg Lie algebra to each open set $U \subset X$, 
since the differential and bracket respect support.
At times we will abusively refer to $\sL$ to mean the data determining the local Lie algebra,
when the support of the sections is not relevant to the discussion at hand.
\end{rmk}

The key examples for this paper all arise from studying the symmetries of holomorphic principal bundles.
We begin with the specific and then examine a modest generalization.

Let $\pi : P \to X$ be a holomorphic principal $G$-bundle over a complex manifold.
We use $\ad(P) \to X$ to denote the associated {\em adjoint bundle} $P \times^{G} \fg \to X$, 
where the Borel construction uses adjoint action of $G$ on $\fg$ from the left. 
The complex structure defines a $(0,1)$-connection $\dbar_P : \Omega^{0,q}(X ; \ad(P)) \to \Omega^{0,q+1}(X ; \ad(P))$
on the Dolbeault forms with values in the adjoint bundle,
and this connection satisfies $\dbar_P^2 = 0$.
Note that the Lie bracket on $\fg$ induces a pointwise bracket on smooth sections of $\ad(P)$~by
\[
[s,t](x) = [s(x),t(x)]
\]
where $s, t$ are sections and $x$ is a point in $X$.
This bracket naturally extends to Dolbeault forms with values in the adjoint bundle,
as the Dolbeault forms are a graded-commutative algebra.

\begin{dfn}\label{dfn: adjoint local}
For $\pi : P \to X$ a holomorphic principal $G$-bundle,
let $\sAd(P)^{sh}$ denote the local Lie algebra whose sections are $\Omega^{0,*}(X,\ad(P))$,
whose differential is $\dbar_P$, and whose bracket is the pointwise operation just defined above.
\end{dfn}

\owen{We should add some remark about Atiyah algebras \dots We could also add a comment about the deformation-theoretic content of this dg Lie algebra.}

This construction admits important variations.
For example, we can move from working over a fixed manifold $X$ to working over a site.
Let ${\rm Hol}_d$ denote the category whose objects are complex $d$-folds and whose morphisms are local biholomorphisms,\footnote{A biholomorphism is a bijective map $\phi: X \to Y$ such that both $\phi$ and $\phi^{-1}$ are holomorphic. A {\em local} biholomorphism means a map $\phi: X \to Y$ such that every point $x \in X$ has a neighborhood on which $\phi$ is a biholomorphism.}
This category admits a natural Grothendieck topology where a cover $\{\phi_i: U_i \to X\}$ means a collection of morphisms into $X$ such that union of the images is all of $X$.
It then makes sense to talk about a local Lie algebra on the site ${\rm Hol}_d$.
Here is a particularly simple example that appears throughout the paper.

\begin{dfn}
Let $G$ be a complex Lie group and let $\fg$ denote its ordinary Lie algebra.
There is a natural functor 
\[
\begin{array}{cccc}
\sG^{sh} :&  {\rm Hol}_d^\opp & \to & {\dgLie}\\
& X & \mapsto &\Omega^{0,*}(X) \otimes \fg,
\end{array}
\]
which defines a sheaf of dg Lie algebras.
Restricted to each slice ${{\rm Hol}_d}_{/X}$, it determines the local Lie algebra for the trivial principal bundle $G \times X \to X$, in the sense described above.
We use $\sG$ to denote the cosheaf of compactly supported sections $\Omega^{0,*}_c \otimes \fg$ on this site.
\end{dfn}

\begin{rmk}
It is not necessary to start with a complex Lie group: 
the construction makes sense for a dg Lie algebra over $\CC$ of finite total dimension.
We lose, however, the interpretation in terms of infinitesimal symmetries of the principal bundle.
\end{rmk}

\begin{rmk}
For any complex manifold $X$ we can restrict the functor $\sG^{sh}$ to the overcategory of opens in $X$, that we denote by $\sG^{sh}_X$. 
In this case, $\sG^{sh}_X$, or its compactly supported version $\sG_X$, comes from the local Lie algebra of Definition \ref{dfn: adjoint local} in the case of the trivial $G$-bundle on $X$. 
In the case that $X = \CC^d$ we will denote the sheaves and cosheaves of the local Lie algebra by $\sG_d^{sh}, \sG_d$ respectively.
\end{rmk}

%In this paper, it is convenient for us to work with Lie algebras that are suitably coherent in the homotopical sense.
%Recall, an $L_\infty$-algebra is a generalization of a dg Lie algebra where the Jacobi identity is only required to hold up to homotopy.
%The data of an $L_\infty$ algebra is a graded vector space $V$ with, for each $k \geq 1$, a $k$-ary bracket
%\[
%\ell_k : V^{\tensor k} \to V[2-k]
%\]
%of cohomological degree $2-k$. 
%These maps are required to satisfy a series of conditions, the first of which says $\ell_1^2 = 0$.
%The next says that $\ell_2$ is a bracket satisfying the Jacobi identity up to a homotopy given by $\ell_3$.
%An $L_\infty$ algebra $(V, \{\ell_n\})$ with $\ell_n = 0$ for $n \geq 3$ is an ordinary dg Lie algebra.
%For a detailed definition see we refer the reader to \cite{StasheffDG, GetzlerLie}.
%
%\begin{rmk}
%For a characteristic zero field $k$, the model categories of dg Lie algebras and $L_\infty$-algebras  over $k$ are Quillen equivalent. \brian{reference} \owen{Hinich}
%(In particular, there is a functorial replacement of every $L_\infty$ algebra by a quasi-isomorphic dg Lie algebra.)
%This Quillen equivalence then induces an equivalence of $\infty$-categories.
%In practice, $L_\infty$ algebras provide a convenient, explicit way to work with Lie algebras in a homotopical fashion.
%\end{rmk}
%
%We now hone in on the class of sheaves of $L_\infty$-algebras relevant for our purposes.
%The following definition appears in Chapter 4 of \cite{CG2}. 
%
%\begin{dfn} 
%A {\em local $L_\infty$ algebra} on a smooth manifold $X$ is
%\begin{itemize}
%\item[(i)] a $\ZZ$-graded vector bundle $L$ on $X$, with $L^n = 0$ for $n$ outside a finite range, and
%\item[(ii)] for each positive integer $n$, a polydifferential operator in $n$ inputs
%\[
%\ell_n : \underbrace{\sL^{sh} \times \cdots \times \sL^{sh}}_{\text{$n$ times}} \to \sL[2-n]
%\]
%where $\sL^{sh}$ denotes the sheaf of smooth sections of~$L$,
%\end{itemize}
%such that the collection $\{\ell_n\}_{n \in \NN}$ satisfy the axioms of an $L_\infty$ algebra.
%Thus, $\sL^{sh}$ is a sheaf of $L_\infty$ algebras. 
%\end{dfn}
%



%As a potential source of confusion, we warn the reader than we typically refer to the local $L_\infty$ algebra $(L, \{\ell_n\})$ simply by $\sL$. 
%Also, we will often use the term local {\em Lie} algebra, especially if $\sL$ is a precosheaf of dg Lie algebras and hence has trivial~$\ell_{n \geq 3}$.
%
%\subsubsection{Holomorphic principal bundles}
%
% 
%\subsubsection{Deformations of holomorphic principal bundles}
%
%The dg Lie algebra $\sAd(P)^{sh}(X) = \Omega^{0,*}(X, \ad(P))$ appears naturally in the deformation theory of holomorphic $G$-bundles. 
%By definition, the bundle $P \to X$ comes equipped with a $G$-equivariant $(0,1)$-connection $\dbar_P : C^\infty_P \to \Omega^{0,1}_P$. 
%Consider two holomorphic structures $\dbar_P$ and $\dbar_P'$ on the same underlying complex principal bundle. 
%By the fundamental property of connections we see that $\dbar_P - \dbar_P'$ defines a $(0,1)$ form with values in $\fg$:
%\[
%\alpha_{P,P'} = \dbar_P - \dbar_P' \in \Omega^{0,1}(P) \tensor \fg .
%\]
%This element is $G$-equivariant, so that it actually descends to an element $\alpha_{P,P'} \in \Omega^{0,1}(X, \ad(P))$. 
%Furthermore, since $\dbar_P^2 = \dbar_P'^2 = 0$, we see that $\alpha_{P,P'}$ satisfies the following holomorphic version of the Maurer-Cartan equation
%\[
%\dbar \alpha_{P,P'} + \frac{1}{2} [\alpha_{P,P'}, \alpha_{P,P'}] = 0 .
%\]
%
%Any other element $\alpha \in \Omega^{0,1}(X, \ad(P))$ satisfying the Maurer-Cartan equation determines a deformation of the holomorphic $G$-bundle $\dbar_P$.
%Of course, two deformations $\alpha,\alpha'$ are equivalent if there exists a holomorphic gauge transformation $f \in \Gamma^{hol}(X, \ad(P))$ such that $\alpha' = [f, \alpha']$. 
%Moreover, there may be obstructions to having such a deformation. 
%This situation is exactly what a formal moduli problem, see Section \ref{sec: formal moduli}, is designed to describe.
%
%\owen{I don't know that we should include the stuff about formal moduli problems. Or it could be shrunk to a small remark that this Lie algebra determines a deformation theory.}
%
%We define the formal moduli problem ${\rm Def}_{P\to X}$ associated to the holomorphic principal $G$-bundle $P \to X$. 
%As above, denote the fixed $(0,1)$-connection by $\dbar_P$ defining the complex structure of the holomorphic principal bundle. 
%Define
%\[
%{\rm Def}_{P \to X} : {\rm dgArt}_\CC \to {\rm sSets}
%\]
%which sends a dg Artinian ring $(A, \fm)$ (again, see Section \ref{sec: formal moduli}) to the simplicial set $\Def_{P \to X}(A)$ whose $n$-simplices are
%\[
%{\rm Def}_{P \to X}(A) [n] = \left\{\alpha \in \left(\Omega^{0,*}(X , {\rm ad}(P)) \tensor \fm \tensor \Omega^*(\Delta^n)\right)^1  \;  | \; \dbar_P \alpha + \d_A \alpha + \d_{\Delta_n} \alpha + \frac{1}{2} [\alpha,\alpha] = 0\right\} .
%\]
%Here, $\d_A$ is the internal differential of $A$ and $\d_{\Delta_n}$ is the de Rham operator for differential forms on the $n$-simplex $\Delta^n$. 
%
%\begin{lem}
%The functor $\Def_{P \to X} : A \mapsto \Def_{P \to X}(A)$ defines a formal moduli problem.
%\end{lem} 
%
%We unpack the definition of this formal moduli problem.
%Suppose first that $(A, \fm)$ is an ordinary Artinian algebra (not dg) concentrated in degree zero. 
%Then, the set of zero simplices above is equal to
%\beqn\label{zerosimplices}
%\{\alpha \in \Omega^{0,1}(X , \ad(P)) \tensor \fm \; | \; \dbar_P \alpha + \frac{1}{2} [\alpha,\alpha] = 0 \} .
%\eeqn
%A $1$-simplex is an element $\alpha(t) + \beta(t) \d t \in \Omega^{0,*}(X, \ad(P)) \tensor \fm \tensor \Omega^*([0,1])$ where, for each $t$, $\alpha(t) \in \Omega^{0,1}(X , \ad(P))$ and $\beta(t) \in \Omega^{0,0}(X, \ad(P))$.
%The Maurer-Cartan equation for the $1$-simplices is equivalent to the pair of equations
%\begin{align*}
%\dbar_P \alpha(t) + \frac{1}{2}[\alpha(t), \alpha(t)] & = 0 ,\\
%\dbar_P \beta(t) + \frac{\partial}{\partial t} \alpha(t) + [\beta(t), \alpha(t)] & = 0 .
%\end{align*}
%The first equation says that $\alpha(t)$ determines a family of complex structures on the $G$-bundle $P \to X$ and.
%The second equation says that holomorphically gauge equivalent deformations of complex structure are cochain homotopy equivalent. 
%It follows from a result of Getzler \cite{GetzlerLie} that the space $\Def_{P \to X}(A)$ is homotopy equivalent to the homotopy quotient of (\ref{zerosimplices}) by the group associated to the nilpotent Lie algebra of gauge transformations $\Gamma^{hol}(X, \ad(P)) \tensor \fm$. 
%
%By construction, the formal moduli problem $\Def_{X \to P}$ is represented by the dg Lie algebra $\sAd(P)^{sh}(X)$ which is the sheaf of sections of the local Lie algebra $\sAd(P)$ we consider in this paper. 
%Naturally, we expect the formal neighborhood of the derived moduli space of $G$-bundles defined in \cite{FHK} near $P$ to be equivalent to this formal moduli problem.
%
%Note that in the case of a Riemann surface $H^2 (X ; \ad(P)) = 0$ and deformations of holomorphic $G$-bundles always exist. 
%In higher dimensions, however, there may be obstructions which is one reason why working with the full dg model for holomorphic gauge symmetries is essential. 

\subsection{Current algebras as enveloping factorization algebras of local Lie algebras}

Local Lie algebras often appear as symmetries of classical field theories.
For instance, as we will show in section \owen{add cross ref}, 
each finite-dimensional complex representation $V$ of a Lie algebra $\fg$
determines a charged $\beta\gamma$-type system on a complex $d$-fold $X$ with choice of holomorphic principal bundle $\pi: P \to X$.
Namely, the on-shell $\gamma$ fields are holomorphic sections for the associated bundle $P \times^G V \to X$, 
and the on-shell $\beta$ fields are holomorphic $d$-forms with values in the associated bundle $P \times^G V^* \to X$.
It should be plausible that $\sAd(P)^{sh}$ acts as symmetries of this classical field theory,
since holomorphic sections of the adjoint bundle manifestly send on-shell fields to on-shell fields.

Such a symmetry determines currents, which we interpret as observables of the classical theory.
Note, however, a mismatch: 
while fields are contravariant in space(time) because fields pull back along inclusions of open sets, 
observables are covariant because an observable on a smaller region extends to any larger region containing it.
The currents, as observables, thus do not form a sheaf but a precosheaf.
We introduce the following terminology.

\begin{dfn}
For a local Lie algebra $(L\to X, \ell_1,\ell_2)$, its precosheaf $\sL[1]$ of {\em linear currents} is given by taking compactly supported sections of~$L$.
\end{dfn}

There are a number of features of this definition that may seem peculiar on first acquaintance.
First, we work with $\sL[1]$ rather than $\sL$.
This shift is due to the Batalin-Vilkovisky formalism. 
In that formalism the observables in the classical field theory possesses a 1-shifted Poisson bracket $\{-,-\}$ (also known as the antibracket), and so if the current $J(s)$ associated to a section $s \in \sL$ encodes the action of $s$ on the observables, i.e.,
\[
\{J(s), F\} = s \cdot F,
\]
then we need the cohomological degree of $J(s)$ to be 1 less than the degree of $s$.
In short, we want a map of dg Lie algebras $J: \sL \to \Obs^\cl[-1]$,
or equivalently a map of 1-shifted dg Lie algebras $J: \sL[1] \to \Obs^\cl$,
where $\Obs^\cl$ denotes the algebra of classical observables.

Second, we use the term ``linear'' here because the product of two such currents is not in $\sL[1]$ itself, 
although such a product will exist in the larger precosheaf $\Obs^\cl$ of observables.
In other words, if we have a Noether map of dg Lie algebras $J: \sL \to \Obs^\cl[-1]$,
it extends to a map of 1-shifted Poisson algebras
\[
J: \Sym(\sL[1]) \to \Obs^\cl
\]
as $\Sym(\sL[1])$ is the 1-shifted Poisson algebra freely generated by the 1-shifted dg Lie algebra $\sL[1]$.
We hence call $\Sym(\fg[1])$ the {\em enveloping 1-shifted Poisson algebra} of a dg Lie algebra~$\fg$.\footnote{\owen{Add some references?}}

For any particular field theory, the currents generated by the symmetry for {\em that} theory are given by the image of this map $J$ of 1-shifted Poisson algebras.
To study the general structure of such currents, without respect to a particular theory,
it is natural to study this enveloping algebra by itself.

\begin{dfn}
For a local Lie algebra $(L\to X, \ell_1,\ell_2)$, its {\em classical currents} $\Cur^\cl(\sL)$ is the precosheaf $\Sym(\sL[1])$ given by taking the enveloping 1-shifted Poisson algebra of the compactly supported sections of~$L$.
It assigns
\[
\Cur^\cl(\sL)(U) = \Sym(\sL(U)[1])
\]
to an open subset $U \subset X$. 
\end{dfn}

We emphasize here that by $\Sym(\sL(U)[1])$ we do {\em not} mean the symmetric algebra in the purely algebraic sense, but rather a construction that takes into account the extra structures on sections of vector bundles (e.g., the topological vector space structure).
Explicitly, the $n$th symmetric power  $\Sym^n(\sL(U)[1])$ means the smooth, compactly supported, and $S_n$-invariant sections of the graded vector bundle 
\[
L[1]^{\boxtimes n} \to U^n.
\]
For further discussion of functional analytic aspects (which play no tricky role in our work here),
see \cite{CG1}, notably the appendices.

A key result of \cite{CG1}, namely Theorem 5.6.0.1, is that this precosheaf of currents forms a factorization algebra. 
From hereon we refer to  $\Cur^\cl(\sL)$ as the {\em factorization algebra of classical currents}.
If the local Lie algebra acts as symmetries on some classical field theory,
we obtain a map of factorization algebras $J: \Cur^\cl(\sL) \to \Obs^\cl$ that encodes each current as a classical observable.

There is a quantum counterpart to this construction, in the Batalin-Vilkovisky formalism.
The idea is that for a dg Lie algebra $\fg$, 
the enveloping 1-shifted Poisson algebra $\Sym(\fg[1])$ admits a natural BV quantization via the Chevalley-Eilenberg chains $C_*(\fg)$.  
This assertion is transparent by examining the Chevalley-Eilenberg differential:
\[
\d_{CE}(xy) = \d_\fg(x)y \pm x\, \d_\fg(y) + [x,y]
\]
for $x,y$ elements of $\fg[1]$.
The first two terms behave like a derivation of $\Sym(\fg[1])$, 
and the last term agrees with the shifted Poisson bracket.
More accurately, to keep track of the $\hbar$-dependency in quantization,
we introduce a kind of Rees construction.
\owen{cross ref stuff with Rune and the other paper}

\begin{dfn}
\label{def: BD envelope}
The {\em enveloping $BD$ algebra} $U^{BD}(\fg)$ of a dg Lie algebra $\fg$ is given by the graded-commutative algebra in $\CC[\hbar]$-modules
\[
\Sym(\fg[1])[\hbar] \cong \Sym_{\CC[\hbar]}(\fg[\hbar][1]),
\]
but the differential is defined as a coderivation with respect to the natural graded-cocommutative coalgebra structure,
by the condition
\[
\d(xy) = \d_\fg(x)y \pm x\, \d_\fg(y) + \hbar [x,y].
\]
\end{dfn}

This construction determines a BV quantization of the enveloping 1-shifted Poisson algebra,
as can be verified directly from the definitions.
(For further discussion see \cite{GH} and \cite{CG2}.)
It is also straightforward to extend this construction to ``quantize'' the factorization algebra of classical currents.

\begin{dfn}
For a local Lie algebra $(L\to X, \ell_1,\ell_2)$, 
its {\em factorization algebra of quantum currents} $\Cur^\q(\sL)$ is given by taking the enveloping $BD$   algebra of the compactly supported sections of~$L$.
It assigns
\[
\Cur^\q(\sL)(U) = U^{BD}(\sL(U))
\]
to an open subset $U \subset X$.
\end{dfn}

As mentioned just after the definition of the classical currents, 
the symmetric powers here mean the construction involving sections of the external tensor product.
Specializing $\hbar = 1$, we recover the following construction.

\begin{dfn}
For a local Lie algebra $(L\to X, \ell_1,\ell_2)$, 
its {\em enveloping factorization algebra} $\UU(\sL)$ is given by taking the Chevalley-Eilenberg chains $\cliels(\sL)$ of the compactly supported sections of~$L$.
\end{dfn}

Here the symmetric powers use sections of the external tensor powers, just as with the classical or quantum currents.

When a local Lie algebra acts as symmetries of a classical field theory,
it sometimes also lifts to symmetries of a BV quantization.
In that case the map $J: \Sym(\sL[1]) \to \Obs^\cl$ of 1-shifted Poisson algebras lifts to a cochain map $J^\q: \Cur^\q(\sL) \to \Obs^\q$ realizing quantum currents as quantum observables.
Sometimes, however, the classical symmetries do not lift directly to quantum symmetries.
We now turn to discussing the natural home for the obstructions to such lifts.



%\begin{rmk}
%The precosheaf of dg Lie algebras $\sL$ ``forgets'' to a cosheaf of cochain complexes by ignoring the bracket.
%It does not form a cosheaf of dg Lie algebras because the coproduct of dg Lie algebras is not the direct sum of cochain complexes; the forgetful functor does not preserve all colimits.
%On the other hand, the forgetful functor from dg Lie algebras to cochain complexes preserves sifted homotopy colimits (notably colimits over \v{C}ech diagrams)
%It forms, however, a factorization algebra with values in dg Lie algebras,
%since .
%For those coming from the Beilinson-Drinfeld school, we remark that $\sL$ plays the role of a Lie$^*$ algebra.
%\owen{Is that correct?}
%\end{rmk}

%
%\owen{I'm inclined to remove almost all of this section. To show that we get a factorization algebra with values in Lie algebras, we need to use the nontrivial fact that the forgetful functor $Alg_O(C) \to C$ preserves {\em sifted} colimits, and so a prefactorization algebra with values in Lie algebras is a factorization algebra therein if it forgets to a factorization algebra.}
% 
%There is a rich theory of factorization algebras and factorization homology for which we only use a part of in this work. 
%In addition to the foundational work of Beilinson-Drinfeld \cite{BD}, the modern theory has been developed extensively in the work of Ayala-Francis \cite{AFTopMan}, Lurie \cite{LurieHA}, and Costello-Gwilliam \cite{CG1,CG2}.
%In this work, a factorization algebra is a symmetric monoidal functor from the category of opens on a fixed manifold, with monoidal product given by disjoint union, to the category of chain complexes, with monoidal product given by tensor product.
%The general theory allows a factorization algebra to take values in an arbitrary symmetric monoidal $\infty$-category.
%The concept of a factorization Lie algebra is perhaps not as well-known as an ordinary factorization algebra (valued in vector spaces, or chain complexes), but certainly falls under this general theory.
%The notion of a factorization Lie algebra is a convenient one to connect the theory of local Lie algebras and factorization algebras.
%The definitions we recall in this section can be found in \cite{CG1} and are certainly subsumed in \cite{LurieHA}. 
%
%\begin{dfn} 
%Let $\sC^{\tensor}$ be a symmetric monoidal category and $X$ a space.
%A {\em prefactorization algebra} on $X$ with values in $\sC$ is a functor of symmetric monoidal categories
%\[
%\sF : {\rm Disj}^{\sqcup}_X \to \sC^\tensor .
%\]
%A {\em strict factorization algebra} with values in $\sC$ is a prefactorization algebra $\sF$ such that: 
%\begin{enumerate}
%\item $\sF$ is a cosheaf with respect to the Weiss topology;
%\item for any disjoint open sets $U, V \subset X$ the structure map $\sF(U) \tensor \sF(V) \to \sF(U \sqcup V)$ is an isomorphism.
%\end{enumerate}
%\end{dfn}
%
%There are two important symmetric monoidal categories we will be most interested in as the target of a factorization algebra.
%The first is the category of chain complexes $\Ch^{\tensor}$ (over $\CC, \RR$) with symmetric monoidal product given by the tensor product.
%The next is the category of dg Lie algebras $\dgLie^{\oplus}$ with symmetric monoidal structure given by the direct sum.
%
%In both of these categories there is the notion of a quasi-isomorphism, which allows us to weaken the above definition slightly.  
%
%\begin{dfn} 
%Let $\sF$ be a prefactorization algebra on $X$ with values in $\sC = \Ch^{\tensor}$ or $\dgLie^{\oplus}$. 
%Then, $\sF$ is a {\em homotopy factorization algebra} if
%\begin{enumerate}
%\item $\sF$ is a homotopy cosheaf with respect to the Weiss topology;
%\item for any disjoint open sets $U, V \subset X$ the structure map $\sF(U) \tensor \sF(V) \to \sF(U \sqcup V)$ is a quasi-isomorphism.
%\end{enumerate}
%\end{dfn}
%
%%Not surprisingly, there is a version of the definition for homotopy factorization algebras with values in an arbitrary symmetric monoidal $\infty$-category, but we do not wish to dive into the general formalism here but refer to the source references \cite{AF1, LurieHA,..} for a complete treatment.
%
%For the remainder of this paper we will only discuss factorization algebras valued in these categories $\Ch^\tensor, \dgLie^{\oplus}$.
%When we do not say otherwise, a {\em factorization algebra} will mean a homotopy factorization algebra with values in $\Ch$. 
%Likewise, a {\em factorization Lie algebra} will mean a homotopy factorization algebra with values in $\dgLie$. 
%Note that the direct sum is {\em not} the coproduct for Lie algebras, so a prefactorization Lie algebra is different than just a precosheaf of Lie algebras. 
%
%We have already encountered a modest extension of the category of dg Lie algebras to the category of $L_\infty$ algebras $\Lcat$ which will come up in our discussion below.
%This category is also symmetric monoidal using the direct sum, and we will also refer to homotopy factorization algebras with values in $\Lcat$ as factorization Lie algebras.
%
%The primary appearance of factorization Lie algebras, for us, comes from local Lie algebras.
% 
%\begin{lem}
%Suppose $(L, \{\ell_n\})$ is a local Lie algebra on $X$.
%Then, the compactly supported sections $\sL$ has the structure of a factorization Lie algebra.
%\end{lem}
%\begin{proof}
%%Since $\sL$ is the compactly supported sections of a graded vector bundle, it is a cosheaf. 
%By the cosheaf property, we know that $\sL(U \sqcup V) \cong \sL(U) \oplus \sL(V)$. 
%This is an isomorphism of $L_\infty$ algebras since any element of $\sL(U)$ commutes with $\sL(V)$ inside of $\sL(U \sqcup V)$. 
%Similarly, if $\{U_i\}$ is a disjoint collection of opens in $X$ and $\sqcup_i U_i \subset W$, then we define the factorization structure map by
%\[
%\oplus_i \sL(U_i) \cong \sL(\sqcup_i U_i) \to \sL (W)
%\]
%where the second map is the structure map for the cosheaf. 
%These structure maps exhibit $\sL$ as a prefactorization Lie algebra (i.e. a prefactorization algebra valued in the category of $L_\infty$ algebras). 
%\end{proof}
%
%There is a functor from dg Lie algebras to cochain complexes 
%\[
%\clieu_* : \dgLie \to \Ch
%\]
%sending $(\fg, \d , [-,-])$ to the complex
%\[
%\clieu_* (\fg) = \left(\Sym(\fg[1]), \d + \d_{CE}\right) .
%\]
%Here, $\d$ denotes the extension of the differential on $\fg$ to the symmetric algebra by the Leibniz rule, and $\d_{CE}$ encodes the Lie bracket.
%There is a completely similar functor from $L_\infty$ algebras to chain complexes that we denote by the same name.
%
%The functor $\clieu_*$ is symmetric monoidal with respect to the direct sum of Lie algebras and the tensor product of cochain complexes $\clieu_*(\fg \oplus \fh) = \clieu_*(\fg) \tensor \clieu_*(\fh)$. 
%Since a factorization Lie algebra uses the direct sum monoidal structure, the following definition makes sense.
%
%\begin{dfn/lem}
%Suppose $\sG$ is a factorization Lie algebra on a manifold $X$ then, $\clieu_*(\sG)$ has the structure of a factorization algebra (valued in cochain complexes with tensor product). 
%\end{dfn/lem}
%
%We have already seen that every local Lie algebra gives rise to a factorization Lie algebra.
%By the construction above, we obtain the following composition of functors.
%\[
%{\rm Lie}_X \to {\rm Fact}^{\rm Lie}_X \to {\rm Fact}_X
%\]
%Here ${\rm Lie}_X$ is the category of local Lie algebras on $X$.
%If $\sL$ is a local Lie algebra we let $\UU(\sL)$ be the image under this composition, and call it the {\em enveloping factorization algebra} of $\sL$. 

\subsection{Local cocycles and shifted extensions}

Some basic questions about a dg Lie algebra $\fg$, such as the classification of extensions and derivations, are encoded cohomologically, typically as cocycles in the Chevalley-Eilenberg cochains $\clies(\fg,V)$ with coefficients in some $\fg$-representation~$V$.
When working with local Lie algebras, it is natural to focus on cocycles that are also local in the appropriate sense.
(Explicitly, we want to restrict to cocycles that are built out of polydifferential operators.)
After introducing the relevant construction, we turn to studying how such cocycles determine modified current algebras.

\subsubsection{Local cochains of a local Lie algebra}

In Appendix \ref{appx:locfncl} we define the local cochains of a local Lie algebra in some detail, 
but we briefly recall it here.
The basic idea is that a local cochain is a Lagrangian density: 
it takes in a section of the local Lie algebra and produces a smooth density on the manifold. 
Such a cocycle determines a functional by integrating the density.
As usual with Lagrangian densities, we wish to work with them up to total derivatives,
i.e., we identify Lagrangian densities related using integration by parts and hence ignore boundary terms.

In a bit more detail, for $L$ is a graded vector bundle, let $JL$ denote the corresponding $\infty$-jet bundle,
which has a canonical flat connection.
In other words, it is a left $D_X$-module, where $D_X$ denotes the sheaf of smooth differential operators on $X$.
For a local Lie algebra, this $JL$ obtains the structure of a dg Lie algebra in left $D_X$-modules.
Thus, we may consider its reduced Chevalley-Eilenberg cochain complex $\clies(JL)$ in the category of left $D_X$-modules. 
By taking the de Rham complex of this left $D_X$-module, we obtain the local cochains.
\owen{I took the full de Rham complex, but if you prefer, we can just tensor with densities.}
For a variety of reasons, it is useful to ignore the ``constants'' term and work with the reduced cochains.
Hence we have the following definition.

\begin{dfn}
Let $\sL$ be a local Lie algebra on $X$.
The {\em local Chevalley-Eilenberg cochains}  of $\sL$~is 
\[
\cloc^*(\sL) = \Omega^{*,*}_X[2d] \tensor_{D_X} \cred^*(J L) .
\]
This sheaf of cochain complexes on $X$ has global sections that we denote by~$\cloc^*(\sL(X))$.
\end{dfn}

\begin{rmk}
This construction $\cloc^*(\sL)$ is just a version of diagonal Gelfand-Fuks cohomology \cite{Fuks, LosikDiag},
where the adjective ``diagonal'' indicates that we are interested in continuous cochains whose integral kernels are supported on the small diagonals.
\end{rmk}

\subsubsection{Shifted extensions}

For an ordinary Lie algebra $\fg$, central extensions are parametrized by 2-cocycles on $\fg$ valued in the trivial module~$\CC$. 
It is possible to interpret arbitrary cocycles as determining as determining {\em shifted} central extensions as {\em $L_\infty$ algebras}.
Explicitly, a $k$-cocycle $\Theta$ of degree $n$ on a dg Lie algebra $\fg$ determines an $L_\infty$ algebra structure on the direct sum $\fg \oplus \CC[n-k]$ with the following brackets $\{\Hat{\ell}_m\}_{m \geq 1}$: $\Hat{\ell}_1$ is simply the differential on $\fg$, $\Hat{\ell}_2$ is the bracket on $\fg$, $\Hat{\ell}_m = 0$ for $m >2$ except
\[
\Hat{\ell}_k(x_1 + a_1, \ldots, x_k + a_k) = 0+ \Theta(x_1,x_2,\ldots, x_k).
\]
(See \owen{add ref} for further discussion. Note that $n=2$ for $k=2$ with ordinary Lie algebras.)
Similarly, local cocycles provide shifted central extensions of local Lie algebras.

\begin{dfn}
For a local Lie algebra $(L, \ell_1,\ell_2)$, a cocycle $\Theta$ of degree $2+k$ in $\cloc^*(\sL)$ determines a {\em $k$-shifted central extension}
\beqn\label{kext}
0 \to \CC[k] \to \Hat{\sL}_\theta \to \sL \to 0
\eeqn
of precosheaves of $L_\infty$ algebras, where the $L_\infty$ structure maps are defined by
\[
\Hat{\ell}_n(x_1,\ldots,x_n) = (\ell_n(x_1,\ldots,x_n), \Theta(x_1,\ldots,x_n)).
\]
Here we set $\ell_n = 0$ for $n > 2$.
\end{dfn}

As usual, cohomologous cocycles determine quasi-isomorphic extensions. 
Much of the rest of the section is devoted to constructing and analyzing various cocycles and the resulting extensions.

\subsubsection{Twists of the current algebras}

Local cocycles give a direct way of deforming the various current algebras a local Lie algebra.
For example, we have the following construction.

\begin{dfn} 
Let $\Theta$ be a degree 1 local cocycle for a local Lie algebra $(L \to X, \ell_1,\ell_2)$. 
Let $K$ denote a degree zero parameter so that $\CC[K]$ is a polynomial algebra concentrated in degree zero.
The {\em twisted enveloping factorization algebra} $\UU_\Theta(\sL)$ assigns to an open $U \subset X$, the cochain complex
\begin{align*}
\UU_\Theta(\sL)(U) & = \left(\Sym(\sL(U)[1] \oplus \CC \cdot K), \d_{\sL} + K \cdot \Theta\right) \\
& = \left(\Sym(\sL(U)[1])[K] , \d_{\sL} + K \cdot \Theta\right),
\end{align*}
where $\d_{\sL}$ denotes the differential on the untwisted enveloping factorization algebra and $\Theta$ is the operator extending the cocycle $\Theta : \Sym(\sL(U)[1]) \to \CC \cdot K$ to the symmetric coalgebra as a graded coderivation.
This twisted enveloping factorization algebra is module for the commutative ring~$\CC[K]$,
and so specializing the value of $K$ determines nontrivial modifications of~$\UU(\sL)$. 
\end{dfn}

An analogous construction applies to the quantum currents, which we will denote~$\Cur^\q_\Theta(\sL)$.

\subsubsection{A special class of cocycles: the $\fj$ functional} \label{sec: g j functional}

There is a particular family of local cocycles that has special importance in studying symmetries of higher dimensional holomorphic field theories. 

Consider 
\[
\theta \in \Sym^{d+1}(\fg^*)^\fg,
\]
so that $\theta$ is a $\fg$-invariant polynomial on $\fg$ of homogenous degree $d+1$. 
This data determines a local functional for $\sG = \Omega^{0,*} \otimes \fg$ on any complex $d$-fold as follows.

\begin{dfn}
For any complex $d$-fold $X$, extend $\theta$ to a functional $\fJ_X(\theta)$ on $\sG_X = \Omega^{0,*}_c(X) \tensor \fg$ by the formula
\beqn\label{j g formula}
\fJ_X(\theta)(\alpha_0 ,\ldots,\alpha_d) = \int_X \theta(\alpha_0,\partial \alpha_1,\ldots,\partial \alpha_d),
\eeqn
where $\partial$ denotes the holomorphic de Rham differential.
In this formula, we define the integral to be zero whenever the integrand is not a $(d,d)$-form.
\end{dfn}

To make this formula as clear as possible, suppose the $\alpha_i$ are pure tensors of the form $\omega_i \otimes y_i$ with $\omega_i \in \Omega^{0,*}_c(X)$ and $y_i \in \fg$.
Then
\beqn\label{jthetafactored}
\fJ_X(\theta) (\omega_0 \tensor y_0,\ldots,\omega_{d} \tensor y_{d}) = \theta(y_0,\ldots,y_{d}) \int_X \omega_0\wedge \partial \omega_1 \cdots \wedge \partial \omega_{d}.
\eeqn
Note that we use $d$ copies of the holomorphic derivative $\partial: \Omega^{0,*} \to \Omega^{1,*}$ to obtain an element of $\Omega^{d,*}_c$ in the integrand and hence something that can be integrated.

This formula manifestly makes sense for any complex $d$-fold $X$, 
and since integration is local on $X$, 
it intertwines nicely with the structure maps of~$\sG_X$.

\begin{dfn}
For any complex $d$-fold $X$ and any $\theta \in \Sym^{d+1}(\fg^*)^\fg$, 
let $\fj_X(\theta)$ denote the local cochain in $\cloc^*(\sG_X)$ defined~by
\[
\fj_X(\theta)(\alpha_0 ,\ldots,\alpha_d) = \theta(\alpha_0,\partial \alpha_1,\ldots,\partial \alpha_d).
\]
Hence $\fJ_X(\theta) = \int_X \fj_X(\theta)$.
\end{dfn}

This integrand $\fj_X(\theta)$ is in fact a local cocycle, and 
in a moment we will use it to produce an important shifted central extension of~$\sG_X$.

\begin{prop}\label{prop j map} 
The assignment 
\[
\begin{array}{cccc}
\fj_X : & \Sym^{d+1} (\fg^*)^\fg [-1]  & \to & \cloc^*(\sG_X) \\ 
& \theta &\mapsto & \fj_X(\theta)
\end{array}
\]
is an cochain map.
\end{prop}

\begin{proof} 
The element $\fj_X(\theta)$ is local as it is expressed as a density produced by polydifferential operators.
We need to show that $\fj_X(\theta)$ is closed for the differential on $\cloc^*(\sG_X)$. 
Note that $\sG_X$ is the tensor product of the dg commutative algebra $\Omega^{0,*}_X$ and the Lie algebra $\fg$.
Hence the differential on the local cochains of $\sG_X$ splits as a sum $\dbar + \d_{\fg}$ where $\dbar$ denotes the differential on local cochains induced from the $\dbar$ differential on the Dolbeault forms and $\d_{\fg}$ denotes the differential induced from the Lie bracket on~$\fg$. 
We now analyze each term separately.

Observe that for any collection of $\alpha_i \in \sG$, we have
\begin{align*}
\dbar(\theta(\alpha_0,\partial \alpha_1,\ldots,\partial \alpha_d)) 
&= \theta(\dbar\alpha_0,\partial \alpha_1,\ldots,\partial \alpha_d) \pm \theta(\alpha_0,\dbar \partial \alpha_1,\ldots,\partial \alpha_d) \pm \cdots \pm \theta(\alpha_0,\partial \alpha_1,\ldots,\dbar\partial \alpha_d)\\
&= \sum_{i = 0}^d \pm \theta(\alpha_0,\partial \alpha_1,\ldots,\partial \alpha_d)
\end{align*}
because $\dbar$ is a derivation and $\theta$ wedges the form components.
(It is easy to see this assertion when one works with inputs like in equation \eqref{jthetafactored}.)
Hence viewing $\fj_X(\theta)$ as a map from $\sG$ to the Dolbeault complex, 
it commutes with the differential $\dbar$.
This fact is equivalent to $\dbar \fj_X(\theta) = 0$ in local cochains.

Similarly, observe that for any collection of $\alpha_i \in \sG$, we have
\begin{align*}
(\d_\fg \fj_X(\theta))(\alpha_0, \alpha_1,\ldots, \alpha_d)
&= (\d_\fg\theta)(\alpha_0,\partial \alpha_1,\ldots,\partial \alpha_d)) \\
&= 0
\end{align*}
since $\theta$ is closed in~$\clies(\fg)$.
\end{proof}

As should be clear from the construction, everything here works over the site ${\rm Hol}_d$ of complex $d$-folds, and hence we use $\fj(\theta)$ to denote the local cocycle for the local Lie algebra $\sG$ on~${\rm Hol}_d$.

There are two modest extensions of the construction. 
\owen{You only write one, however, \dots What's the other?}
First is to consider an arbitrary $G$-bundle $P$ on $X$. 
When $\ad(P)$ is trivialized over an open set $U \subset X$,
the formula for $\fj_X(\theta)$ makes sense on $\sAd(P)(U)$.
This local expression for the cocycle is independent of the choice of coordinates,
so we can glue over any sufficiently refined cover to obtain a global cocycle. 
Thus, we have a cochain map
\[
\fj_X^P : \Sym^{d+1} (\fg^*)^\fg [-1] \to \cloc^*(\sAd(P)(X))
\]
given by the same formula as in~\eqref{j g formula}.
\owen{Should we make this a definition?}

%\subsubsection{Relation to Chern-Weil theory}
%
%\owen{I can't quite put my finger on what the main assertion is in this section. Is it relevant to anything else? Something along these lines might fit more naturally in the context of the anomaly section.}
%
%If $\fg$ is the Lie algebra of a group $G$, there is an interpretation of the space of extensions $\Sym^{d+1}(\fg^*)^\fg$ in terms of $G$.
%Let $\Omega^j_G$ denote the sheaf of $j$-forms on $G$. 
%
%\begin{thm}{\cite{BottBG}}\label{prop: bott} Let $G$ be a Lie group (such as $\GL_n(\CC)$ or $U(n)$). 
%Then, there is an isomorphism 
%\[
%H^i(G , \Omega^j_G) \cong H^{i-j}_c(G , {\rm Sym}^j (\fg^*)) .
%\] 
%Where the right-hand site denotes the continuous group cohomology.
%\end{thm} 
%
%\begin{rmk}
%The theorem above also holds integrally, as shown in \cite{Totaro}.
%\end{rmk}
%
%The continuous group cohomology satisfies $H^k_c(G, \Sym^j(\fg^*)) = 0$ for $k > 0$ and $H^0_c(G, \Sym^j(\fg^*)) = \Sym^j(\fg^*)^G$.
%Thus, the cohomology is supported along the diagonal and one has $H^{k}(G, \Omega^k_G) = \Sym^k(\fg^*)^G$. 
%
%This relationship is compatible with the classical construction of characteristic classes from invariant polynomials using Chern-Weil theory.
%The Hodge-to-de Rham spectral sequence for the Lie group $G$ has $E_1$ page of the form $H^i(G, \Omega^j)$ and converges to the de Rham cohomology $H^*(BG)$. 
%Since the cohomology is supported along the diagonal on the $E_1$ page there is a resulting map
%\[
%\Sym^j(\fg^*)^G \to H^*(B G) .
%\]
%This is the usual Chern-Weil map defining the universal characteristic classes for $G$-bundles.  
%It is an isomorphism when $G$ is compact.
%
%\begin{rmk}
%When $\fg$ is a an arbitrary dg Lie algebra, or more generally an $L_\infty$ algebra, we have encountered a version of $\fj_X(\theta)$ in Section \ref{sec: forms to local}. 
%We showed that for any $L_\infty$ algebra there is a map of cochain complexes $J : \Omega^{d+1}_{cl}(B\fg) [d] \to \cloc^*(\sG_X)$.
%The expression for $\fj_X$ in (\ref{j g formula}) is an explicit formula for this construction in the case that $\fg$ is an ordinary Lie algebra.
%Indeed, when $\fg$ is an ordinary Lie algebra we have $H^{d+1} (\Omega^{d+1}_{cl}(B\fg)) = \Sym^{d+1}(\fg^*)^\fg$, so the construction in Section \ref{sec: forms to local} is a special case.
%\end{rmk}

%Recall, that functions on the formal moduli space $B\fg$ associated to $\fg$ is given by $\sO(B\fg) = \clie^*(\fg)$. 
%Similarly, the $k$-forms on $B\fg$ have a Lie algebraic expression:
%\[
%\Omega^k(B \fg) = \clie^*\left(\fg ; \Sym^k(\fg^*)[-k]\right)
%\]
%The space of {\em closed} $k$-forms is defined by the complex
%\[
%\Omega^k_{cl}(B \fg) = \Omega^k(B \fg) \xto{\partial} \Omega^{k+1}(B \fg) \xto \cdots
%\]

\subsection{The higher Kac-Moody factorization algebra}

Finally, we can introduce the central object of this paper.

\begin{dfn}
Let $X$ be a complex manifold of complex dimension $d$ equipped with a holomorphic principal $G$-bundle $P$.
Let $\Theta$ be a degree 1 cocycle in $\cloc^*(\sAd(P))$. 
The {\em Kac-Moody factorization algebra on $X$ of type $\Theta$} is the twisted enveloping factorization algebra $\UU_\Theta (\sAd(P))$ that assigns
\[
\left(\Sym\left(\Omega^{0,*}_c(U, \ad(P))[1]\right) [K] , \dbar + \d_{CE} + \Theta\right) 
\]
to an open set $U \subset X$~is
\end{dfn}

\begin{rmk} 
As in the definition of twisted enveloping factorization algebras, the factorization algebras $\UU_\Theta(\sAd(P))$ are modules for the ring $\CC[K]$. 
In keeping with conventions above, when $P$ is the trivial bundle on $X$, 
we will denote the Kac-Moody factorization algebra by $\UU_\Theta(\sG_X)$. 
\end{rmk}

The most important class of such higher Kac-Moody algebras makes sense over the site ${\rm Hol}_d$ of all complex $d$-folds.

\begin{dfn}
Let $\fg$ be an ordinary Lie algebra and let $\theta \in \Sym^{d+1}(\fg^*)^\fg$.  
Let $\UU_\theta (\sG)$ denote the twisted enveloping factorization algebra $\UU_{\fj(\theta)} (\sG)$ for the local Lie algebra $\sG = \Omega^{0,*}_c \otimes \fg$ on the site ${\rm Hol}_d$ of complex $d$-folds.
\end{dfn}

In the case $d = 1$ the definition above agrees with the Kac-Moody factorization algebra on Riemann surfaces given in \cite{CG1}.
There, it is shown that this factorization algebra, restricted to the complex manifold $\CC$, recovers a vertex algebra isomorphic to that of the ordinary Kac-Moody vertex algebra.
(See Section 5 of Chapter 5.)
Thus, we think of the object $\UU_\Theta(\sAd(P))$ as a higher dimensional version of the Kac-Moody vertex algebra.

\subsubsection{Holomorphic translation invariance and higher dimensional vertex algebras}

To put some teeth into the previous paragraph,
we note that \cite{CG1} introduces a family of colored operads ${\rm PDiscs_d}$, the little $d$-dimensional polydiscs operads,
that provide a holomorphic analog of the little $d$-disks operads~$E_d$.
Concretely, this operad ${\rm PDiscs_d}$ encodes the idea of the operator product expansion, 
where one now understands observables supported in small disks mapping into observables in large disks, rather than point-like observables.

In the case $d=1$, Theorem 5.3.3 of \cite{CG1} shows that a ${\rm PDiscs_1}$-algebra $\cA$ determines a vertex algebra $\VV(\cA)$ so long as $\cA$ is suitably equivariant under rotation .
This construction $\VV$ is functorial.
As shown in \cite{CG1}, many vertex algebras appear this way, and any vertex algebras that arise from physics should, in light of the main results of~\cite{CG1,CG2}.

For this reason, one can interpret ${\rm PDiscs_d}$-algebras, particularly when suitably equivariant under rotation, as providing a systematic and operadic generalization of vertex algebras to higher dimensions. 
Proposition 5.2.2 of \cite{CG1} provides a useful mechanism for producing ${\rm PDiscs_d}$-algebra: 
it says that if a factorization algebra is equivariant under translation in a holomorphic manner, then it determines such an algebra.

Hence it is interesting to identify when the higher Kac-Moody factorization algebras are invariant in the sense needed to produce ${\rm PDiscs_d}$-algebras.
We now address this question.

First, note that on the complex $d$-fold $X = \CC^d$, 
the local Lie algebra $\sG_{\CC^d}$ is manifestly equivariant under translation.

It is important to recognize that this translation action is holomorphic in the sense that the infinitesimal action of the (complexified) vector fields $\partial/\partial \Bar{z}_i$ is homotopically trivial.
Explicitly, consider the operator $\eta_i = \iota_{\partial/\partial \Bar{z}_i}$ on Dolbeault forms
(and which hence extends to $\sG_{\CC^d}$), and
note that
\[
[\dbar, \eta_i] = \partial/\partial \Bar{z}_i.
\]
Both the infinitesimal actions and this homotopical trivialization extend canonically to the Chevalley-Eilenberg chains of $\sG_{\CC^d}$ and hence to the enveloping factorization algebra and the current algebras.
(For more discussion of these ideas see \owen{ref your paper as well as book}.)

A succinct way to express this feature is to introduce a dg Lie algebra  
\[
\CC^d_{\rm hol} = \text{span}_\CC\{\partial/\partial z_1, \ldots, \partial/\partial z_d, \partial/\partial \Bar{z}_1,\ldots,\partial/\partial \Bar{z}_d, \eta_1,\ldots, \eta_d\}
\]
where the partial derivatives have degree 0 and the $\eta_i$ have degree -1,
where the brackets are all trivial, 
and where the differential behaves like $\dbar$ in the sense that the differential of $\eta_i$ is $\partial/\partial \Bar{z}_i$.
We just argued in the preceding paragraph that $\sG_{\CC^d}$ and its current algebras are all strictly $\CC^d_{\rm hol}$-invariant. 

When studying shifted extensions of $\sG_{\CC^d}$, 
it then makes sense to consider local cocycles that are also translation invariant in this sense.
Explicitly, we ask to work with cocycles~in
\[
\cloc^*(\sG_{\CC^d})^{\CC^d_{\rm hol}} \subset \cloc^*(\sG_{\CC^d}).
\]
Local cocycles here determine higher Kac-Moody algebras that are holomorphically translation invariant and hence yield ${\rm PDiscs}_d$-algebras.

The following result indicates tells us that we have already encountered all the relevant cocycles so long as we also impose rotation invariance, which is a natural condition.

\begin{prop}
\label{prop: trans j}
The map $\fj_{\CC^d} :  \Sym^{d+1}(\fg^*)^\fg [-1] \to \cloc^*(\sG_{\CC^d})$ factors through the  subcomplex of local cochains that are rotationally and holomorphically translation invariant.
This map 
\[
\fj_{\CC^d} : \Sym^{d+1}(\fg^*)^\fg [-1] \xto{\simeq} \left(\cloc^*(\sG({\CC^d}))^{\CC^{d}_{\rm hol}}\right)^{U(d)}
\]
is a quasi-isomorphism.
\end{prop}

As the proof is rather lengthy, we provide it in Appendix~\ref{sec: hol trans}.

\section{Local aspects of the higher Kac-Moody factorization algebras} 
\label{sec: sphere ops}

A factorization algebra encodes an enormous amount of information, 
and hence it is important to extract aspects that are simpler to understand.
In this section we will take two approaches:
\begin{enumerate}
\item by compactifying along a sphere of real dimension $2d-1$, 
we obtain an algebra (more precisely, a homotopy-coherent associative algebra) that encodes the higher dimensional version of ``radial ordering'' of operators from two-dimensional conformal field theory, and
\item by compactifying along a torus $(S^1)^d$, 
we obtain an algebra over the little $d$-disks operad.
\end{enumerate}
In both cases these algebras behave like enveloping algebras of homotopy-coherent Lie algebras (in a sense we will spell out in detail below), which allows for simpler descriptions of some phenomena. 
It is important to be aware, however, that these algebras do not encode the full algebraic structure produced by the compactification; instead, they sit as dense subalgebras.
We will elaborate on this subtlety below.

For factorization algebras, compactification is accomplished by the pushforward operation.
Given a map $f: X \to Y$ of manifolds and a factorization algebra $\cF$ on $X$,
its {\em pushforward} $f_* \cF$ is the factorization algebra on $Y$ where
\[
f_*\cF(U) = \cF(f^{-1}(U))
\]
for any open $U \subset Y$.
The first example we treat arises from the radial projection map
\[
r: \CC^d \setminus \{0\} \to (0,\infty)
\]
sending $z$ to its length $|z|$. 
The preimage of a point is simply a $2d-1$-sphere,
so one can interpret the pushforward enveloping factorization algebra $r_* \UU \cG_d$ as compactification along these spheres.
Our first main result is that there is a locally constant factorization algebra $\cA$ along $(0,\infty)$ with a natural map
\[
\phi: \cA \to r_* \UU \cG_d
\]
that is dense from the point of view of the topological vector space structure.
By a theorem of Lurie, locally constant factorization algebras on $\RR$ correspond to homotopy-coherent associative algebras,
so that we can interpret $\phi$ as saying that the pushforward is approximated by an associative algebra, in this derived sense.
We will show explicitly that this algebra is the $A_\infty$ algebra arising as the enveloping algebra of an $L_\infty$ algebra already introduced by Faonte-Hennion-Kapranov.

For the physically-minded reader, 
this process should be understood as a version of radial ordering.
Recall from the two-dimensional setting that it can be helpful to view the punctured plane as a cylinder,
and to use the radius as a kind of time parameter.
Time ordering of operators is then replaced by radial ordering.
Many computations can be nicely organized in this manner,
because a natural class of operators arises by using a Cauchy integral around the circle of a local operator.
The same technique works in higher dimensions where one now computes residues along the $2d-1$-spheres.
From this perspective, the natural Hilbert space is associated to the origin in the plane
(more accurately to an arbitrarily small disk around the origin),
and this picture also extends to higher dimensions.
Hence we obtain a kind of vacuum module for this higher dimensional generalization of the Kac-Moody algebras.

Our second cluster of results uses compactification along the projection map
\[
\begin{array}{ccc}
\CC^d \setminus \{\text{coordinate hyperplanes}\} & \to & (0,\infty)^d \\
(z_1,\ldots,z_d) & \mapsto & (|z_1|,\ldots,|z_d|).
\end{array}
\]
We construct an $E_d$ algebra that maps densely into the pushforward.
%The annular algebra $\sA$ that we just discussed in the complex one-dimensional case has a generalization to arbitrary dimensions.The higher dimensional versions of annuli we consider are given by open sets equal to neighborhoods of $(2d-1)$-spheres.
%In this section we describe the higher dimensional version of this annular algebra for the Kac-Moody factorization algebra.
%This amounts to specializing the factorization algebra to the complex manifold $X = \CC^d \setminus \{0\}$ and extracting the data of an $A_\infty$-algebra from the factorization product in the radial direction.
%The reduction of the factorization algebra along $S^{2d-1} \subset \CC^d \setminus \{0\}$ produces a one-dimensional factorization algebra via pushing forward along the radial projection map $\CC^d \setminus \{0\} \to \RR_{>0}$.
%Embedded inside of this factorization algebra is a locally constant factorization algebra, which will define for us our $A_\infty$-algebra.
%Furthermore, we show how the factorization product of disks with higher dimensional annuli provide the structure a ($A_\infty$-)module on the value of the factorization algebra on the disk.

\owen{I want to move this into the next subsections}

We will recognize this $A_\infty$-algebra as the universal enveloping algebra of an $L_\infty$ algebra which is obtained as a central extension of an algebraic version of the sphere algebra
\beqn\label{mapping space}
{\rm Map}(S^{2d-1}, \fg) .
\eeqn
When $d=1$ there is an embedding $\fg[z,z^{-1}] \hookrightarrow C^\infty(S^1) \tensor \fg = {\rm Map}(S^1, \fg)$, induced by the embedding of algebraic functions on punctured affine line inside of smooth functions on $S^1$. 
The affine algebras are given by extensions of algebraic loop algebra $\sO^{alg}(\AA^{1\times}) = \fg[z,z^{-1}]$ prescribed by a $2$-cocycle involving the algebraic residue pairing. 
Note that this cocycle is {\em not} pulled back from any cocycle on $\sO^{alg}(\AA^1) \tensor \fg = \fg[z]$. 
%Now, consider algebraic functions on the punctured $d$-dimensional affine space $\AA^{d \times}$.

When $d > 1$ Hartog's theorem implies that the space of holomorphic functions on punctured affine space is the same as the space of holomorphic functions on affine space.
The same holds for algebraic functions, so that $\sO^{alg}(\AA^{d\times}) \tensor \fg = \sO^{alg}(\AA^d) \tensor \fg$. 
In particular, the naive algebraic replacement $\sO^{alg}(\AA^{d\times}) \tensor \fg$ of (\ref{mapping space}) has no interesting central extensions. 
However, as opposed to the punctured line, the punctured affine space $\AA^{d \times}$ has interesting higher cohomology. 

The key idea is that we replace the commutative algebra $\sO^{alg}(\AA^{d\times})$ by the derived space of sections $\RR \Gamma(\AA^{d \times}, \sO)$. 
This complex has interesting cohomology and leads to nontrivial extensions of the dg Lie algebra $\RR \Gamma(\AA^{d \times}, \sO) \tensor \fg$. 
Concretely, we will use a dg model $A_d$ for $\RR \Gamma(\AA^{d \times}, \sO)$ due to \cite{FHK} that is an algebraic analog of the tangential Dolbeault complex of the $(2d-1)$-sphere inside of the Dolbeault complex of $\CC^d \setminus \{0\}$:
\[
\Omega_b^{0,*}(S^{2d-1}) \subset \Omega^{0,*}(\CC^d\setminus \{0\}) .
\]
See \cite{DragomirTomassini} for details on the definition of $\Omega_b^{0,*}(S^{2d-1})$. 
The degree zero part of $\Omega_b^{0,*}(S^{2d-1})$ is $C^\infty(S^{2d-1})$, so we can view $A_d \tensor \fg$ as a derived enhancement of the mapping space in (\ref{mapping space}). 

The model $A_d$, by definition, has cohomology equal to the cohomology of $\RR \Gamma(\AA^{d \times}, \sO)$. 
In \cite{FHK} they have studied a class of cocycles associated to elements $\theta \in \Sym^{d+1}(\fg^*)^\fg$ that are algebraic analogs of the local cocycles we introduced in the previous section. 
The cocycle is of total cohomological degree $+2$ and so determines a central extension of $A_d \tensor \fg$ that we denote $\Hat{\fg}_{d,\theta}$. 
Our first main result is that our ``higher annular algebra" of the Kac-Moody factorization algebra from the discussion above recovers this Lie algebra extension.

\begin{thm}\label{thm sphere alg}
Let $\sF_{1d}$ be the one-dimensional factorization algebra obtained by the reduction of the Kac-Moody factorization algebra $\UU_\alpha\left(\sG_{\CC^{d} \setminus \{0\}} \right)$ along the sphere $S^{2d-1} \subset \CC^{d} \setminus \{0\}$.
There is a dense subfactorization algebra $\sF^{lc}_{1d} \subset \sF_{1d}$ that is locally constant. 
As a one-dimensional locally constant factorization algebra, $\sF^{lc}_{1d}$ is equivalent to the higher affine algebra $U(\Hat{\fg}_{d,\theta})$.
\end{thm}

%\begin{thm}\label{thm sphere alg} The associative algebra $U(\Hat{\fg}_{d,\theta})$ determines a locally constant factorization algebra on the real one-manifold $\RR$ that we denote $U(\Hat{\fg}_{d,\theta})^{fact}$. 
%Moreover, there is an injective dense map of factorization algebras on $\RR$:
%\[
%\Phi^{S^{2d-1}} : \left(U \Hat{\fg}_{d,\theta} \right)^{fact} \to \rho_*\left(\sF^{\CC^d \setminus \{0\}}_{\fg,\theta} \right)  .
%\]
%where the right-hand side is the push-forward of the Kac-Moody factorization algebra on $\CC^{d}\setminus \{0\}$ along the radial projection map.
%\end{thm}

In the final part of this section we specialize to the manifold $X = (\CC \setminus \{0\})^d$. 
Note that when $d=1$ this is the same as the algebra above, but for $d>1$ this factorization algebra has a different flavor. 
We will show how to extract the data of an $E_d$-algebra from this configuration, and discuss its role in the theory of higher dimensional vertex algebras. 

%In a similar way in Section \ref{sec: ...} we will see how the Kac-Moody factorization algebra on $(\CC \setminus \{0\})^d$ are related to extensions of higher loop Lie algebras
%\[
%L^d \fg = L ( \cdots (L \fg) \cdots ) = {\rm Map}(S^{1} \times S^1 , \fg).
%\]

%\[
%\cA_{d, \fg,\theta} := \bigoplus_{k \in \ZZ} \rho_*\left(\sF^{\CC^d}_{\fg,\theta} |_{\CC^d \setminus 0} \right) ^{(k)} \subset \rho_*\left(\sF^{\CC^d}_{\fg,\theta} |_{\CC^d \setminus 0} \right) .
%\]
%\end{thm}

\subsection{Derived functions on punctured affine space}

The affine algebra associated to a Lie algebra $\fg$ together with an invariant pairing $\kappa$ is defined as a central extension of the loop algebra of $\fg$
\[
\CC \to \Hat{\fg}_{\kappa} \to Lg 
\]
where we use the algebraic loop algebra $L\fg = g [z,z^{-1}]$.
The central extension is determined by the cocycle 
\[
(f \tensor X, g \tensor Y) \mapsto \oint f \d g \kappa(X,Y) .
\] 
A natural generalization of the loop algebra is to generalize the circle $S^1$, which is equal to the units in $\CC$, by the sphere $S^{2d-1}$, which is equal to the units in $\CC^d$.
That is, we take the ``sphere algebra'' of maps from $S^{2d-1}$ into $\fg$.
For topologists, this direction might seem natural,
but it may not seem too natural from the perspective of algebraic geometry.
In particular, an algebro-geometric sphere is given by a punctured affine $d$-space $\AA^{d\times} = \AA^d \setminus \{0\}$ or a punctured formal $d$-disk,
but every map from these spaces to $\fg$ extends to a map from $\AA^d$ or the formal $d$-disk into $\fg$ (essentially, by Hartog's lemma).
Thus, this direction seems fruitless, since naively there would be no interesting central extensions.
The key to evading this issue is to work with the {\em derived} space of maps. 
Indeed, the sheaf cohomology of $\sO$ on the punctured affine $d$-space is interesting. 

This fact ought not to be too surprising: 
as a smooth manifold, punctured affine $d$-space is equivalent to $\RR_{> 0} \times S^{2d-1}$,
and this equivalence manifests itself in the cohomology of the structure sheaf.
Explicitly,
\[
H^*(\AA^{d\times}, \sO^{alg}) = 
\begin{cases} 0, & * \neq 0, d-1 \\ \CC[z_1,\ldots,z_d], & * = 0 \\ \CC[z_1^{-1},\ldots,z_d^{-1}] \frac{1}{z_1 \cdots z_d}, & * = d-1 \end{cases}
\]
as one can show by direct computation (e.g., use the cover by the affine opens of the form $\AA^d \setminus \{z_i =0\}$).
When $d = 1$, this recovers the usual Laurent series;
and it is natural to view the above as the higher-dimensional analogue of the Laurent series,
with the polar part now in degree~$d-1$.

Hence, the derived global sections $\RR\Gamma(\AA^{d\times},\sO)$ of $\sO$ provide a homotopy-commutative algebra,
and thus one obtains a homotopy-Lie algebra by tensoring with $\fg$,
which we will call the sphere Lie algebra by analogy with the loop Lie algebra.
One can then study central extensions of this homotopy-Lie algebra, which are analogous to the affine Kac-Moody Lie algebras.
For explicit constructions, it is convenient to have a commutative dg algebra that models the derived global sections.
It should be no surprise that we like to work with the Dolbeault complex.
We will use this approach to relate the sphere Lie algebra and its extensions to the current algebras that we've already introduced.

An explicit dg model $A_d$ for the derived global sections has been written down in \cite{FHK} based on the Jouanolou method for resolving singularities. 
We have recalled its definition in Appendix \ref{chap: appendix}.

We are interested in the dg Lie algebra $A_d \tensor \fg$. 
For any $d$ and symmetric function $\theta \in \Sym^{d+1}(\fg^*)^\fg$, in \cite{FHK} they define the cocycle
\beqn\label{fhk cocycle}
\theta_{FHK} : (A_d \tensor \fg)^{\tensor (d+1)} \to \CC \;\; , \;\; a_0 \cdots a_d \mapsto \Res_{z=0} \theta(a_0,\d a_1,\ldots,\d a_d),
\eeqn
where $\d$ is the algebraic de Rham differential.
It is immediate that this cocycle has cohomological degree $+2$ and so determines a(n) (unshifted) dg Lie algebra central extension of $A_d \tensor \fg$:
\beqn\label{gdt}
\CC \cdot K \to \Hat{\fg}_{d, \theta} \to A_d \tensor \fg .
\eeqn
Our aim is to show how the Kac-Moody factorization algebra is related to this dg Lie algebra. 

%\begin{dfn} Fix an element $\theta \in \Sym^{d+1}(\fg)^{\fg}$. 
%Let $\Hat{\fg}_{d,\theta}$ be the $L_\infty$ central extension
%\[
%\CC \to \Hat{\fg}_{d,\theta} \to A_d \tensor \fg
%\]
%determined by the degree two cocycle $\theta_{\rm FHK} \in \clie^*(A_d \tensor \fg)$ defined by
%\[
%\theta_{\rm FHK}(a_0\tensor X_0,\dots,a_d\tensor X_d) = \Reszero \left(a_0 \wedge \d a_1 \wedge \cdots \wedge \d a_d \right) \theta(X_0,\ldots,X_d)
%\]
%where $a_i \tensor X_i \in A_d \tensor \fg$. 
%\end{dfn}

\subsection{Compactifying the higher Kac-Moody algebras along spheres}

We consider the restriction of the factorization algebra $\UU_\theta (\sG)$ on $\CC^{d} \setminus \{0\}$ to the collection of open sets diffeomorphic to spherical shells.
This restriction has the structure of a one-dimensional factorization algebra corresponding to the iterated nesting of spherical shells. 
We show that there is a dense subfactorization algebra that is locally constant, hence corresponds to an $E_1$ algebra.
We conclude by identifying an $A_\infty$ model for this algebra as the universal enveloping algebra of a certain $L_\infty$ algebra, that agree with the higher dimensional affine algebras.

Introduce the radial projection map
\[
\rho : \CC^d \setminus 0 \to \RR_{>0}
\]
sending $z = (z_1, \ldots, z_d)$ to $|z| = \sqrt{|z_1|^2 + \cdots + |z_d|^2}$. 
We will restrict our factorization algebra to spherical shells by pushing forward the factorization algebra along this map.
Indeed, the preimage of an open interval is such a spherical shell, and the factorization product on the line is equivalent to the nesting of shells. 

\subsubsection{The case of zero level}

First we will consider the higher Kac-Moody factorization algebra on $\CC^d \setminus \{0\}$ ``at level zero". That is, the factorization algebra $\UU(\sG_{\CC^d \setminus\{0\}})$.
In this section we will omit $\CC^d \setminus \{0\}$ from the notation, and simply refer to the factorization algebra by $\UU(\sG)$. 

Let $\rho_* \left(\UU \sG \right)$ be the factorization algebra on $\RR_{>0}$ obtained by pushing forward along the radial projection map. Explicitly, to an open set $I \subset \RR_{>0}$ this factorization algebra assigns the dg vector space
\[
{\rm C}^{\rm Lie}_*\left(\Omega_c^{0,*}(\rho^{-1}(I)) \tensor \fg)\right) .
\]

%We will need a different model for this factorization algebra.
%Let $\Omega^{*}_{\RR_{>0}}$ be the sheaf of differential forms on the positive real line.
%We can define the sheaf of dg Lie algebras $\Omega^*_{\RR_{>0}} \tensor (A_d \tensor \fg)$.
%It's universal enveloping factorization algebra $U^{fact}\left(\Omega^{*}_{>0} \tensor (A_d \tensor \fg)\right)$ is a factorization algebra on $\RR_{>0}$. 
%A slight variant of Proposition 3.4.0.1 in \cite{CG1}, which shows that there is a quasi-isomorphism of factorization algebras
%\[
%U^{fact}\left(\Omega^{*}_{>0} \tensor (A_d \tensor \fg)\right)
%\]

\def\pr{\rm pr}

Let $I \subset \RR_{>0}$ be an open subset. There is the natural map $\rho^* : \Omega^*_c(I) \to \Omega^*_c(\rho^{-1}(I))$ given by the pull back of differential forms. We can post compose this with the natural projection ${\rm pr}_{\Omega^{0,*}} : \Omega^*_c \to \Omega^{0,*}_c$ to obtain a map of commutative algebras ${\rm pr}_{\Omega^{0,*}} \circ \rho^* : \Omega^*_c(I) \to \Omega^{0,*}_c(\rho^{-1}(I))$. 
The map $j$ from Proposition \ref{prop: Ad} determines a map of dg commutative algebras $j : A_d \to \Omega^{0,*}(\rho^{-1}(I))$. 
Thus, we obtain a map
\beqn\label{phi map}
\begin{array}{cccc}
\Phi(I) = ({\rm pr}_{\Omega^{0,*}} \circ \rho^*) \tensor j : & \Omega^*_c(I) \tensor A_d & \to & \Omega^{0,*}_c\left((\rho^{-1}(I)\right) \\
& \varphi \tensor a & \mapsto & \left(({\rm pr}_{\Omega^{0,*}} \circ \rho^*) \varphi\right) \wedge j(a) 
\end{array}
\eeqn
Since this is a map of commutative dg algebras it defines a map of dg Lie algebras
\[
\Phi(I) \tensor \id_{\fg} :  (\Omega^*_c(I) \tensor A_d) \tensor \fg = \Omega^*_c(I) \tensor (A_d \tensor \fg) \to \Omega^{0,*}(\rho^{-1}(I)) \tensor \fg 
\]
which maps $(\varphi \tensor a) \tensor X \mapsto \Phi(\varphi \tensor a) \tensor X$. 
We will drop the $\id_{\fg}$ from the notation and will denote this map simply by $\Phi (I)$. Note that
$\Phi(I)$ is compatible with inclusions of open sets, hence extends to a map of cosheaves of dg Lie algebras that we will call $\Phi$.  

We can summarize the results as follows.

\begin{prop}\label{prop: fact lie}The map $\Phi$ extends to a map of factorization Lie algebras
\[
\Phi : \Omega^*_{\RR_{>0},c} \tensor (A_d \tensor \fg) \to \rho_*\sG .
\] 
Hence, it defines a map of factorization algebras
\[
{\rm C}_*(\Phi) : U^{fact}\left(\Omega^{*}_{\RR_{>0}} \tensor (A_d \tensor \fg)\right) \to \rho_*\left(\UU \sG \right) .
\]
\end{prop}

The fact that we obtain a map of factorization algebras follows from applying the functor $\clieu_*(-)$ to $\Phi$. It is immediate to see that this functor commutes with push-forward. 

\subsubsection{The case of non-zero level}

We now proceed to the proof of Theorem \label{thm sphere alg}. 
The dg Lie algebra $\fg_{d,\theta}$ determines a dg associative algebra via its universal enveloping algebra $U(\fg_{d,\theta})$.
This dg algebra determines a factorization algebra on the one-manifold $\RR_{>0}$ that assigns to every open interval $I \subset \RR_{>0}$ the dg vector space $U(A_d \tensor \fg)$. 
The factorization product is uniquely determined by the algebra structure. 
Henceforth, we denote this factorization algebra by $U(\fg_{d,\theta})^{fact}$.

To prove the theorem we will construct a sequence of maps of factorization Lie algebras on $\RR_{>0}$:
\[
\xymatrix{
& \sG_1 \ar[dr]^-{\Phi_1} & & \sG_2 \\
\sG_0 \ar[ur]^-{\simeq}_{\Phi_0} & & \sG_1' \ar[ur]_{\Phi_2} & .
}
\]
The enveloping factorization of $\sG_0$ is equivalent to the factorization algebra $U (\Hat{\fg}_{d,\theta})^{fact}$. 
Moreover, the enveloping factorization of $\sG_2$ is the push-forward of of the higher Kac-Moody factorization algebra $\rho_* \UU \sG$. 
Hence, the desired map of factorization algebras is produced by applying the enveloping factorization functor to the above composition of factorization Lie algebras. 

First, we introduce the factorization Lie algebra $\sG_0$. 
To an open set $I \subset \RR$, it assigns the dg Lie algebra $\sG_0(I) = \Omega^*_{c}(I) \tensor \Hat{\fg}_{d,\theta}$, where $\Hat{\fg}_{d,\theta}$ is the central extension from Equation (\ref{gdt}). The differential and Lie bracket are determined by the fact that we are tensoring a commutative dg algebra with a dg Lie algebra. A slight variant of Proposition 3.4.0.1 in \cite{CG1}, which shows that the one-dimensional enveloping factorization of an ordinary Lie algebra produces its ordinary universal enveloping algebra, shows that there is a quasi-isomorphism of factorization algebras on $\RR$,
\[
(U \Hat{\fg}_{d,\theta})^{fact} \xrightarrow{\simeq} {\rm C}^{\rm Lie}_*(\sG_0) .
\]
The factorization Lie algebra $\sG_0$ is a central extension of the factorization Lie algebra $\Omega^*_{\RR,c} \tensor (A_d \tensor \fg)$ by the trivial module $\Omega^*_c \oplus \CC \cdot K$. Indeed, the cocycle determining the central extension is given by
\[
\theta_0 (\varphi_0 \alpha_0,\ldots,\varphi_d \alpha_d) = (\varphi_0 \wedge \cdots \wedge \varphi_d) \theta_{A_d}(\alpha_1,\ldots,\alpha_d) .
\] 
The factorization Lie algebra $\Omega^*_{\RR,c} \tensor (A_d \tensor \fg)$ is the compactly supported sections of the local Lie algebra $\Omega^*_{\RR} \tensor (A_d \tensor \fg)$ and this cocycle determining the extension is a local cocycle. 

Next, we define the factorization dg Lie algebra $\sG_1$ on $\RR$. This is also obtained as a central extension of the factorization Lie algebra $\Omega^{*}_{\RR,c} \tensor (A_d \tensor \fg)$: 
\[
0 \to \CC \cdot K [-1] \to \sG_1 \to \Omega^{*}_{\RR,c} \tensor (A_d \tensor \fg) \to 0
\]
determined by the following cocycle. For an open interval $I$ write $\varphi_i \in \Omega^*_c(I)$, $\alpha_i\in A_d \tensor \fg$. The cocycle is defined by
\beqn\label{cocycle 1}
\theta_1 (\varphi_0 \alpha_0, \ldots, \varphi_d \alpha_d) =  \left(\int_{I} \varphi_0 \wedge \cdots \varphi_d \right) \theta_{\rm FHK} (\alpha_0,\ldots,\alpha_d)
\eeqn
where $\theta_{\rm FHK}$ was defined in Equation \ref{fhk cocycle}.

The functional $\theta_1$ determines a local cocycle in $\cloc^*\left(\Omega^*_\RR \tensor (A_d \tensor \fg)\right)$ of degree one. 

\def\dR{{\rm dR}}

We now define a map of factorization Lie algebras $\Phi_0 : \sG_0 \to \sG_1$. On and open set $I \subset \RR$, we define the map $\Phi_0(I) : \sG_0(I) \to \sG_1(I)$ by
\[
\Phi_0(I)(\varphi \alpha, \psi K) = \left(\varphi \alpha, \int \psi \cdot K\right) .
\]
For a fixed open set $I \subset \RR$, the map $\Phi_0$ fits into the commutative diagram of short exact sequences
\[
\xymatrix{
0 \ar[r] & \Omega^*_c(I) \tensor \CC \cdot K  \ar[d]^-{\int}_-{\simeq} \ar[r] & \sG_0(I) \ar[d]^-{\Phi_0(I)} \ar[r] & \Omega^*_c(I) \tensor (A_d \tensor \fg) \ar@{=}[d] \ar[r] & 0 \\
0 \ar[r] & \CC \cdot K [-1] \ar[r] & \sG_1(I) \ar[r] & \Omega^*_c(I) \tensor (A_d \tensor \fg) \ar[r] & 0 .
}
\]
To see that $\Phi_0(I)$ is a map of dg Lie algebras we simply observe that the cocycles determining the central extensions are related by $\theta_1 = \int \circ \; \theta_0$, where $\int : \Omega^*_c(I) \to \CC$ as in the diagram above. Since $\int$ is a quasi-isomorphism, the map $\Phi_0(I)$ is as well. It is clear that as we vary the interval $I$ we obtain a quasi-isomorphism of factorization Lie algebras $\Phi_0 : \sG_0 \xto{\simeq} \sG_1$. 

%To verify that this is a map of factorization Lie algebras, it suffices to show that for each $I \subset \RR$, $\Phi_1$ determines a map of cocommutative coalgebras 
%\[
%\Phi_1 : {\rm C}^{\rm Lie}_*\left(\Omega^*_c(I) \tensor \Hat{\fg}_{d,\theta}\right) \to {\rm C}^{\rm Lie}_*(\sG_1(I)) .
%\] 
%Clearly, modulo the central element $K$ the Lie brackets are identical. Thus, we need to show that the cocycles determining the central extensions are compatible. Fix $I \subset \RR$ and suppose $\varphi_0,\ldots, \varphi_d \in \Omega^*_c(I)$, $\alpha_0,\ldots,\alpha_d \in A_d \tensor \fg$. Then, the cocycle in $\Omega^*_c(I) \tensor \Hat{\fg}_{d,\theta}$ is given by

We now define the factorization dg Lie algebra $\sG_1'$. Like $\sG_0$ and $\sG_0$, it is a central extension of $\Omega^*_{\RR,c} \tensor (A_d \tensor \fg)$. The cocycle determining the central extension is defined by
\[
\theta_1' (\varphi_0 a_0 X_0, \ldots, \ldots, \varphi_d a_dX_d) = \theta_1(\varphi_0 a_0 X_0, \ldots, \ldots, \varphi_d a_dX_d) + \Tilde{\theta}_1(\varphi_0 a_0 X_0, \ldots, \ldots, \varphi_d a_dX_d) 
\]
where $\theta_1$ was defined in Equation (\ref{cocycle 1}). Before writing down the explicit formula for $\Tilde{\theta}_1$ we introduce some notation. Set
\begin{align*}
E & = r \frac{\partial}{\partial r} , \\
\d \vartheta & = \sum_i \frac{\d z_i}{z_i} .
\end{align*} 
We view $E$ as a vector field on $\RR_{>0}$ and $\d \vartheta$ as a $(1,0)$-form on $\CC^{d} \setminus 0$. Define the functional
\[
\Tilde{\theta}_1(\varphi_0 a_0 X_0,\ldots,\varphi_d a_d X_d) = \frac{1}{2} \sum_{i=1}^{d} \left( \int_I \varphi_0 (E \cdot \varphi_i) \varphi_1\cdots \Hat{\varphi_i} \cdots \varphi_{d}\right)\left(\oint \left(a_0 a_i \d \vartheta\right) \partial a_1 \cdots \Hat{\partial a_i} \cdots \partial a_d \right) \theta(X_0,\ldots,X_d)  .
\]
The functional $\Tilde{\theta}$ defines a local functional in $\cloc^*\left(\Omega^*_{\RR_{>0}} \tensor (A_d \tensor \fg) \right)$ of cohomological degree one. One immediately checks that it is a cocycle. This completes the definition of the factorization Lie algebra $\sG_1'$. 

The factorization Lie algebras $\sG_1$ and $\sG_1'$ are identical as precosheaves of vector spaces. In fact, if we put a filtration on $\sG_1$ and $\sG_1'$ where the central element $K$ has filtration degree one, then the associated graded factorization Lie algebras ${\rm Gr} \; \sG_1$ and ${\rm Gr} \; \sG_1'$ are also identified. The only difference in the Lie algebra structures comes from the deformation of the cocycle determining the extension of $\sG_1'$ given by $\Tilde{\theta}_1$. 

In fact, we will show that $\Tilde{\theta}_1$ is actually an exact cocycle via the cobounding element $\eta \in \cloc^*\left(\Omega^*_{\RR_{>0}} \tensor (A_d \tensor \fg)\right)$ defined by
\[
\eta(\varphi_0a_0X_0,\ldots,\varphi_da_dX_d) = \sum_{i=1}^d \left(\int_I \varphi_0 \left(\iota_{E} \varphi_i \right) \varphi_1 \cdots \Hat{\varphi_i} \cdots \varphi_d\right)\left(\oint \left(a_0 a_i \d \vartheta\right) \partial a_1 \cdots \Hat{\partial a_i} \cdots \partial a_d \right) \theta(X_0,\ldots,X_d)  .
\]

\begin{lem} One has $\d \eta = \Tilde{\theta}_1$, where $\d$ is the differential for the cochain complex $\cloc^*(\Omega^*_{\RR_{>0}} \tensor (A_d \tensor \fg))$. In particular, the factorization Lie algebras $\sG_1$ and $\sG_1'$ are quasi-isomorphic (as $L_\infty$ algebras). An explicit quasi-isomorphism is given by the $L_\infty$ map $\Phi_1 : \sG_1 \to \sG_1'$ that sends the central element $K$ to itself and an element $(\varphi_0 a_0 X_0,\ldots, \varphi_d a_d X_d) \in \Sym^{d+1}(\Omega^*_c \tensor (A_d \tensor \fg)$ to 
\[
(\varphi_0 a_0 X_0,\ldots, \varphi_d a_d X_d) + \eta(\varphi_0 a_0 X_0,\ldots, \varphi_d a_d X_d)\cdot K \in \Sym^{d+1}(\Omega^*_c \tensor (A_d \tensor \fg)) \oplus \CC \cdot K .
\]
\end{lem}

Finally, we define the factorization Lie algebra $\sG_2$. We have already seen that the local cocycle $J(\theta) \in \cloc^*(\fg^{\CC^d})$ determines a central extension of factorization Lie algebras
\[
0 \to \CC \cdot K[-1] \to \sG_{J(\theta)} \to \Omega^{0,*}_{\CC^d,c} \tensor \fg \to 0 .
\]
Of course, we can restrict $\sG_{J(\theta)}$ to a factorization algebra on $\CC^d \setminus 0$. The factorization algebra $\sG_2$ is defined as the pushforward of this restriction along the radial projection: $\sG_2 := \rho_* \left(\sG_{J(\theta)}|_{\CC^d \setminus 0}\right)$. 

Recall the map $\Phi : \Omega^*_{\RR_{>0},c} \tensor (A_d \tensor \fg) \to \rho_*(\Omega^{0,*}_{\CC^d \setminus 0,c} \tensor \fg)$ defined in Equation (\ref{phi map}). On each open set $I \subset \RR_{>0}$ we can extend $\Phi$ by the identity on the central element to a linear map $\Phi_2 : \sG_1' (I) \to \sG_2 (I)$. 

\begin{lem} The map $\Phi_2 : \sG_1'(I) \to \sG_2(I)$ is a map of dg Lie algebras. Moreover, it extends to a map of factorization Lie algebras $\Phi_2 : \sG_1' \to \sG_2$. 
\end{lem}
\begin{proof}
Modulo the central element $\Phi_2$ reduces to the map $\Phi$, which we have already seen is a map of factorization Lie algebras in Proposition \ref{prop: fact lie}. Thus, to show that $\Phi_2$ is a map of factorization Lie algebras we need to show that it is compatible with the cocycles determing the respective central extensions. That is, we need to show that 
\beqn\label{1vs2}
\theta_1'(\varphi_0 a_0 X_0,\ldots,\varphi_d a_d X_d) = \theta_2(\Phi(\varphi_0 a_0X_0),\ldots,\Phi(\varphi_da_dX_d))
\eeqn
for all $\varphi_i a_i X_i \in \Omega^*_{c}(I) \tensor (A_d \tensor \fg)$. The cocycle $\theta_1'$ is only nonzero if one of the $\varphi_i$ inputs is a $1$-form. We evaluate the left-hand side on the $(d+1)$-tuple $(\varphi_0 \d r a_0X_0,\varphi_1 a_1 X_1,\ldots,\varphi_da_dX_d)$ where $\varphi_i \in C^\infty_c(I)$, $a_i \in A_d$, $X_i \in \fg$ for $i=0,\ldots,d$. The result is
\beqnarray
& &\label{calc1a} \left(\int_I \varphi_0 \cdots \varphi_d \d r\right) \left(\oint a_0 \partial a_1 \cdots \partial a_d\right) \theta(X_0,\ldots,X_d) \\
& + & \label{calc1b} \frac{1}{2} \sum_{i=1}^{d} \left( \int_I \varphi_0 (E \cdot \varphi_i) \varphi_1\cdots \Hat{\varphi_i} \cdots \varphi_{d}\d r\right)\left(\oint \left(a_0 a_i \d \vartheta\right) \partial a_1 \cdots \Hat{\partial a_i} \cdots \partial a_d \right) \theta(X_0,\ldots,X_d)
\eeqnarray
We wish to compare this to the right-hand side of Equation (\ref{1vs2}). Recall that $\Phi(\varphi_0 \d r a_0 X_0) = \varphi(r) \d r a_0(z) X_0$ and $\Phi(\varphi_i a_i X_i) = \varphi(r) a_i(z) X_i$. Plugging this into the explicit formula for the cocycle $\theta_2$ we see the right-hand side of (\ref{1vs2}) is 
\beqn\label{calc2}
\left(\int_{\rho^{-1}(I)} \varphi_0(r) \d r a_0(z) \partial(\varphi_1(r) a_1(z)) \cdots \partial(\varphi_d(r) a_d(z))\right) \theta(X_0,\ldots,X_d) .
\eeqn

We pick out the term in (\ref{calc2}) in which the $\partial$ operators only act on the elements $a_i(z)$, $i=1,\ldots, d$. This term is of the form
\[
\int_{\rho^{-1}(I)} \varphi_0(r) \cdots \varphi_d(r) \d r a_0(z) \partial(a_1(z)) \cdots \partial(a_d(z)) \theta(X_0,\ldots,X_d).
\] 
Separating variables we find that this is precisely the first term (\ref{calc1a}) in the expansion of the left-hand side of (\ref{1vs2}). 

Now, note that we can rewrite the $\partial$-operator in terms of the radius $r$ as
\begin{align*}
\partial = \sum_{i=1}^d \d z_i \frac{\partial}{\partial z_i} = \sum_{i=1}^d \d z_i \zbar_i \frac{\partial}{\partial (r^2)} = \sum_{i=1}^d \d z_i \frac{r^2}{2 z_i} \frac{\partial}{\partial r} .
\end{align*}

The remaining terms in (\ref{calc2}) correspond to the expansion of
\[
\partial(\varphi_1(r) a_1(z)) \cdots \partial(\varphi_d(r) a_d(z)),
\]
using the Leibniz rule, for which the $\partial$ operators act on at least one of the functions $\varphi_1,\ldots,\varphi_d$. In fact, only terms in which $\partial$ acts on precisely one of the functions $\varphi_1,\ldots, \varphi_d$ will be nonzero. For instance, consider the term
\beqn\label{term1}
(\partial \varphi_1) a_1(z) (\partial \varphi_2) a_2(z) \partial(\varphi_3(z) a_3(z)) \cdots \partial(\varphi_d(z) a_d(z)).
\eeqn
Now, $\partial \varphi_i(r) = \omega \frac{\partial \varphi}{\partial r}$ where $\omega$ is the one-form $\sum_i (r^2 / 2 z_i) \d z_i$. Thus, (\ref{term1}) is equal to
\[
\left(\omega \frac{\partial \varphi_1}{\partial r} \right) a_1(z) \left(\omega \frac{\partial \varphi_2}{\partial r}  \right) a_2(z) \partial(\varphi_3(z) a_3(z)) \cdots \partial(\varphi_d(z) a_d(z),
\]
which is clearly zero as $\omega$ appears twice.

We observe that terms in the expansion of (\ref{calc2}) for which $\partial$ acts on precisely one of the functions $\varphi_1,\ldots,\varphi_d$ can be written as
\[
\sum_{i=1}^d \int_{\rho^{-1}(I)} \varphi_0(r)\left(r \frac{\partial}{\partial r} \varphi_i(r)\right) \varphi_1(r) \cdots \Hat{\varphi_i(r)} \cdots \varphi_d(r) \d r \frac{r}{2 z_i} \d z_i a_0(z) a_i(z) \partial a_1(z) \cdots \Hat{\partial a_i(z)} \cdots \partial a_d(z) .
\] 
Finally, notice that the function $z_i / 2r$ is independent of the radius $r$. Thus, separating variables we find the integral can be written as
\[
\frac{1}{2} \sum_{i=1}^d \left(\int_{I} \varphi_0 \left(r \frac{\partial}{\partial r} \varphi_i \right) \varphi_1 \cdots \Hat{\varphi_i } \cdots \varphi_d \d r\right) \left(\oint \frac{\d z_i}{z_i} a_0 a_i \partial a_2 \cdots \Hat{\partial a_i} \cdots \partial a_d \right) .
\]
This is precisely equal to the second term (\ref{calc1b}) above. Hence, the cocycles are compatible and the proof is complete. 
\end{proof}

\subsection{A brief comparison with the work of Faonte-Hennion-Kapranov}

\owen{We just do something very quick here, and prepare the way for later discussions.}

\subsection{An $E_d$ algebra by compactifying along tori} 

There is another direction that one may look to extend the notion of affine algebras to higher dimensions.
The affine algebra is a central extension of the loop algebra on $\fg$. 
Instead of looking at higher dimensional sphere algebras, one can consider higher {\em torus} algebras; or iterated loop algebras:
\[
L^d \fg = \CC[z_1^{\pm}, \cdots, z_d^{\pm}] \tensor \fg .
\]
These iterated loop algebras are algebraic versions of the torus mapping space ${\rm Map}(S^1 \times \cdots \times S^1, \fg)$. 
In this section we show what information the Kac-Moody vertex algebra implies about extensions of such iterated loop algebras.

To do this we specialize the Kac-Moody factorization algebra to the complex manifold $(\CC^\times)^d$, which is homotopy equivalent to the topologists torus $(S^1)^{\times d}$.  
We show, in a similar way as above, how to extract the structure of an $E_d$ algebra from considering the nesting of ``polyannuli" in $(\CC^\times)^d$.
These $E_d$-algebras are related to interesting extensions of the Lie algebra $L^d \fg$.

When $d=1$, we have seen that the nesting of ordinary annuli give rise to the structure of an associative algebra. For $d > 1$, a polyannulus is a complex submanifold of the form ${\rm Ann}_1 \times \cdots \times {\rm Ann}_d \subset (\CC^\times)^d$ where each ${\rm Ann}_i \subset \CC^\times$ is an ordinary annulus. Equivalently, a polyannulus is the complement of a closed polydisk inside of a larger open polydisk. We will see how the nesting of annuli in each component gives rise to the structure of a locally constant factorization algebra in $d$ {\em real} dimensions, and hence defines an $E_d$ algebra. 

A result of Knudsen \cite{KnudsenEn}, which we recall below, states that every dg Lie algebra determines an $E_d$-algebra, for any $d>1$, called the universal $E_d$ enveloping algebra.
To state the result precisely we need to be in the context of $\infty$-categories.

\begin{thm}[\cite{KnudsenEn}] Let $\sC$ be a stable, $\CC$-linear, presentable, symmetric monoidal $\infty$-category.
There is an adjunction
\[
U^{E^d} : {\rm LieAlg}(\sC) \leftrightarrows E_d{\rm Alg} (\sC): F
\]
such that for any object $X \in \sC$ one has ${\rm Free}_{E_d}(X) \simeq U^{E_d} {\rm Free}_{Lie}(\Sigma^{d-1} X)$. 
\end{thm}

We are most interested in the case $\sC$ is the category of chain complexes with tensor product $\Ch^{\tensor}$. 
In this situation, the enveloping algebra $U^{E^d}$ agrees with the ordinary universal enveloping algebra when $d=1$.

When the twisting cocycle defining the Kac-Moody factorization algebra is zero we will see that the $E_d$ algebra coming from the product of polyannuli is equivalent to $U^{E_d} (L^d \fg)$.
When we turn on a twisting cocycle we will find the $E_d$-enveloping algebra of a central extension of the iterated loop algebra. 

The Kac-Moody factorization algebra on the $d$-fold $(\CC^\times)^d$ determines a real $d$-dimensional factorization algebra by considering the radius in each complex direction. 
This factorization algebra on $(\RR_{>0})^d$ is defined by the pushforward $\vec{\rho}_*\left(\sG_{\CC^{\times d}}\right)$, 
where $\vec{\rho} : (\CC^\times)^d \to (\RR_{>0})^d$ is the projection $(z_1,\ldots,z_d) \mapsto (|z_1|, \cdots, |z_d|)$. 

On the Lie algebra side, it is an immediate calculation to see that the following formula defines a cocycle on $L^d \fg$ of degree $(d+1)$:
\[
\begin{array}{cccl}
\displaystyle L^d \theta : & (L^d \fg)^{\tensor d + 1} & \to & \CC \\
\displaystyle & (f_0 \tensor X_0)\tensor \cdots \tensor (f_d \tensor X_d) & \mapsto & \displaystyle  \theta(X_0,\ldots,X_d)  \oint_{|z_1| = 1} \cdots \oint_{|z_d| = 1} f_0 \d f_1 \cdots \d f_d .
\end{array}
\]
Here $f_i \tensor X_i \in L^d \fg = \CC[z_1^{\pm}, \cdots, z_d^{\pm}] \tensor \fg$. 
The above is just an iterated version of the usual residue pairing.
This cocycle determines a shifted Lie algebra extension of the iterated loop algebra
\[
\CC[d-1] \to \Hat{L^d \fg}_\theta \to L^d \fg,
\]
that appears in the theorem below. 

The following can be proved in exact analogy as the above result for sphere algebras and we omit the proof here.

\begin{prop}
Fix $\theta \in \Sym^{d+1}(\fg^*)^\fg$ and let $\vec{\rho}_* \UU_\theta \sG_{(\CC^\times)^d}$ be the factorization algebra on $(\RR_{>0})^d$ obtained by reducing the Kac-Moody factorization algebra along the $d$-torus.
There exists a dense $d$-dimensional subfactorization algebra $\sF^{lc}$ that is locally constant and is equivalent, as $E_d$-algebras, to
\[
U^{E_d} \left( \Hat{L^d \fg}_{\theta} \right) .
\]
\end{prop}

%\begin{thm} There is a dense injective map of factorization algebras on $\RR^d$: 
%\[
%\Phi^{L^d} : \left(U_{E_d} \left(\Hat{L^d g}_\theta\right)\right)^{fact} \to \vec{\rho}_*\left(\sG_{\CC^{\times d}}\right) .
%\] 
%\end{thm}

%\subsection{The disk as a module}

\subsection{Large $N$ limits}

\section{Global aspects of the higher Kac-Moody factorization algebras}

In this section we explore global properties of the Kac-Moody factorization algebra on complex manifolds. 
The first of which is the (shifted) Poisson structure on the ``classical limit" of the Kac-Moody factorization algebra.
In the world of CFT, many vertex algebras admit classical limits which have the structure of {\em Poisson vertex algebras}. 
Roughly, these are vertex algebras with a commutative OPE together with a family of $z$-dependent brackets which are biderivations for the OPE.
The concept of a $P_0$-factorization algebra specializes to this in the case of complex one-dimensional holomorphic factorization algebras but applies more generally to factorization algebras in any dimension.

Next, we will compute the factorization homology, or global sections, of the Kac-Moody factorization algebra along a class of complex manifolds called {\em Hopf manifolds}.
We choose to focus on these because the answer admits a concise description in terms of classical algebra, and for the application for studying the gauge equivariance for the partition function of the higher dimensional $\sigma$-model from Chapter \ref{chap: holsig}. 
After this, we discuss variants of the twisted Kac-Moody factorization algebra that exist on complex $d$-folds.
These variants are related to the approach of studying higher dimensional holomorphic gauge symmetries due to Nekrasov, et. al..

\subsection{Hopf manifolds and twisted indices}

We focus on a family of complex manifolds defined by Hopf in \cite{Hopf} defined in every complex dimension $d$. 

\begin{dfn}
Fix an integer $d \geq 1$.
Let $f : \CC^d \to \CC^d$ be a polynomial map such that $f(0) = 0$ such that its Jacobian at zero $Jac(f)(0)$ is invertible with eigenvalues $\{\lambda_i\}$ all satisfying $|\lambda_i|<1$. 
Define the {\em Hopf manifold associated to $f$} to be the $d$-dimensional complex manifold
\[
X_f := \left. \left(\CC^d \setminus \{0\}\right) \right/ (x \sim f(x)) .
\]
\end{dfn}

Note that $X_{f}$ is compact for any $f$. 
In the case $d=1$ all Hopf surfaces are equivalent to elliptic curves.

\begin{lem} 
For any $f$ there is a diffeomorphism $X_f \cong S^{2d-1} \times S^1$.
\end{lem}

This implies that when $d > 1$, the cohomology $H^{2}_{dR} (X_f) = 0$ for any $f$. 
In particular, $X_f$ is {\em not} K\"{a}hler when $d > 1$. 
For $1 \leq i \leq d$ let $q_i \in D(0,1)^{\times}$ be a nonzero complex number of modulus $|q_i| <1$. 
The $d$-dimensional {\em Hopf manifold of type} ${\bf q} = (q_1,\ldots,q_d)$ is the following quotient of punctured affine space $\CC^d \setminus \{0\}$ by the discrete group $\ZZ^d$:
\[
X_{\bf q} = \left. \left(\CC^d \setminus \{0\}\right) \right/ \left( (z_1,\ldots,z_d) \sim (q_1^{2\pi i \ZZ} z_1, \ldots,q_d^{2 \pi i \ZZ} z_d) \right) .
\]
Note that in the case $d = 1$ we recover the usual description of an elliptic curve $X_{\bf q} = E_q = \CC^\times / q^{2 \pi i \ZZ}$. 
We will denote the quotient map $p_{\bf q} : \CC^d \setminus \{0\} \to X_{\bf q}$. 

For any $d$ and tuple $(q_1,\ldots, q_d)$ as above, we see that as a smooth manifold there is a diffeomorphism $X_{\bf q} \cong S^{2d-1} \times S^1$. 
Indeed, the radial projection map $\CC^d \setminus \{0\} \to \RR_{>0}$ defines a smooth $S^{2d-1}$-fibration over $\RR_{>0}$. 
Passing to the quotient, we obtain an $S^{2d - 1}$-fibration 
\[
X_{\bf q} \to \left. \RR_{>0} \right/ \left(r \sim \lambda^{\ZZ} \cdot r \right) \cong S^1 .
\]
Here, $\lambda = (|q_1|^2 + \cdots + |q_d|^2)^{1/2} > 0$. 
Since there are no non-trivial $S^{2d-1}$ fibrations over $S^1$ we obtain $X_{\bf q} = S^{2d-1} \times S^1$ as smooth manifolds. 

\begin{prop}
Let $X$ be a Hopf manifold and suppose $\theta \in \Sym^{d+1}(\fg^*)^\fg$ is any $\fg$-invariant polynomial of degree $(d+1)$. 
Then, there is a quasi-isomorphism of $\CC[K]$-modules
\[
\int_X \UU_\theta (\sG_X) \simeq \Hoch_*(U \fg)[K] .
\]
\end{prop}
\begin{proof}
Let's first consider the untwisted case where the statement reduces to $\int_X \UU (\sG_X) \simeq \Hoch_*(U \fg)$.
The factorization homology on the left hand side is computed by
\[
\int_X \UU(\sG_X) = \clieu_*(\Omega^{0,*}(X) \tensor \fg) .
\]
Now, since every Hopf manifold is Dolbeault formal there is a quasi-isomorphism of commutative dg algebras
\[
\left(H^{0,*}(X), 0\right) \simeq \left(\Omega^{0,*}(X), \dbar\right) .
\]
In fact, we have written down a preferred presentation for the cohomology ring of $X$ given by $H^{0,*}(X) = \CC[\delta]$ where $|\delta| = 1$.
A particular Dolbeault representative for $\delta$ given by
\[
\dbar (\log |z|^2) = \sum_i \frac{z_i\d \zbar_i}{|z|^2}
\]
where $z = (z_1,\ldots,z_d)$ is the coordinate on $\CC^d \setminus \{0\}$. 

Applied to the global sections of the Kac-Moody we see that there is a quasi-isomorphism
\[
\int_X \UU(\sG_X) \simeq \clieu_*(\CC[\delta] \tensor \fg) .
\]
Now, note that $\clieu_*(\CC[\delta] \tensor \fg) = \clieu_*(\fg \oplus \fg[-1]) = \clieu_*(\fg, \Sym (\fg))$, where $\Sym(\fg)$ is the symmetric product of the adjoint action of $\fg$ on itself. 
By Poincar\'{e}-Birkoff-Witt there is an isomorphism of vector spaces $\Sym(\fg) = U \fg$, so we can write this as $\clieu_*(\fg, \Sym (\fg))$.

Now, any $U(\fg)$-bimodule $M$ is automatically a module for the Lie algebra $\fg$ by the formula $x \cdot m = xm - mx$ where $x \in \fg$ and $m \in M$.
Moreover, for any such bimodule there is a quasi-isomorphism of cochain complexes 
\[
\clieu_*(\fg, M) \simeq {\rm Hoch}_*(U\fg, M) .
\]
This is proved, for instance, in Section 2.3 of \cite{lectETH}.
Applied to the bimodule $M = U\fg$ itself we obtain a quasi-isomorphism $\clieu_*(\fg , U\fg) \simeq {\rm Hoch}(U\fg)$.

The twisted case is similar. 
Let $\theta$ be as in the statement.
Then, the factorization homology is equal to
\[
\int_X \UU_\theta (\sG_X) = \left(\Sym(\Omega^{0,*}(X) \tensor \fg)[K] , \dbar + \d_{CE} + \d_\theta\right) .
\]
Applying Dolbeault formality again we see that this is quasi-isomorphic to the cochain complex
\beqn\label{twisted hopf}
\left(\Sym(\fg[\delta])[K] ,  \d_{CE} + \d_\theta \right) .
\eeqn
We note that $\d_\theta$ is identically zero on $\Sym(\fg[\delta])$. 
Indeed, for degree reasons, at least one of the inputs must be from $\fg \hookrightarrow \fg[\delta] = \fg \oplus \fg[-1]$, which consists of constant functions on $X$ with values in the Lie algebra $\fg$. 
In the formula for the local cocycle from Proposition \ref{prop j map} associated to $\theta$ it is clear that if any one of the inputs is constant the cocycle vanishes. 
Indeed, one can integrate by parts to put it in the form $\int \partial \alpha \cdots \partial \alpha$, which is the integral of a total derivative, hence zero since $X$ has no boundary.
Thus (\ref{twisted hopf}) just becomes the Chevalley-Eilenberg complex with values in the trivial module $\CC[K]$. 
By the same argument as in the untwisted case, we conclude that in this case the factorization homology is quasi-isomorphic to $\Hoch_*(U \fg)[K]$ as desired.
\end{proof}

There is an interesting consequence of this calculation to the Hochschild homology for the $A_\infty$ algebra $U(\Hat{\fg}_{d,\theta})$.
It is easiest to state this when $X$ is a Hopf manifold of the form $(\CC^d \setminus \{0\}) / q^\ZZ$ for a single $q =q_1=\cdots=q_d \in D(0,1)^\times$ where the quotient is by the relation $(z_1,\ldots,z_d) \simeq (q^\ZZ z_1,\ldots,q^\ZZ)$.
Let $p_q :  \CC^d \setminus \{0\} \to X$ be the quotient map.
Consider the following diagram
\[
\xymatrix{
\CC^d \setminus \{0\} \ar[r]^-{p_q} \ar[d]^-{\rho} & X \ar[d]^{\Bar{\rho}} \\
\RR_{>0} \ar[r]^-{\Bar{p}_q} & S^1
}
\]
Here, $\rho$ is the radial projection map and $\Bar{\rho}$ is the induced map defined by the quotient.
The action of $\ZZ$ on $\CC^d \setminus\{0\}$ gives $\sG_{\CC^d \setminus \{0\}}$ the structure of a $\ZZ$-equivariant factorization algebra. 
In turn, this determines an action of $\ZZ$ on pushforward factorization algebra $\rho_* \sG_{\CC^d \setminus \{0\}}$.
We have seen that there is a dense locally constant subfactorization algebra on $\RR_{>0}$ of the pushforward that is equivalent as an $E_1$ algebra to $U(\Hat{\fg}_{d,\theta})$.
A consequence of excision for factorization homology, see Lemma 3.18 \cite{AFTopMan}, implies that there is a quasi-isomorphism
\[
\Hoch_*(U(\Hat{\fg}_{d,\theta}), q) \simeq \int_{S^1} \Bar{\rho}_* \UU_\alpha(\sG_X),
\]
where the right-hand side is the Hochschild homology of the algebra $U \Hat{\fg}_{d,\theta}$ with coefficients in the bimodule $U \Hat{\fg}_{d, \theta}$ with the ordinary left-module structure and right-module structure given by twisting the ordinary action by the automorphism corresponding to the element $1 \in \ZZ$ on the algebra.

Moreover, by the push-forward for factorization homology, Proposition 3.23 \cite{AFTopMan}, there is an equivalence
\[
\int_{S^1} \Bar{\rho}_* \UU_\alpha(\sG_X) \xto{\simeq} \int_X \UU_{\alpha} (\sG_X) .
\]

We have just shown that the factorization homology of $\sG_X$ is equal to the Hochschild homology of $U\fg$ so that
\[
\Hoch_*(U(\Hat{\fg}_{d,\theta}), q) \simeq \Hoch_* (U\fg)[K] .
\]
This statement is purely algebraic as the dependence on the manifold for which the Kac-Moody lives has dropped out.
It may be easiest to understand in the case $d=1$ and $\theta = 0$. 
Then $\fg_{d,\theta}$ is the loop algebra $L\fg = g [z,z^{-1}]$. 
The action of $\ZZ$ on $L\fg$ rotates the loop parameter: for $z^n \tensor \fg \in L \fg = \CC[z,z^{-1}] \tensor \fg$ the action of $1 \in \ZZ$ is $1 \cdot (z^n \tensor \fg) = q^n z^n \tensor \fg$. 
In turn, the bimodule structure of $U(\fg[z,z^{-1}])$ on itself, which we denote $U(\fg[z,z^{-1}])_q$ is the ordinary one on the left and on the right is given by twisting by the automorphism corresponding to $1 \in \ZZ$. 
The complex $\Hoch_*(U(g[z,z^{-1}]), q)$ is the Hochschild homology of $U(\fg[z,z^{-1}])$ with values in this bimodule.
Thus, the statement implies that there is a quasi-isomorphism
\[
\Hoch_*\left(U(\fg[z,z^{-1}]), U(\fg[z,z^{-1}])_q \right) \simeq \Hoch(U \fg) . 
\]

\subsection{Variants of the higher Kac-Moody factorization algebras}

\owen{Find more specific title}

So far we have mostly restricted ourselves to studying the Kac-Moody factorization algebra corresponding to local cocycles of type $\fj_X(\theta)$ where $\theta \in \Sym^{d+1}(\fg^*)^\fg$.
There is another class of local cocycles that appear when studying symmetries of holomorphic theories. 
Unlike the cocycle $\fj_X(\theta)$, which in some sense did not depend on the manifold $X$, this class of cocycles is more dependent on the manifold for which the current algebra lives.

Let $X$ be a complex manifold of dimension $d$ and suppose $\omega$ is a $(k,k)$ form on $X$. 
Fix, in addition, a form $\theta_{d+1-k} \in \Sym(\fg^*)^\fg$.
Then, we may consider the cochain on $\sG(X)$:
\[
\begin{array}{cccc}
\displaystyle \phi_{\theta, \omega} : & \sG(X)^{\tensor d + 1 - k} & \to & \CC \\
\displaystyle & \alpha_0 \tensor\cdots \tensor \alpha_{d-k} & \mapsto & \displaystyle \int_X \omega \wedge \theta_{d+1-k}(\alpha_0, \partial\alpha_1,\ldots,\partial \alpha_{d-k})
\end{array}
\]
It is clear that $\phi_{\theta,\omega}$ is a local cochain on $\sG(X)$. 

\begin{lem}\label{lem: cocycle KM}
Let $\theta \in \Sym^{d+1-k}(\fg^*)^\fg$ and suppose $\omega \in \Omega^{k,k}(X)$ satisfies $\dbar \omega = 0$ and $\partial \omega = 0$. 
Then, $\phi_{\theta, \omega} \in \cloc^*(\sG_X)$ is a local cocycle. 
Moreover, for fixed $\theta$ the cohomology class $[\phi_{\theta,\omega}] \in H^1_{\rm loc}(\sG_X)$ only depends on the cohomology class 
\[
[\omega] \in H^{k}(X , \Omega^k_{cl}) .
\]
\end{lem}

Note that when $\omega = 1$ it trivially satisfies the conditions of the lemma. 
In this case $\phi_{\theta, 1} = \fj_X(\theta)$ in the notation of the last section. 

This class of cocycles is related to the ordinary Kac-Moody factorization and vertex algebra on Riemann surfaces in a natural way.
Consider the following two examples. 

\begin{eg}
We consider the complex manifold $X = \Sigma \times \PP^{d-1}$ where $\Sigma$ is a Riemann surface and $\PP^{d-1}$ is $(d-1)$-dimensional complex projective space.
Suppose that $\omega \in \Omega^{d-1,d-1}(\PP^{d-1})$ is the natural volume form, this clearly satisfies the conditions of Lemma \ref{lem: cocycle KM} and so determines a degree one cocycle $\phi_{\kappa, \omega} \in \cloc^*(\sG_{\Sigma \times \PP^{d-1}})$ where $\kappa$ is some $\fg$-invariant bilinear form $\kappa : \fg \times \fg \to \CC$. 
We can then consider the twisted enveloping factorization algebra of $\sG_{\Sigma \times \PP^{d-1}}$ by the cocycle $\phi_{\kappa, \omega}$. 

Recall that if $p : X \to Y$ and $\sF$ is a factorization algebra on $X$, then the pushforward $p_* \sF$ on $Y$ is defined on opens by $p_* \sF : U \subset Y \mapsto \sF(p^{-1} U)$. 

\begin{prop}
Let $\pi : \Sigma \times \PP^{d-1} \to \Sigma$ be the projection. 
Then, there is a quasi-isomorphism between the following two factorization algebras on $\Sigma$:
\begin{enumerate}
\item $\pi_* \UU_{\phi_{\kappa, \theta}} \left(\sG_{\Sigma \times \PP^{d-1}}\right)$, the pushforward along $\pi$ of the Kac-Moody factorization algebra on $\Sigma \times \PP^{d-1}$ of type $\phi_{\kappa,\omega}$;
\item $\UU_{{\rm vol}(\omega) \kappa} (\sG_\Sigma)$, the Kac-Moody factorization algebra on $\Sigma$ associated to the invariant pairing ${\rm vol}(\omega) \cdot \kappa$. 
\end{enumerate}
\end{prop}

The twisted enveloping factorization on the right-hand side is the familiar Kac-Moody factorization alegbra on Riemann surfaces associated to a multiple of the pairing $\kappa$.
The twisting ${\rm vol}(\omega) \kappa$ corresponds to a cocycle of the type in the previous section 
\[
J({\rm vol}(\omega) \kappa) = {\rm vol}(\omega) \int_\Sigma \kappa(\alpha, \partial \beta)
\]
where ${\rm vol}(\omega) = \int_{\PP^{d-1}} \omega$. 

\begin{proof}
Suppose that $U \subset \Sigma$ is open. 
Then, the factorization algebra $\pi_* \UU_{\phi_{\kappa, \theta}} \left(\sG_{\Sigma \times \PP^{d-1}}\right)$ assigns to $U$ the cochain complex
\beqn\label{KMPn}
\left(\Sym \left(\Omega^{0,*} (U \times \PP^{d-1})\right)[1] [K], \dbar + K \phi_{\kappa, \omega}|_{U \times \PP^{d-1}} \right),
\eeqn
where $\phi_{\kappa, \omega}|_{U \times \PP^{d-1}}$ is the restriction of the cocycle to the open set $U \times \PP^{d-1}$. 
Since projective space is Dolbeault formal its Dolbeault complex is quasi-isomorphic to its cohomology.
Thus, we have
\[
\Omega^{0,*} (U \times \PP^{d-1}) = \Omega^{0,*}(U) \tensor \Omega^{0,*}(\PP^{d-1}) \simeq \Omega^{0,*}(U) \tensor H^*(\PP^{d-1}, \sO) \cong \Omega^{0,*}(U) .
\]
Under this quasi-isomorphism, the restricted cocycle has the form
\[
\phi_{\kappa,\omega}|_{U \times \PP^{d-1}} (\alpha \tensor 1, \beta \tensor 1) = \int_{U} \kappa(\alpha, \partial \beta) \int_{\PP^{n-1}} \omega 
\]
where $\alpha,\beta \in \Omega^{0,*} (U)$ and $1$ denotes the unit constant function on $\PP^{d-1}$. 
This is precisely the value of the local functional ${\rm vol}(\omega) J_\Sigma (\kappa)$ on the open set $U \subset \Sigma$. 
Thus, the cochain complex (\ref{KMPn}) is quasi-isomorphic to 
\beqn
\left(\Sym \left(\Omega^{0,*} (U) \right)[1] [K], \dbar + K {\rm vol}(\omega) J_\Sigma (\kappa) \right) .
\eeqn
We recognize this as the value of the Kac-Moody factorization algebra on $\Sigma$ of type ${\rm vol}(\omega) J_\Sigma (\kappa)$.
It is immediate to see that identifications above are natural with respect to maps of opens, so that the factorization structure maps are the desired ones. 
This completes the proof.
\end{proof}
\end{eg}

\begin{eg}
Fix two Riemann surfaces $\Sigma_1,\Sigma_2$ and let $\omega_1,\omega_2$ be the K\"{a}hler forms. 
Then, we can consider the two projections
\[
\begin{tikzcd}
& \Sigma_1 \times \Sigma_2 \arrow[dl,"\pi_1"'] \arrow[dr,"\pi_2"] & \\
\Sigma_1 & & \Sigma_2
\end{tikzcd}
\]
Consider the following closed $(1,1)$ form $\omega = \pi_1^* \omega_1 + \pi_2^* \omega_2 \in \Omega^{1,1}(\Sigma_1 \times \Sigma_2)$. 
According to the proposition above, for any symmetric invariant pairing $\kappa \in \Sym^2 (\fg^*)^\fg$ this form determines a bilinear local functional
\[
\phi_{\kappa,\omega}(\alpha) = \int_{\Sigma_1 \times \Sigma_2} \omega \wedge \kappa(\alpha, \partial \alpha) 
\]
on the local Lie algebra $\sG_{\Sigma_1\times \Sigma_2}$.
A similar calculation as in the previous example implies that the pushforward factorization algebra $\pi_{i*}\UU_{\phi_{\kappa, \omega}}\sG$, $i=1,2$, is isomorphic to the two-dimensional Kac-Moody factorization algebra on the Riemann surface $\Sigma_i$ with level equal to the Euler characteristic $\chi(\Sigma_j)$, where $j \ne i$. 
This result was alluded to in the work of Johansen in \cite{JohansenKM} where he showed that there exists a copy of the Kac-Moody chiral algebra inside the operators of a twist of the $\cN=1$ supersymmetric multiplet (both the gauge and matter multiplets, in fact) on the K\"{a}hler manifold $\Sigma_1 \times \Sigma_2$. 
In the next section we will see how the {\em two-dimensional} Kac-Moody factorization algebra embeds inside the operators of a holomorphic theory on a complex surface. 
This holomorphic theory is the twist (as we stated in the previous chapter) of the $\cN=1$ multiplet.
Thus, we obtain an enhancement of Johansen's result to a two-dimensional current algebra.
\end{eg}

\subsection{Large $N$ limits}

%\brian{relate to work of Nekrasov et al}

\appendix
\section{Local functionals}
\label{appx:locfncl}

In our approach, the space of fields will always be equal to the space of smooth sections of a $\ZZ$-graded vector bundle $E\to X$ on a manifold $\sE = \Gamma(X, E)$. 
The class of functionals $S : \sE \to \RR$ defining the classical theories we consider are required to be {\em local}, or given by the integral of a Lagrangian density. 
We define this concept now.

Let $D_X$ denote the sheaf of differential operators on $X$. 
The $\infty$-jet bundle ${\rm Jet}(E)$ of a vector bundle $E$ is the vector bundle whose fiber over $x \in X$ is the space of formal germs at $x$ of sections of $E$. 
It is a standard fact that ${\rm Jet}(E)$ is equipped with a flat connection giving its space of sections $J(E) = \Gamma(X, {\rm Jet}(E))$ the structure of a $D_X$-module.

Above, we have defined the algebra of functions $\sO(\sE(X))$ on the space of sections $\sE(X)$.
Similarly, let $\sO_{red}(\sE(X)) = \sO(\sE(X)) / \RR$ be the quotient by the constant polynomial functions. 
The space $\sO_{red}(J(E))$ inherits a natural $D_X$-module structure from $J(E)$. 
We refer to $\sO_{red}(J(E))$ as the space of {\em Lagrangians} on the vector bundle $E$. 
Every element $F \in \sO_{red}(J(E))$ can be expanded as $F = \sum_n F_n$ where each $F_n$ is an element 
\beqn
F_n \in {\rm Hom}_{C^\infty_X} (J(E)^{\tensor n}, C^\infty_X)_{S_n} \cong {\rm PolyDiff}(\sE^{\tensor n}, C^\infty(X))_{S_n}
\eeqn
where the right-hand side is the space of polydifferential operators.
The proof of the isomorphism on the right-hand side can be found in Chapter 5 of \cite{CostelloRenormalization}.

A local functional is given by a Lagrangian densities modulo total derivatives.
The mathematical definition is the following.

\begin{dfn} \label{dfn: local fnl}
Let $E$ be a graded vector bundle on $X$.
Define the sheaf of {\em local functionals} on $X$ to be
\beqn
\oloc(\sE) = {\rm Dens}_X \tensor_{D_X} \sO_{red}(J(E)),
\eeqn
where we use the natural right $D_X$-module structure on densities.
\end{dfn}

Note that we always consider local functionals coming from Lagrangians modulo constants. 
We will not be concerned with local functions associated to constant Lagrangians. 

From the expression for functionals in Lemma \ref{lem: fnls} we see that integration defines an inclusion of sheaves
\[\label{local inclusion}
i : \oloc(\sE) \hookrightarrow \sO_{red}(\sE_c) .
\]
Often times when we describe a local functional we will write down its value on test compactly supported sections, then check that it is given by integrating a Lagrangian density, which amounts to lifting the functional along $i$. 

\section{Computing the deformation complex}\label{sec: hol trans}

There is a succinct way of expressing holomorphic translation invariance as the Lie algebra invariants of a certain {\em dg Lie algebra}.
Denote by $\CC^d[1]$ the abelian $d$-dimensional graded Lie algebra in concentrated in degree $-1$ by the elements $\{\Bar{\eta}_i\}$.
We want to consider deformations that are invariant for the action by the total {\em dg} Lie algebra $\CC^{2d|d} = \CC^{2d} \oplus \CC^d[1]$.
The differential sends $\eta_i \mapsto \frac{\partial}{\partial \zbar_i}$.
The space of holomorphically translation invariant local functionals are denoted by $\oloc(\sE_V)^{\CC^{2d|d}}$.
The enveloping algebra of $\CC^{2d|d}$ is of the form
\beqn
U(\CC^{2d|d}) = \CC \left[\frac{\partial}{\partial z_i},  \frac{\partial}{\partial \zbar_i}, \eta_i \right]
\eeqn
with differential induced from that in $\CC^{2d|d}$. 
Note that this algebra is quasi-isomorphic to the algebra of constant coefficient holomorphic differential operators $\CC[\partial / \partial z_i] \xto{\simeq} U(\CC^{2d|d})$. 


In this section we specialize the functional $J$ to the space $Y = \CC^d$ and use it to completely characterize the $U(d)$-invariant, holomorphically translation invariant deformation complex.

\begin{prop}\label{prop: local def}
The map $J : \Omega^{d+1}_{cl}(B \fg) [d] \to \Def_{\CC^d \to B \fg}^{\rm cot}$ factors through the holomorphically translation invariant deformation complex:
\beqn
J : \Omega^{d+1}_{cl}(B \fg) [d] \to \left(\Def^{\rm cot}_{\CC^d \to B \fg}\right)^{\CC^{2d|d}} .
\eeqn
Furthermore, $J$ defines a quasi-isomorphism into the $U(d)$-invariant subcomplex of the right-hand side.
\end{prop}

\begin{proof}
To compute the translation invariant deformation complex we will invoke Corollary \ref{cor: hol trans invt def} from Section \ref{sec: hol trans}.
Note that the deformation complex is simply the (reduced) local cochains on the local Lie algebra $\Omega^{0,*}_{\CC^d} \tensor \fg$. 
Thus, in the notation of Section \ref{sec: hol theory} the bundle $V$ is simply the trivial bundle $\fg$.
Thus, we see that the translation invariant deformation complex is quasi-isomorphic to the following cochain complex
\beqn
\left(\Def^{\rm cot}_{Y \to B\fg}\right)^{\CC^{2d|d}} \; \simeq \; \CC \cdot \d^d z \tensor^{\LL}_{\CC\left[\frac{\partial}{\partial z_i}\right]} \cred^*(\fg[[z_1,\ldots,z_d]])  [d] .
\eeqn
We'd like to recast the right-hand side in a more geometric way. 

Note that the the algebra $\CC\left[\frac{\partial}{\partial z_i}\right]$ is the enveloping algebra of the abelian Lie algebra $\CC^d = \CC\left\{\frac{\partial}{\partial z_i}\right\}$. 
Thus, the complex we are computing is of the form
\beqn
\CC \cdot \d^d z \tensor^{\LL}_{U(\CC^d)} \cred^*(\fg[[z_1,\ldots,z_d]]) [d] .
\eeqn
Since $\CC \cdot \d^d z$ is the trivial module, this is precisely the Chevalley-Eilenberg cochain complex computing Lie algebra homology of $\CC^d$ with values in the module $\cred^*(\fg[[z_1,\ldots,z_d]])$:
\beqn
\left(\Def^{\rm cot}_{Y \to B\fg}\right)^{\CC^d} \; \simeq  \; \clieu_*\left(\CC^d ; \cred^*(\fg[[z_1,\ldots,z_d]]) \d^d z\right) [d] .
\eeqn
We will keep $\d^d z$ in the notation since below we are interested in computing the $U(d)$-invariants, and it has non-trivial weight under the action of this group.

To compute the cohomology of this complex, we will first describe the differential explicitly. 
There are two components to the differential.
The first is the ``internal" differential coming from the Lie algebra cohomology of $\fg [[z_1,\ldots,z_d]]$, we will write this as $\d_{\fg}$. 
The second comes from the $\CC^d$-module structure on $\clie^*(\fg[[z_1,\ldots,z_n]])$ and is the differential computing the Lie algebra homology, which we denote $\d_{\CC^d}$. 
We will employ a spectral sequence whose first term turns on the $\d_{\fg}$ differential.
The next term turns on the differential $\d_{\CC^d}$.

As a graded vector space, the cochain complex we are trying to compute has the form
\beqn
\Sym(\CC^d [1]) \tensor \cred^*\left(\fg[[z_1,\ldots,z_d]])\right) \d^d z [d] .
\eeqn
The spectral sequence is induced by the increasing filtration of $\Sym(\CC^d [1])$ by symmetric powers
\beqn
F^k = \Sym^{\leq k}(\CC^d[1]) \tensor \cred^*\left(\fg[[z_1,\ldots,z_d]])\right) \d^d z [d] .
\eeqn

\begin{rmk}
In the examples we are most interested in (namely $\fg = \CC^n[-1]$ and $\fg = \fg_{X_{\dbar}}$) we can understand the spectral sequence we are using as a version of the Hodge-to-de Rham spectral sequence.
\end{rmk}

As above, we write the generators of $\CC^d$ by $\frac{\partial}{\partial z_i}$. 
Also, note that the reduced Chevalley-Eilenberg complex has the form
\beqn
\cred^*(\fg[[z_1,\ldots,z_n]]) = \left(\Sym^{\geq 1} \left(\fg^\vee [z_1^\vee,\ldots,z_d^\vee][-1] \right), \d_{\fg}\right),
\eeqn
where $z_i^\vee$ is the dual variable to $z_i$. 

Recall, we are only interested in the $U(d)$-invariant subcomplex of this deformation complex. 
Sitting inside of $U(d)$ we have $S^1 \subset U(d)$ as multiples of the identity. 
This induces an overall weight grading to the complex.
The group $U(d)$ acts in the standard way on $\CC^d$.
Thus, $z_i$ has weight $(+1)$ and both $z_i^\vee$ and $\frac{\partial}{\partial z_i}$ have $S^1$-weight $(-1)$. 
Moreover, the volume element $\d^d z$ has $S^1$ weight $d$.
It follows that in order to have total $S^1$-weight that the total number of $\frac{\partial}{\partial z_i}$ and $z_i^\vee$ must add up to $d$.
Thus, as a graded vector space the invariant subcomplex has the following decomposition
\beqn
\bigoplus_k \Sym^k(\CC^d[1]) \tensor \left(\bigoplus_{i \leq d-k} \Sym^{i} \left(\fg^\vee [z_1^\vee,\ldots,z_d^\vee][-1] \right) \right) \d^d z [d] .
\eeqn
It follows from Schur-Weyl that the space of $U(d)$ invariants of the $d$th tensor power of the fundamental representation $\CC^d$ is one-dimensional, spanned by the top exterior power. 
Thus, when we pass to the $U(d)$-invariants, only the unique totally antisymmetric tensor involving $\frac{\partial}{\partial z_i}$ and $z_i^\vee$ survives. 
Thus, for each $k$, we have
\[
\label{U(d) invariants}
\left(\Sym^k(\CC^d[1]) \tensor \left(\bigoplus_{i \leq d-k} \Sym^{i} \left(\fg^\vee [z_1^\vee,\ldots,z_d^\vee][-1] \right) \right) \d^d z\right) \cong \wedge^{k}\left(\frac{\partial}{\partial z_i}\right) \wedge \wedge^{d-k}\left(z_i^\vee\right) \clie^*\left(\fg , \Sym^{d-k}(\fg^\vee)\right) \d^d z .
\]
Here, $\wedge^{k}\left(\frac{\partial}{\partial z_i}\right) \wedge \wedge^{d-k}\left(z_i^\vee\right)$ is just a copy of the determinant $U(d)$-representation, but we'd like to keep track of the appearances of the partial derivatives and $z_i^\vee$. 
Note that for degree reasons, we must have $k \leq d$. 
When $k = 0$ this complex is the (shifted) space of functions modulo constants on the formal moduli space $B\fg$, $\sO_{red}(B\fg)[d]$. 
When $k \geq 1$ this the (shifted) space of $k$-forms on the formal moduli space $B\fg$, which we write as $\Omega^{k}(B \fg)[d+k]$.
Thus, we see that before turning on the differential on the next page, our complex looks like
\[
\label{bg def complex1}
\xymatrix{
\ul{-2d} & \cdots & \ul{-d-1} & \ul{-d} \\
\sO_{red}(B \fg) & \cdots & \Omega^{d-1} (B \fg) & \Omega^{d}(B \fg) .
}
\]
We've omitted the extra factors for simplicity. 

We now turn on the differential $\d_{\CC^d}$ coming from the Lie algebra homology of $\CC^d = \CC\left\{\frac{\partial}{\partial z_i}\right\}$ with values in the above module. 
Since this Lie algebra is abelian the differential is completely determined by how the operators $\frac{\partial}{\partial z_i}$ act.
We can understand this action explicitly as follows.
Note that $\frac{\partial}{\partial z_i} z_j = \delta_{ij}$, thus we may as well think of $z_i^\vee$ as the element $\frac{\partial}{\partial z_i}$. 
Consider the subspace corresponding to $k=d$ in Equation (\ref{U(d) invariants}):
\beqn
\frac{\partial}{\partial z_1} \cdots \frac{\partial}{\partial z_d} \cred^*(\fg) \d^d z .
\eeqn 
Then, if $x \in \fg^\vee [-1] \subset \cred^*(\fg)$ we observe that
\beqn
\d_{\CC^d} \left(\frac{\partial}{\partial z_1} \cdots \frac{\partial}{\partial z_d} \tensor f \tensor \d^d z \right) = \det (\partial_i, z_j^\vee) \tensor 1 \tensor x \tensor \d^d z \in  \wedge^{d-1}\left(\frac{\partial}{\partial z_i}\right) \wedge \CC \{z_i^\vee\} \clie^*\left(\fg , \fg^\vee \right) \d^d z.
\eeqn
This follows from the fact that the action of $\frac{\partial}{\partial z_i}$ on $x = x \tensor 1 \in \fg^\vee \tensor \CC[z_i^\vee]$ is given by
\beqn
\frac{\partial}{\partial z_i} \cdot (x \tensor 1) = 1 \tensor x \tensor z_i^\vee \in \clie^*(\fg , \fg^\vee) z_i^\vee .
\eeqn
By the Leibniz rule we can extend this to get the formula for general elements $f \in \cred^*(\fg)$. 
We find that getting rid of all the factors of $z_i$ we recover precisely the de Rham differential 
\beqn
\xymatrix{ 
\cred^*(\fg) [2d] \ar@{=}[d] \ar[r]^-{\d_{\CC^d}} & \clie^*(\fg , \fg^\vee) [2d-1] \ar@{=}[d] \\
\sO_{red}(B\fg) \ar[r]^-{\partial} & \Omega^1(B \fg) .
}
\eeqn
A similar argument shows that $\d_{\CC^d}$ agrees with the de Rham differential on each $\Omega^k(B \fg)$. 


We conclude that the $E_2$ page of this spectral sequence is quasi-isomorphic to the following truncated de Rham complex.
\[
\label{bg def complex2}
\xymatrix{
\ul{-2d} & \ul{-2d+1} & \cdots & \ul{-d-1} & \ul{-d} \\
\sO_{red}(B \fg) \ar[r]^-{\partial} & \Omega^1(B \fg) \ar[r] & \cdots \ar[r] & \Omega^{d-1} (B \fg) \ar[r]^-{\partial} & \Omega^{d}(B \fg) .
}
\]
This is precisely a shifted version of the complex we had in (\ref{truncated de rham1}).
We saw that it was quasi-isomorphic, through the de Rham differential, to $\Omega^{d+1}_{cl}[d]$. 
This completes the proof.
\end{proof}

We can apply this general result to the case $\fg =\CC^n[-1]$.
Doing this we have the following corollary.

\begin{cor}\label{cor: defcor}
Let $\Def_n$ be the deformation complex of the formal $\beta\gamma$ system with target $\hD^n$.
There is a $(\Vect, \GL_n)$-equivariant quasi-isomorphism
\beqn
J : \hOmega^{d+1}_{n,cl} [d] \xto{\simeq} \left(\left(\Def^{\rm cot}_n\right)^{\CC^{2d|d}}\right)^{U(d)} \subset \Def_n .
\eeqn
\end{cor}

This induces a quasi-isomorphism into the $(\Vect, \GL_n)$-equivariant deformation complex
\[
\label{j w map}
J^{\rm W} : \clie^*(\Vect , \GL_n ; \hOmega^{d+1}_{n,cl}) \xto{\simeq} \left(\left(\Def^{\rm W, cot}_n\right)^{\CC^{2d|d}}\right)^{U(d)} \subset \Def_n^{\rm W} .
\]
Moreover, upon performing Gelfand-Kazhdan descent, it implies that on any complex manifold $X$ we can use $J$ to identify the deformation complex for the holomorphic $\sigma$-model of maps $\CC^d \to X$:
\beqn
J^X : \Omega^{d+1}_{X,cl}[d] \xto{\simeq}  \left(\left(\Def^{\rm cot}_{\CC^d \to X} \right)^{\CC^{2d|d}}\right)^{U(d)} .
\eeqn


\end{document}