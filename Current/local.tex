\def\pAA{\mathring{\AA}}
\def\Map{{\rm Map}}
\def\Sph{{\rm Sph}}
\def\jou{{\mathtt{j}}}

\section{Local aspects of the higher Kac-Moody factorization algebras} 
\label{sec: sphere ops}

A factorization algebra encodes an enormous amount of information, 
and hence it is important to extract aspects that are simpler to understand.
In this section we will take two approaches:
\begin{enumerate}
\item by compactifying along a sphere of real dimension $2d-1$, 
we obtain an algebra (more precisely, a homotopy-coherent associative algebra) that encodes the higher dimensional version of ``radial ordering'' of operators from two-dimensional conformal field theory, and
\item by compactifying along a torus $(S^1)^d$, 
we obtain an algebra over the little $d$-disks operad.
\end{enumerate}
In both cases these algebras behave like enveloping algebras of homotopy-coherent Lie algebras (in a sense we will spell out in detail below), which allows for simpler descriptions of some phenomena. 
It is important to be aware, however, that these algebras do not encode the full algebraic structure produced by the compactification; instead, they sit as dense subalgebras.
We will elaborate on this subtlety below.

For factorization algebras, compactification is accomplished by the pushforward operation.
Given a map $f: X \to Y$ of manifolds and a factorization algebra $\cF$ on $X$,
its {\em pushforward} $f_* \cF$ is the factorization algebra on $Y$ where
\[
f_*\cF(U) = \cF(f^{-1}(U))
\]
for any open $U \subset Y$.
The first example we treat arises from the radial projection map
\[
r: \CC^d \setminus \{0\} \to (0,\infty)
\]
sending $z$ to its length $|z|$. 
The preimage of a point is simply a $2d-1$-sphere,
so one can interpret the pushforward Kac-Moody factorization algebra $r_* \UU_\theta \cG_d$ as compactification along these spheres.
Our first main result is that there is a locally constant factorization algebra $\cA$ along $(0,\infty)$ with a natural map
\[
\phi: \cA \to r_* \UU_\theta \cG_d
\]
that is dense from the point of view of the topological vector space structure.
By a theorem of Lurie, locally constant factorization algebras on $\RR$ correspond to homotopy-coherent associative algebras,
so that we can interpret $\phi$ as saying that the pushforward is approximated by an associative algebra, in this derived sense.
We will show explicitly that this algebra is the $A_\infty$ algebra arising as the enveloping algebra of an $L_\infty$ algebra already introduced by Faonte-Hennion-Kapranov.

For the physically-minded reader, 
this process should be understood as a version of radial ordering.
Recall from the two-dimensional setting that it can be helpful to view the punctured plane as a cylinder,
and to use the radius as a kind of time parameter.
Time ordering of operators is then replaced by radial ordering.
Many computations can be nicely organized in this manner,
because a natural class of operators arises by using a Cauchy integral around the circle of a local operator.
The same technique works in higher dimensions where one now computes residues along the $2d-1$-spheres.
From this perspective, the natural Hilbert space is associated to the origin in the plane
(more accurately to an arbitrarily small disk around the origin),
and this picture also extends to higher dimensions.
Hence we obtain a kind of vacuum module for this higher dimensional generalization of the Kac-Moody algebras.

Our second cluster of results uses compactification along the projection map
\[
\begin{array}{ccc}
\CC^d \setminus \{\text{coordinate hyperplanes}\} & \to & (0,\infty)^d \\
(z_1,\ldots,z_d) & \mapsto & (|z_1|,\ldots,|z_d|).
\end{array}
\]
We construct a locally constant factorization algebra on $(0,\infty)^d$ that maps densely into the pushforward of the higher Kac-Moody algebra. 
Lurie's theorem shows that locally constant factorization algebras on $\RR^d$ correspond to $E_d$ algebras,
so we obtain a higher-dimensional analog of the spherical result.
%The annular algebra $\sA$ that we just discussed in the complex one-dimensional case has a generalization to arbitrary dimensions.The higher dimensional versions of annuli we consider are given by open sets equal to neighborhoods of $(2d-1)$-spheres.
%In this section we describe the higher dimensional version of this annular algebra for the Kac-Moody factorization algebra.
%This amounts to specializing the factorization algebra to the complex manifold $X = \CC^d \setminus \{0\}$ and extracting the data of an $A_\infty$-algebra from the factorization product in the radial direction.
%The reduction of the factorization algebra along $S^{2d-1} \subset \CC^d \setminus \{0\}$ produces a one-dimensional factorization algebra via pushing forward along the radial projection map $\CC^d \setminus \{0\} \to \RR_{>0}$.
%Embedded inside of this factorization algebra is a locally constant factorization algebra, which will define for us our $A_\infty$-algebra.
%Furthermore, we show how the factorization product of disks with higher dimensional annuli provide the structure a ($A_\infty$-)module on the value of the factorization algebra on the disk.

\owen{I want to move this hidden stuff into the next subsections or into the introduction to the paper.}

%We will recognize this $A_\infty$-algebra as the universal enveloping algebra of an $L_\infty$ algebra which is obtained as a central extension of an algebraic version of the sphere algebra
%\beqn\label{mapping space}
%{\rm Map}(S^{2d-1}, \fg) .
%\eeqn
%When $d=1$ there is an embedding $\fg[z,z^{-1}] \hookrightarrow C^\infty(S^1) \tensor \fg = {\rm Map}(S^1, \fg)$, induced by the embedding of algebraic functions on punctured affine line inside of smooth functions on $S^1$. 
%The affine algebras are given by extensions of algebraic loop algebra $\sO^{alg}(\AA^{1\times}) = \fg[z,z^{-1}]$ prescribed by a $2$-cocycle involving the algebraic residue pairing. 
%Note that this cocycle is {\em not} pulled back from any cocycle on $\sO^{alg}(\AA^1) \tensor \fg = \fg[z]$. 
%%Now, consider algebraic functions on the punctured $d$-dimensional affine space $\AA^{d \times}$.
%
%When $d > 1$ Hartog's theorem implies that the space of holomorphic functions on punctured affine space is the same as the space of holomorphic functions on affine space.
%The same holds for algebraic functions, so that $\sO^{alg}(\AA^{d\times}) \tensor \fg = \sO^{alg}(\AA^d) \tensor \fg$. 
%In particular, the naive algebraic replacement $\sO^{alg}(\AA^{d\times}) \tensor \fg$ of (\ref{mapping space}) has no interesting central extensions. 
%However, as opposed to the punctured line, the punctured affine space $\AA^{d \times}$ has interesting higher cohomology. 
%
%The key idea is that we replace the commutative algebra $\sO^{alg}(\AA^{d\times})$ by the derived space of sections $\RR \Gamma(\AA^{d \times}, \sO)$. 
%This complex has interesting cohomology and leads to nontrivial extensions of the dg Lie algebra $\RR \Gamma(\AA^{d \times}, \sO) \tensor \fg$. 
%Concretely, we will use a dg model $A_d$ for $\RR \Gamma(\AA^{d \times}, \sO)$ due to \cite{FHK} that is an algebraic analog of the tangential Dolbeault complex of the $(2d-1)$-sphere inside of the Dolbeault complex of $\CC^d \setminus \{0\}$:
%\[
%\Omega_b^{0,*}(S^{2d-1}) \subset \Omega^{0,*}(\CC^d\setminus \{0\}) .
%\]
%See \cite{DragomirTomassini} for details on the definition of $\Omega_b^{0,*}(S^{2d-1})$. 
%The degree zero part of $\Omega_b^{0,*}(S^{2d-1})$ is $C^\infty(S^{2d-1})$, so we can view $A_d \tensor \fg$ as a derived enhancement of the mapping space in (\ref{mapping space}). 
%
%The model $A_d$, by definition, has cohomology equal to the cohomology of $\RR \Gamma(\AA^{d \times}, \sO)$. 
%In \cite{FHK} they have studied a class of cocycles associated to elements $\theta \in \Sym^{d+1}(\fg^*)^\fg$ that are algebraic analogs of the local cocycles we introduced in the previous section. 
%The cocycle is of total cohomological degree $+2$ and so determines a central extension of $A_d \tensor \fg$ that we denote $\Hat{\fg}_{d,\theta}$. 
%Our first main result is that our ``higher annular algebra" of the Kac-Moody factorization algebra from the discussion above recovers this Lie algebra extension.
%
%\begin{thm}\label{thm sphere alg}
%Let $\sF_{1d}$ be the one-dimensional factorization algebra obtained by the reduction of the Kac-Moody factorization algebra $\UU_\alpha\left(\sG_{\CC^{d} \setminus \{0\}} \right)$ along the sphere $S^{2d-1} \subset \CC^{d} \setminus \{0\}$.
%There is a dense subfactorization algebra $\sF^{lc}_{1d} \subset \sF_{1d}$ that is locally constant. 
%As a one-dimensional locally constant factorization algebra, $\sF^{lc}_{1d}$ is equivalent to the higher affine algebra $U(\Hat{\fg}_{d,\theta})$.
%\end{thm}
%
%%\begin{thm}\label{thm sphere alg} The associative algebra $U(\Hat{\fg}_{d,\theta})$ determines a locally constant factorization algebra on the real one-manifold $\RR$ that we denote $U(\Hat{\fg}_{d,\theta})^{fact}$. 
%%Moreover, there is an injective dense map of factorization algebras on $\RR$:
%%\[
%%\Phi^{S^{2d-1}} : \left(U \Hat{\fg}_{d,\theta} \right)^{fact} \to r_*\left(\sF^{\CC^d \setminus \{0\}}_{\fg,\theta} \right)  .
%%\]
%%where the right-hand side is the push-forward of the Kac-Moody factorization algebra on $\CC^{d}\setminus \{0\}$ along the radial projection map.
%%\end{thm}
%
%In the final part of this section we specialize to the manifold $X = (\CC \setminus \{0\})^d$. 
%Note that when $d=1$ this is the same as the algebra above, but for $d>1$ this factorization algebra has a different flavor. 
%We will show how to extract the data of an $E_d$-algebra from this configuration, and discuss its role in the theory of higher dimensional vertex algebras. 
%
%%In a similar way in Section \ref{sec: ...} we will see how the Kac-Moody factorization algebra on $(\CC \setminus \{0\})^d$ are related to extensions of higher loop Lie algebras
%%\[
%%L^d \fg = L ( \cdots (L \fg) \cdots ) = {\rm Map}(S^{1} \times S^1 , \fg).
%%\]
%
%%\[
%%\cA_{d, \fg,\theta} := \bigoplus_{k \in \ZZ} r_*\left(\sF^{\CC^d}_{\fg,\theta} |_{\CC^d \setminus 0} \right) ^{(k)} \subset r_*\left(\sF^{\CC^d}_{\fg,\theta} |_{\CC^d \setminus 0} \right) .
%%\]
%%\end{thm}
%
%%\begin{dfn} Fix an element $\theta \in \Sym^{d+1}(\fg)^{\fg}$. 
%%Let $\Hat{\fg}_{d,\theta}$ be the $L_\infty$ central extension
%%\[
%%\CC \to \Hat{\fg}_{d,\theta} \to A_d \tensor \fg
%%\]
%%determined by the degree two cocycle $\theta_{\rm FHK} \in \clie^*(A_d \tensor \fg)$ defined by
%%\[
%%\theta_{\rm FHK}(a_0\tensor X_0,\dots,a_d\tensor X_d) = \Reszero \left(a_0 \wedge \d a_1 \wedge \cdots \wedge \d a_d \right) \theta(X_0,\ldots,X_d)
%%\]
%%where $a_i \tensor X_i \in A_d \tensor \fg$. 
%%\end{dfn}

\subsection{Compactifying the higher Kac-Moody algebras along spheres}

Our approach is modeled on the construction of the affine Kac-Moody Lie algebras and their associated vertex algebras from Section 5.5 of~\cite{CG1} and~\cite{OGthesis},
so we review the main ideas to orient the reader.

On the punctured plane $\CC^*$, the sheaf $
\sG_1^{sh} = \Omega^{0,*} \otimes \fg$ is quasi-isomorphic to the sheaf $\cO \otimes \fg$.
The restriction maps of this sheaf tell us that for any open set $U$, there is a map of Lie algebras
\[
\cO(\CC^*) \otimes \fg \to \cO(U) \otimes \fg,
\]
so that we get a map of Lie algebras
\[
\cO_{\rm alg}(\CC^*) \otimes \fg = \fg[z,z^{-1}] \to  \cO(U) \otimes \fg
\]
because Laurent polynomials $\CC[z,z^{-1}] = \cO_{\rm alg}(\CC^*)$ are well-defined on any open subset of the punctured plane.
This {\em loop algebra} $L\fg = \fg[z,z^{-1}]$ admits interesting central extensions,
known as the affine Kac-Moody Lie algebras.
These extensions are labeled by elements of $\Sym^2(\fg^*)^\fg$, 
which is compatible with our work in Section~\ref{sec: g j functional}.

To apply radial ordering to this sheaf---or rather, its associated current algebras---it is convenient to study the pushforward along the radial projection map $r(z) = |z|$.
Note that the preimage of an interval $(a,b)$ is an annulus, so
\[
r_* \sG_1^{sh}((a,b)) = \sG_1^{sh}(\{a < |z| < b\})
\]
and hence we have a canonical map of Lie algebras
\[
\fg[z,z^{-1}] \to \cO(\{a < |z| < b\}) \otimes \fg \hookrightarrow r_* \sG_1^{sh}((a,b)).
\]
We can refine this situation by replacing the left hand side with the locally constant sheaf $\underline{\fg[z,z^{-1}]}$ to produce a map of sheaves $\underline{\fg[z,z^{-1}]} \to  r_* \sG_1^{sh}((a,b))$.
The Poincar\'e lemma tells us that $\Omega^*$ is quasi-isomorphic to the locally constant sheaf $\underline{\CC}$,
and so we can introduce a sheaf
\[
\mathtt{Lg}^{sh} = \Omega^* \otimes \fg[z,z^{-1}]
\]
that is a soft resolution of $\underline{\fg[z,z^{-1}]}$.
There is then a map of sheaves of dg Lie algebras
\beqn
\label{eqn:looptolinearcurrent}
\mathtt{Lg}^{sh} \to r_* \sG_1^{sh}
\eeqn
that sends $\alpha \otimes x\, z^n$ to $[r^*\alpha]_{0,*} \cdot z^n \otimes x$, with $x \in \fg$, $\alpha$ a differential form on $(0,\infty)$, and $[r^*\alpha]_{0,*}$ the $(0,*)$-component of the pulled back form.
This map restricts nicely to compactly support sections $\mathtt{Lg} \to r_* \sG$.
By taking Chevalley-Eilenberg chains on both sides, we obtain a map of factorization algebras
\beqn
\label{eqn:Uoflooptolinearcurrent}
\UU\mathtt{Lg} = \cliels(\mathtt{Lg}) \to \cliels(r_* \sG) = r_*\UU\sG.
\eeqn
The left hand side $\UU\mathtt{Lg}$ encodes the associative algebra $U(L\fg)$, the enveloping algebra of $L\fg$,
as can be seen by direct computation (see section 3.4 of \cite{CG1}) or by a general result of Knudsen~\cite{Knudsen}.
The right hand side contains operators encoded by Cauchy integrals, 
and it is possible to identify such as operator, up to exact terms, as the limit of a sequence of elements from~$U(L\fg)$.

We extend this argument to the affine Kac-Moody Lie algebras by working with suitable extensions on $\mathtt{Lg}$.
It is a deformation-theoretic argument, as we view the extensions as deforming the bracket.

We wish to replace the punctured plane $\CC^*$ by the punctured $d$-dimensional affine space 
\[
\pAA^d = \CC^d \setminus \{0\},
\] 
the current algebras of $\sG_1$ by the current algebras of $\sG_d$,
and, of course, the extensions depending on $\Sym^2(\fg^*)^\fg$ by other local cocycles.
There are two nontrivial steps to this generalization:
\begin{enumerate}
\item finding a suitable replacement for the Laurent polynomials, so that we can recapitulate (without any issues) the construction of the maps \eqref{eqn:looptolinearcurrent} and \eqref{eqn:Uoflooptolinearcurrent}, and
\item deforming this construction to encompass the extensions of $\sG_d$ and hence the twisted enveloping factorization algebras~$\UU_\theta \sG_d$.
\end{enumerate}
We undertake the steps in order.

%We consider the restriction of the factorization algebra $\UU_\theta (\sG)$ on $\CC^{d} \setminus \{0\}$ to the collection of open sets diffeomorphic to spherical shells.
%This restriction has the structure of a one-dimensional factorization algebra corresponding to the iterated nesting of spherical shells. 
%We show that there is a dense subfactorization algebra that is locally constant, hence corresponds to an $E_1$ algebra.
%We conclude by identifying an $A_\infty$ model for this algebra as the universal enveloping algebra of a certain $L_\infty$ algebra, that agree with the higher dimensional affine algebras.

\subsubsection{Derived functions on punctured affine space}

When $d=1$, we note that
\[
\CC[z,z^{-1}] \subset \cO(\CC^*) \xto{\simeq} \Omega^{0,*}(\CC^*),
\]
and so the Laurent polynomials are a dense subalgebra of the Dolbeault complex.
When $d >1$, Hartog's lemma tells us that every holomorphic function on punctured $d$-dimensional space extends through the origin:
\[
\cO(\pAA^d) = \cO(\AA^d).
\]
This result might suggest that $\pAA^d$ is an unnatural place to seek a generalization of the loop algebra,
but such pessimism is misplaced because $\pAA^d$ is not affine 
and so its {\em derived} algebra of functions, 
given by the derived global sections $\RR \Gamma(\pAA^d, \cO)$, 
is more interesting than the underived global sections~$\cO(\pAA^d)$.

Indeed, a straightforward computation in algebraic geometry shows
\[
H^*(\pAA^{d}, \sO_{\rm alg}) = 
\begin{cases} 
0, & * \neq 0, d-1 \\ 
\CC[z_1,\ldots,z_d], & * = 0 \\ \CC[z_1^{-1},\ldots,z_d^{-1}] \frac{1}{z_1 \cdots z_d}, & * = d-1 
\end{cases}.
\]
(For instance, use the cover by the affine opens of the form $\AA^d \setminus \{z_i =0\}$.)
When $d=1$, this computation recovers the Laurent polynomials,
so we should view the cohomology in degree $d-1$ as providing the derived replacement of the polar part of the Laurent polynomials.
A similar result holds in analytic geometry, of course,
so that we have a natural map
\[
\RR \Gamma(\pAA^d, \cO_{\rm alg}) \to \RR \Gamma(\pAA^d, \cO) \simeq \Omega^{0,*}(\pAA^d)
\]
that replaces our inclusion of Laurent polynomials into the Dolbeault complex on~$\pAA^d$.

For explicit constructions, it is convenient to have an explicit dg commutative algebra that models the derived global sections.
It should be no surprise that we like to work with the Dolbeault complex,
but there is also an explicit dg model $A_d$ for the algebraic version derived global sections due to Faonte-Hennion-Kapranov \cite{FHK} and based on the Jouanolou method for resolving singularities. 
In fact, they provide a model for the algebraic $p$-forms as well.

\begin{dfn}
Let $a_d$ denote the algebra  
\[
\CC[z_1,\ldots,z_d, z_1^*,\ldots,z_d^*][(z z^*)^{-1}]
\]
defined by localizing the polynomial algebra with respect to $zz^* = \sum_i z_i z^*_i$.
View this algebra $a_d$ as concentrated in bidegree $(0,0)$, 
and consider the bigraded-commutative algebra $R^{*,*}_d$ over $a_d$ that is freely generated in bidegree $(1,0)$ by elements
\[
\d z_1,\ldots , \d z_d,
\] 
and in bidegree $(0,1)$ by
\[
\d z_1^*,\ldots, \d z_d^*.
\]
We care about the subalgebra $A^{*,*}_d$ where $A^{p,m}_d$ consisting of elements $\omega \in R^{p,m}_d$ such that
\begin{itemize}
\item[(i)] the coefficient of $\d z^*_{i_1} \cdots \d z^*_{i_m}$ has degree $-m$ with respect to the $z_k^*$ variables, and
\item[(ii)] the contraction $\iota_\xi \omega$ with the Euler vector field $\xi = \sum_{i} z_i^* \partial_{z_{i}^*}$ vanishes.
\end{itemize}
This bigraded algebra admits natural differentials in both directions:
\begin{enumerate}
\item define a map $\dbar : A_d^{p,q} \to A_d^{p,q+1}$ of bidegree $(0,1)$~by
\[
\dbar = \sum_i \d z^*_i \frac{\partial}{\partial z_i^*},
\]
\item define a a map of bidegree $(1,0)$~by
\[
\partial = \sum_i \d z_i \frac{\partial}{\partial z_i} .
\]
\end{enumerate}
These differentials commute $\dbar \partial = \partial \dbar$,
and each squares to zero.
\end{dfn}

We denote the subcomplex with $p=0$~by 
\[
(A_d, \dbar) = (\bigoplus_{q = 0}^d A_d^{q}[-q], \dbar),
\] 
and it has the structure of a dg commutative algebra.
For $p>0$, the complex $A^{p,*}_d = (\oplus_q A^{p,q}[-q], \dbar)$ is a dg module for $(A_d, \dbar)$.

From the definition, one can guess that the variables $z_i$ should be understood as the usual holomorphic coordinates on affine space $\CC^d$ and the variables $z^*_i$ should be understood as the antiholomorphic coordinates $\zbar_i$.
The following proposition confirms that guess;
it also summarizes key properties of the dg algebra $A_d$ and its dg modules $A_{d}^{p,*}$,
by aggregating several results of \cite{FHK}.

\begin{prop}[\cite{FHK}, Section 1]
\label{prop: Ad} $\;$
\begin{enumerate}
\item
The dg commutative algebra $(A_d,\dbar)$ is a model for $\RR \Gamma(A^{d\times}, \sO^{alg})$:
\[
A_d \simeq \RR\Gamma(\AA^{d \times}, \sO^{alg}) .
\]
Similarly, $(A_d^{p,*},\dbar) \simeq \RR \Gamma(\AA^{d\times}, \Omega^{p,alg})$.
\item There is a dense map of commutative bigraded algebras
\[
\jou : A^{*,*}_d \to \Omega^{*,*}(\CC^d \setminus \{0\}) 
\]
sending $z_i$ to $z_i$, $z_i^*$ to $\Bar{z}_i$, and $\d z_i^*$ to $\d \zbar_i$, and the map intertwines with the $\dbar$ and $\partial$ differentials on both sides.
\item There is a unique $\GL_n$-equivariant residue map
\[
{\rm Res}_{z=0} : A_d^{d,d-1} \to \CC
\]
that satisfies
\[
\Res_{z=0} \left(f(z) \omega_{BM}^{alg}(z,z^*) \d z_1 \cdots \d z_d\right) = f(0)
\]
for any $f (z) \in \CC[z_1,\ldots,z_d]$. 
In particular, for any $\omega \in A^{d,d-1}_d$,
\[
{\rm Res}_{z=0} (\omega) = \oint_{S^{2d-1}} \jou(\omega)
\]
where $S^{2d-1}$ is any sphere centered at the origin in $\CC^d$. 
\end{enumerate}
\end{prop}

It is a straightforward to verify that the formula for the Bochner-Martinelli kernel makes sense in the algebra $A_d$.
That is, we define
\[
\omega_{BM}^{alg} (z,z^*) = \frac{(d-1)!}{(2 \pi i)^d} \frac{1}{(zz^*)^d} \sum_{i=1}^d (-1)^{i-1} z_i^* \d z_1^* \wedge \cdots \wedge \Hat{\d z_i^*} \wedge \cdots \wedge \d z_d^*,
\]
which is an element of~$A_d^{0,d-1}$. 

\subsubsection{The sphere algebra of $\fg$}

The loop algebra $L\fg = \fg[z,z^{-1}]$ arises as an algebraic model of the mapping space $\Map(S^1,\fg)$,
which obtains a natural Lie algebra structure from the target space~$\fg$.
For a topologist, a natural generalization is to replace the circle $S^1$, which is equal to the unit vectors in $\CC$, by the sphere $S^{2d-1}$, which is equal to the unit vectors in $\CC^d$.
That is, consider the ``sphere algebra'' of $\Map(S^{2d-1},\fg)$.
An algebro-geometric sphere replacement of this sphere is the punctured affine $d$-space $\pAA^{d}$ or a punctured formal $d$-disk,
and so we introduce an algebraic model for the sphere algebra.

\begin{dfn}
For a Lie algebra $\fg$, the {\em sphere algebra} in complex dimension $d$ is the dg Lie algebra~$A_d \otimes \fg$.
\owen{Notation for this? ${\Sph}_d(\fg)$? $\SS^d \fg$? I think FHK use $\fg_d$.}
\end{dfn}

There are natural central extensions of this sphere algebra as {em $L_\infty$ algebras},
in parallel with our discussion of extensions of the local Lie algebras.
For any $\theta \in \Sym^{d+1}(\fg^*)^\fg$, Faonte-Hennion-Kapranov define the cocycle
\[
\label{fhk cocycle}
\begin{array}{cccc}
\theta_{FHK} : & (A_d \tensor \fg)^{\tensor (d+1)} & \to & \CC\\ 
& a_0 \otimes \cdots \otimes a_d & \mapsto & \Res_{z=0} \theta(a_0,\partial a_1,\ldots,\partial a_d)
\end{array}.
\]
\owen{I changed $\d$ (for de Rham) with $\partial$, since I think that's clearer. Tell me what you think.}
This cocycle has cohomological degree $2$ and so determines an unshifted central extension as $L_\infty$ algebras of~$A_d \tensor \fg$:
\beqn\label{gdt}
\CC \cdot K \to \Hat{\fg}_{d, \theta} \to A_d \tensor \fg .
\eeqn
\owen{Let's make sure we're consistent (or at least mention) the FHK notation for this.}
Our aim is now to show how the Kac-Moody factorization algebra $\UU_\theta \sG_d$ is related to this $L_\infty$ algebra,
which is a higher-dimensional version of the affine Kac-Moody Lie algebras. 

%\subsubsection{}
%
%Introduce the radial projection map
%\[
%r : \CC^d \setminus 0 \to \RR_{>0}
%\]
%sending $z = (z_1, \ldots, z_d)$ to $|z| = \sqrt{|z_1|^2 + \cdots + |z_d|^2}$. 
%We will restrict our factorization algebra to spherical shells by pushing forward the factorization algebra along this map.
%Indeed, the preimage of an open interval is such a spherical shell, and the factorization product on the line is equivalent to the nesting of shells. 

\subsubsection{The case of zero level}

Here we will consider the higher Kac-Moody factorization algebra on $\CC^d \setminus \{0\}$ ``at level zero," namely the factorization algebra $\UU(\sG_{\CC^d \setminus\{0\}})$.
In this section we will omit $\CC^d \setminus \{0\}$ from the notation, and simply refer to the factorization algebra by $\UU(\sG)$. 
Our construction will follow the model case outlined in the introduction to this section.
Recall that $r: \pAA^d \to (0,\infty)$ is the radial projection map that sends $(z_1,\ldots,z_d)$ to its length $\sqrt{z_1\zbar_1 + \cdots z_d \zbar_d}$.

\begin{lem}
There is a map of sheaves of dg commutative algebras on~$\RR_{>0}$
\[
\pi: \Omega^* \to r_* \Omega^{0,*}
\]
sending a form $\alpha$ to the $(0,*)$-component of its pullback $r^*\alpha$.
\end{lem}

This result is straightforward since the pullback $r^*$ denotes a map of dg algebras to $r_* \Omega^{*,*}$ and we are simply postcomposing with the canonical quotient map of dg algebras $\Omega^{*,*} \to \Omega^{0,*}$. 

We also have a map of dg commutative algebras $A_d \to \Omega^{0,*}(U)$ for any open set $U \subset \pAA^d$,
by postcomposing the map $\jou$ of proposition~\ref{prop: Ad} with the restriction map.
We abusively denote the composite by $\jou$ as well.
Thus we obtain a natural map of dg commutative algebras
\[
\pi_A: \Omega^* \otimes A_d \to r_* \Omega^{0,*}
\]
sending $\alpha \otimes \omega$ to $\pi(\alpha) \wedge \jou(\omega)$.
By tensoring with $\fg$, we obtain the following.

\begin{cor}
There is a map of sheaves of dg Lie algebras on~$\RR_{>0}$
\[
\pi_{\Sph_d(\fg)}: \Omega^* \otimes \Sph_d(\fg) \to r_* (\Omega^{0,*}\otimes \fg) = r_*(\sG^{sh})
\]
sending $\alpha \otimes x$ to $\pi(\alpha) \otimes x$.
\end{cor}

Note that $\Omega^* \otimes \Sph_d(\fg) = \Omega^* \otimes A_d \otimes \fg$, so $\pi_{\Sph_d(\fg)}$ is simply $\pi_A \otimes \id_\fg$.

This map preserves support and hence restricts to compactly-supported sections.
In other words, we have a map between the associated cosheaves of complexes (and precosheaves of dg Lie algebras).
In summary, we have shown our key result.
%
%Let $r_* \left(\UU \sG \right)$ be the factorization algebra on $\RR_{>0}$ obtained by pushing forward along the radial projection map. Explicitly, to an open set $I \subset \RR_{>0}$ this factorization algebra assigns the dg vector space
%\[
%{\rm C}^{\rm Lie}_*\left(\Omega_c^{0,*}(r^{-1}(I)) \tensor \fg)\right) .
%\]
%
%%We will need a different model for this factorization algebra.
%%Let $\Omega^{*}_{\RR_{>0}}$ be the sheaf of differential forms on the positive real line.
%%We can define the sheaf of dg Lie algebras $\Omega^*_{\RR_{>0}} \tensor (A_d \tensor \fg)$.
%%It's universal enveloping factorization algebra $U^{fact}\left(\Omega^{*}_{>0} \tensor (A_d \tensor \fg)\right)$ is a factorization algebra on $\RR_{>0}$. 
%%A slight variant of Proposition 3.4.0.1 in \cite{CG1}, which shows that there is a quasi-isomorphism of factorization algebras
%%\[
%%U^{fact}\left(\Omega^{*}_{>0} \tensor (A_d \tensor \fg)\right)
%%\]
%
%\def\pr{\rm pr}
%
%Let $I \subset \RR_{>0}$ be an open subset. There is the natural map $r^* : \Omega^*_c(I) \to \Omega^*_c(r^{-1}(I))$ given by the pull back of differential forms. We can post compose this with the natural projection ${\rm pr}_{\Omega^{0,*}} : \Omega^*_c \to \Omega^{0,*}_c$ to obtain a map of commutative algebras ${\rm pr}_{\Omega^{0,*}} \circ r^* : \Omega^*_c(I) \to \Omega^{0,*}_c(r^{-1}(I))$. 
%The map $j$ from Proposition \ref{prop: Ad} determines a map of dg commutative algebras $j : A_d \to \Omega^{0,*}(r^{-1}(I))$. 
%Thus, we obtain a map
%\beqn\label{phi map}
%\begin{array}{cccc}
%\Phi(I) = ({\rm pr}_{\Omega^{0,*}} \circ r^*) \tensor j : & \Omega^*_c(I) \tensor A_d & \to & \Omega^{0,*}_c\left((r^{-1}(I)\right) \\
%& \varphi \tensor a & \mapsto & \left(({\rm pr}_{\Omega^{0,*}} \circ r^*) \varphi\right) \wedge j(a) 
%\end{array}
%\eeqn
%Since this is a map of commutative dg algebras it defines a map of dg Lie algebras
%\[
%\Phi(I) \tensor \id_{\fg} :  (\Omega^*_c(I) \tensor A_d) \tensor \fg = \Omega^*_c(I) \tensor (A_d \tensor \fg) \to \Omega^{0,*}(r^{-1}(I)) \tensor \fg 
%\]
%which maps $(\varphi \tensor a) \tensor X \mapsto \Phi(\varphi \tensor a) \tensor X$. 
%We will drop the $\id_{\fg}$ from the notation and will denote this map simply by $\Phi (I)$. Note that
%$\Phi(I)$ is compatible with inclusions of open sets, hence extends to a map of cosheaves of dg Lie algebras that we will call $\Phi$.  
%

\begin{prop}
\label{prop: fact lie}
The map
\[
 \pi_{\Sph_d(\fg)}: \Omega^*_{\RR_{>0},c} \otimes \Sph_d(\fg) \to r_*\sG 
\] 
is a map of precosheaves of dg Lie algebras.
It determines a map of factorization algebras
\[
\cliels(\pi_{\Sph_d(\fg)}) : \UU\left(\Omega^{*}_{\RR_{>0}} \tensor \Sph_d(\fg)\right) \to r_*\left(\UU \sG \right) .
\]
\end{prop}

The map of factorization algebras follows from applying the functor $\clieu_*(-)$ to the map $\pi_{\Sph_d(\fg)}$;
this construction commutes with push-forward by inspection. 

\subsubsection{The case of non-zero level}

Pick a $\theta \in \Sym^{d+1}(\fg^*)^\fg$. 
This choice determines a higher Kac-Moody factorization algebra $\UU_\theta \sG_d$,
and we would like to produce maps akin to those of Proposition~\ref{prop: fact lie}.

The simplest modification of the level zero situation is to introduce a central extension of the precosheaf
\[
\mathtt{G}_d = \Omega^*_{\RR_{>0},c} \otimes \Sph_d(\fg)
\] 
as a precosheaf of $L_\infty$ algebras on $\RR_{>0}$,
with the condition that this extension intertwines with the extension $r_*\sG_{d,\fj(\theta)}$ of~$r_* \sG_{d}$.
In other words, we need a map 
\[
\xymatrix{
0 \ar[r] & \CC \cdot K [-1]  \ar[d]^{=} \ar[r] & \mathtt{G}_{d,\Theta'} \ar[d]^{\Hat{\pi}} \ar[r] & \mathtt{G}_d \ar[d]^{\pi_{\Sph_d(\fg)}} \ar[r] & 0 \\
0 \ar[r] & \CC \cdot K [-1] \ar[r] & r_*\sG_{d,\fj(\theta)} \ar[r] & r_* \sG_{d} \ar[r] & 0 .
}
\]
of central extensions of $L_\infty$ algebras.
This condition fixes the problem completely, 
because we simply pull back the extension defining $r_*\sG_{d,\fj(\theta)}$.
Let us extract an explicit description,
which will be useful later.
On an open $U \subset \RR_{>0}$, the extension for $r_*\sG_{d,\fj(\theta)}$ is given by an integral
\[
\int_{r^{-1}(U)} \theta(\alpha_0,\partial \alpha_1,\ldots,\partial \alpha_d) = \int_U \int_{S^{2d-1}} \theta(\alpha_0,\partial \alpha_1,\ldots,\partial \alpha_d)
\]
that can be factored into a double integral. 
This formula indicates that $\Theta'$ must be given by the cocycle whose value on elements $\phi_i \otimes a_i \in \Omega^*_c \otimes \Sph_d(\fg)$~is
\begin{align*}
\Theta'(\phi_0 \otimes a_0, \ldots, \phi_d \otimes a_d)
&= \int_U \int_{S^{2d-1}} \theta(\pi(\phi_0) \wedge \jou(a_0),\partial (\pi(\phi_1) \wedge \jou(a_1)),\ldots,\partial(\pi(\phi_d) \wedge \jou(a_d))) \\
%&= \theta_{FHK}(a_0,\ldots,a_d) \int_U \phi_1 \wedge \cdots \wedge \phi_d.
\end{align*}
We thus obtain the following result.

\begin{lem} 
For $\theta \in \Sym^{d+1}(\fg^*)^\fg$,
let $\mathtt{G}_{d,\theta}$ denote the precosheaf of $L_\infty$ algebras obtained by extending $\mathtt{G}_d$ by the cocycle
\[
(\phi_0 \otimes a_0, \ldots, \phi_d \otimes a_d) \mapsto \int_U \int_{S^{2d-1}} \theta(\pi(\phi_0) \wedge \jou(a_0),\partial (\pi(\phi_1) \wedge \jou(a_1)),\ldots,\partial(\pi(\phi_d) \wedge \jou(a_d))).
\]
By construction, there is a canonical map 
\[
\pi_{\Sph_d(\fg),\theta}: \mathtt{G}_{d,\theta} \to r_* \sG_{d,\fj(\theta)}
\]
of precosheaves of $L_\infty$ algebras on $\RR_{>0}$, 
and hence there is a map of factorization algebras
\[
\UU(\pi_{\Sph_d(\fg),\theta}): \UU_{\theta} \mathtt{G}_d \to r_* \UU_\theta \sG_d.
\]
\end{lem}

%\begin{proof}
%Modulo the central element $\Phi_2$ reduces to the map $\Phi$, which we have already seen is a map of factorization Lie algebras in Proposition \ref{prop: fact lie}. Thus, to show that $\Phi_2$ is a map of factorization Lie algebras we need to show that it is compatible with the cocycles determing the respective central extensions. That is, we need to show that 
%\beqn\label{1vs2}
%\theta_1'(\varphi_0 a_0 X_0,\ldots,\varphi_d a_d X_d) = \theta_2(\Phi(\varphi_0 a_0X_0),\ldots,\Phi(\varphi_da_dX_d))
%\eeqn
%for all $\varphi_i a_i X_i \in \Omega^*_{c}(I) \tensor (A_d \tensor \fg)$. The cocycle $\theta_1'$ is only nonzero if one of the $\varphi_i$ inputs is a $1$-form. We evaluate the left-hand side on the $(d+1)$-tuple $(\varphi_0 \d r a_0X_0,\varphi_1 a_1 X_1,\ldots,\varphi_da_dX_d)$ where $\varphi_i \in C^\infty_c(I)$, $a_i \in A_d$, $X_i \in \fg$ for $i=0,\ldots,d$. The result is
%\beqnarray
%& &\label{calc1a} \left(\int_I \varphi_0 \cdots \varphi_d \d r\right) \left(\oint a_0 \partial a_1 \cdots \partial a_d\right) \theta(X_0,\ldots,X_d) \\
%& + & \label{calc1b} \frac{1}{2} \sum_{i=1}^{d} \left( \int_I \varphi_0 (E \cdot \varphi_i) \varphi_1\cdots \Hat{\varphi_i} \cdots \varphi_{d}\d r\right)\left(\oint \left(a_0 a_i \d \vartheta\right) \partial a_1 \cdots \Hat{\partial a_i} \cdots \partial a_d \right) \theta(X_0,\ldots,X_d)
%\eeqnarray
%We wish to compare this to the right-hand side of Equation (\ref{1vs2}). Recall that $\Phi(\varphi_0 \d r a_0 X_0) = \varphi(r) \d r a_0(z) X_0$ and $\Phi(\varphi_i a_i X_i) = \varphi(r) a_i(z) X_i$. Plugging this into the explicit formula for the cocycle $\theta_2$ we see the right-hand side of (\ref{1vs2}) is 
%\beqn\label{calc2}
%\left(\int_{r^{-1}(I)} \varphi_0(r) \d r a_0(z) \partial(\varphi_1(r) a_1(z)) \cdots \partial(\varphi_d(r) a_d(z))\right) \theta(X_0,\ldots,X_d) .
%\eeqn
%
%We pick out the term in (\ref{calc2}) in which the $\partial$ operators only act on the elements $a_i(z)$, $i=1,\ldots, d$. This term is of the form
%\[
%\int_{r^{-1}(I)} \varphi_0(r) \cdots \varphi_d(r) \d r a_0(z) \partial(a_1(z)) \cdots \partial(a_d(z)) \theta(X_0,\ldots,X_d).
%\] 
%Separating variables we find that this is precisely the first term (\ref{calc1a}) in the expansion of the left-hand side of (\ref{1vs2}). 
%
%Now, note that we can rewrite the $\partial$-operator in terms of the radius $r$ as
%\begin{align*}
%\partial = \sum_{i=1}^d \d z_i \frac{\partial}{\partial z_i} = \sum_{i=1}^d \d z_i \zbar_i \frac{\partial}{\partial (r^2)} = \sum_{i=1}^d \d z_i \frac{r^2}{2 z_i} \frac{\partial}{\partial r} .
%\end{align*}
%
%The remaining terms in (\ref{calc2}) correspond to the expansion of
%\[
%\partial(\varphi_1(r) a_1(z)) \cdots \partial(\varphi_d(r) a_d(z)),
%\]
%using the Leibniz rule, for which the $\partial$ operators act on at least one of the functions $\varphi_1,\ldots,\varphi_d$. In fact, only terms in which $\partial$ acts on precisely one of the functions $\varphi_1,\ldots, \varphi_d$ will be nonzero. For instance, consider the term
%\beqn\label{term1}
%(\partial \varphi_1) a_1(z) (\partial \varphi_2) a_2(z) \partial(\varphi_3(z) a_3(z)) \cdots \partial(\varphi_d(z) a_d(z)).
%\eeqn
%Now, $\partial \varphi_i(r) = \omega \frac{\partial \varphi}{\partial r}$ where $\omega$ is the one-form $\sum_i (r^2 / 2 z_i) \d z_i$. Thus, (\ref{term1}) is equal to
%\[
%\left(\omega \frac{\partial \varphi_1}{\partial r} \right) a_1(z) \left(\omega \frac{\partial \varphi_2}{\partial r}  \right) a_2(z) \partial(\varphi_3(z) a_3(z)) \cdots \partial(\varphi_d(z) a_d(z),
%\]
%which is clearly zero as $\omega$ appears twice.
%
%We observe that terms in the expansion of (\ref{calc2}) for which $\partial$ acts on precisely one of the functions $\varphi_1,\ldots,\varphi_d$ can be written as
%\[
%\sum_{i=1}^d \int_{r^{-1}(I)} \varphi_0(r)\left(r \frac{\partial}{\partial r} \varphi_i(r)\right) \varphi_1(r) \cdots \Hat{\varphi_i(r)} \cdots \varphi_d(r) \d r \frac{r}{2 z_i} \d z_i a_0(z) a_i(z) \partial a_1(z) \cdots \Hat{\partial a_i(z)} \cdots \partial a_d(z) .
%\] 
%Finally, notice that the function $z_i / 2r$ is independent of the radius $r$. Thus, separating variables we find the integral can be written as
%\[
%\frac{1}{2} \sum_{i=1}^d \left(\int_{I} \varphi_0 \left(r \frac{\partial}{\partial r} \varphi_i \right) \varphi_1 \cdots \Hat{\varphi_i } \cdots \varphi_d \d r\right) \left(\oint \frac{\d z_i}{z_i} a_0 a_i \partial a_2 \cdots \Hat{\partial a_i} \cdots \partial a_d \right) .
%\]
%This is precisely equal to the second term (\ref{calc1b}) above. Hence, the cocycles are compatible and the proof is complete. 
%\end{proof}

\subsection{A comparison with the work of Faonte-Hennion-Kapranov}

\owen{We just do something very quick here, and prepare the way for later discussions.}

We wish to produce a map 
\[
\pi_\theta: \Omega^*_{\RR_{>0},c} \otimes \widehat{\fg}_{d,\theta} \to r_* \sG_\theta
\]
of precosheaves of $L_\infty$ algebras on $\RR_{>0}$,
generalizing the map $\pi_{\Sph_d(\fg)}$ of Proposition~\ref{prop: fact lie}.
Specializing the parameter $K$ to zero, we should recover that map.
By applying $\clieu_*(-)$ to $\pi_\theta$, we will obtain the desired map of factorization algebras. 

We now proceed to the proof of Theorem \label{thm sphere alg}. 
The dg Lie algebra $\fg_{d,\theta}$ determines a dg associative algebra via its universal enveloping algebra $U(\fg_{d,\theta})$.
This dg algebra determines a factorization algebra on the one-manifold $\RR_{>0}$ that assigns to every open interval $I \subset \RR_{>0}$ the dg vector space $U(A_d \tensor \fg)$. 
The factorization product is uniquely determined by the algebra structure. 
Henceforth, we denote this factorization algebra by $U(\fg_{d,\theta})^{fact}$.

To prove the theorem we will construct a sequence of maps of factorization Lie algebras on $\RR_{>0}$:
\[
\xymatrix{
& \sG_1 \ar[dr]^-{\Phi_1} & & \sG_2 \\
\sG_0 \ar[ur]^-{\simeq}_{\Phi_0} & & \sG_1' \ar[ur]_{\Phi_2} & .
}
\]
The enveloping factorization of $\sG_0$ is equivalent to the factorization algebra $U (\Hat{\fg}_{d,\theta})^{fact}$. 
Moreover, the enveloping factorization of $\sG_2$ is the push-forward of of the higher Kac-Moody factorization algebra $r_* \UU \sG$. 
Hence, the desired map of factorization algebras is produced by applying the enveloping factorization functor to the above composition of factorization Lie algebras. 

First, we introduce the factorization Lie algebra $\sG_0$. 
To an open set $I \subset \RR$, it assigns the dg Lie algebra $\sG_0(I) = \Omega^*_{c}(I) \tensor \Hat{\fg}_{d,\theta}$, where $\Hat{\fg}_{d,\theta}$ is the central extension from Equation (\ref{gdt}). The differential and Lie bracket are determined by the fact that we are tensoring a commutative dg algebra with a dg Lie algebra. A slight variant of Proposition 3.4.0.1 in \cite{CG1}, which shows that the one-dimensional enveloping factorization of an ordinary Lie algebra produces its ordinary universal enveloping algebra, shows that there is a quasi-isomorphism of factorization algebras on $\RR$,
\[
(U \Hat{\fg}_{d,\theta})^{fact} \xrightarrow{\simeq} {\rm C}^{\rm Lie}_*(\sG_0) .
\]
The factorization Lie algebra $\sG_0$ is a central extension of the factorization Lie algebra $\Omega^*_{\RR,c} \tensor (A_d \tensor \fg)$ by the trivial module $\Omega^*_c \oplus \CC \cdot K$. Indeed, the cocycle determining the central extension is given by
\[
\theta_0 (\varphi_0 \alpha_0,\ldots,\varphi_d \alpha_d) = (\varphi_0 \wedge \cdots \wedge \varphi_d) \theta_{A_d}(\alpha_1,\ldots,\alpha_d) .
\] 
The factorization Lie algebra $\Omega^*_{\RR,c} \tensor (A_d \tensor \fg)$ is the compactly supported sections of the local Lie algebra $\Omega^*_{\RR} \tensor (A_d \tensor \fg)$ and this cocycle determining the extension is a local cocycle. 

Next, we define the factorization dg Lie algebra $\sG_1$ on $\RR$. This is also obtained as a central extension of the factorization Lie algebra $\Omega^{*}_{\RR,c} \tensor (A_d \tensor \fg)$: 
\[
0 \to \CC \cdot K [-1] \to \sG_1 \to \Omega^{*}_{\RR,c} \tensor (A_d \tensor \fg) \to 0
\]
determined by the following cocycle. For an open interval $I$ write $\varphi_i \in \Omega^*_c(I)$, $\alpha_i\in A_d \tensor \fg$. The cocycle is defined by
\beqn\label{cocycle 1}
\theta_1 (\varphi_0 \alpha_0, \ldots, \varphi_d \alpha_d) =  \left(\int_{I} \varphi_0 \wedge \cdots \varphi_d \right) \theta_{\rm FHK} (\alpha_0,\ldots,\alpha_d)
\eeqn
where $\theta_{\rm FHK}$ was defined in Equation \ref{fhk cocycle}.

The functional $\theta_1$ determines a local cocycle in $\cloc^*\left(\Omega^*_\RR \tensor (A_d \tensor \fg)\right)$ of degree one. 

\def\dR{{\rm dR}}

We now define a map of factorization Lie algebras $\Phi_0 : \sG_0 \to \sG_1$. On and open set $I \subset \RR$, we define the map $\Phi_0(I) : \sG_0(I) \to \sG_1(I)$ by
\[
\Phi_0(I)(\varphi \alpha, \psi K) = \left(\varphi \alpha, \int \psi \cdot K\right) .
\]
For a fixed open set $I \subset \RR$, the map $\Phi_0$ fits into the commutative diagram of short exact sequences
\[
\xymatrix{
0 \ar[r] & \Omega^*_c(I) \tensor \CC \cdot K  \ar[d]^-{\int}_-{\simeq} \ar[r] & \sG_0(I) \ar[d]^-{\Phi_0(I)} \ar[r] & \Omega^*_c(I) \tensor (A_d \tensor \fg) \ar@{=}[d] \ar[r] & 0 \\
0 \ar[r] & \CC \cdot K [-1] \ar[r] & \sG_1(I) \ar[r] & \Omega^*_c(I) \tensor (A_d \tensor \fg) \ar[r] & 0 .
}
\]
To see that $\Phi_0(I)$ is a map of dg Lie algebras we simply observe that the cocycles determining the central extensions are related by $\theta_1 = \int \circ \; \theta_0$, where $\int : \Omega^*_c(I) \to \CC$ as in the diagram above. Since $\int$ is a quasi-isomorphism, the map $\Phi_0(I)$ is as well. It is clear that as we vary the interval $I$ we obtain a quasi-isomorphism of factorization Lie algebras $\Phi_0 : \sG_0 \xto{\simeq} \sG_1$. 

%To verify that this is a map of factorization Lie algebras, it suffices to show that for each $I \subset \RR$, $\Phi_1$ determines a map of cocommutative coalgebras 
%\[
%\Phi_1 : {\rm C}^{\rm Lie}_*\left(\Omega^*_c(I) \tensor \Hat{\fg}_{d,\theta}\right) \to {\rm C}^{\rm Lie}_*(\sG_1(I)) .
%\] 
%Clearly, modulo the central element $K$ the Lie brackets are identical. Thus, we need to show that the cocycles determining the central extensions are compatible. Fix $I \subset \RR$ and suppose $\varphi_0,\ldots, \varphi_d \in \Omega^*_c(I)$, $\alpha_0,\ldots,\alpha_d \in A_d \tensor \fg$. Then, the cocycle in $\Omega^*_c(I) \tensor \Hat{\fg}_{d,\theta}$ is given by

We now define the factorization dg Lie algebra $\sG_1'$. Like $\sG_0$ and $\sG_0$, it is a central extension of $\Omega^*_{\RR,c} \tensor (A_d \tensor \fg)$. The cocycle determining the central extension is defined by
\[
\theta_1' (\varphi_0 a_0 X_0, \ldots, \ldots, \varphi_d a_dX_d) = \theta_1(\varphi_0 a_0 X_0, \ldots, \ldots, \varphi_d a_dX_d) + \Tilde{\theta}_1(\varphi_0 a_0 X_0, \ldots, \ldots, \varphi_d a_dX_d) 
\]
where $\theta_1$ was defined in Equation (\ref{cocycle 1}). Before writing down the explicit formula for $\Tilde{\theta}_1$ we introduce some notation. Set
\begin{align*}
E & = r \frac{\partial}{\partial r} , \\
\d \vartheta & = \sum_i \frac{\d z_i}{z_i} .
\end{align*} 
We view $E$ as a vector field on $\RR_{>0}$ and $\d \vartheta$ as a $(1,0)$-form on $\CC^{d} \setminus 0$. Define the functional
\[
\Tilde{\theta}_1(\varphi_0 a_0 X_0,\ldots,\varphi_d a_d X_d) = \frac{1}{2} \sum_{i=1}^{d} \left( \int_I \varphi_0 (E \cdot \varphi_i) \varphi_1\cdots \Hat{\varphi_i} \cdots \varphi_{d}\right)\left(\oint \left(a_0 a_i \d \vartheta\right) \partial a_1 \cdots \Hat{\partial a_i} \cdots \partial a_d \right) \theta(X_0,\ldots,X_d)  .
\]
The functional $\Tilde{\theta}$ defines a local functional in $\cloc^*\left(\Omega^*_{\RR_{>0}} \tensor (A_d \tensor \fg) \right)$ of cohomological degree one. One immediately checks that it is a cocycle. This completes the definition of the factorization Lie algebra $\sG_1'$. 

The factorization Lie algebras $\sG_1$ and $\sG_1'$ are identical as precosheaves of vector spaces. In fact, if we put a filtration on $\sG_1$ and $\sG_1'$ where the central element $K$ has filtration degree one, then the associated graded factorization Lie algebras ${\rm Gr} \; \sG_1$ and ${\rm Gr} \; \sG_1'$ are also identified. The only difference in the Lie algebra structures comes from the deformation of the cocycle determining the extension of $\sG_1'$ given by $\Tilde{\theta}_1$. 

In fact, we will show that $\Tilde{\theta}_1$ is actually an exact cocycle via the cobounding element $\eta \in \cloc^*\left(\Omega^*_{\RR_{>0}} \tensor (A_d \tensor \fg)\right)$ defined by
\[
\eta(\varphi_0a_0X_0,\ldots,\varphi_da_dX_d) = \sum_{i=1}^d \left(\int_I \varphi_0 \left(\iota_{E} \varphi_i \right) \varphi_1 \cdots \Hat{\varphi_i} \cdots \varphi_d\right)\left(\oint \left(a_0 a_i \d \vartheta\right) \partial a_1 \cdots \Hat{\partial a_i} \cdots \partial a_d \right) \theta(X_0,\ldots,X_d)  .
\]

\begin{lem} One has $\d \eta = \Tilde{\theta}_1$, where $\d$ is the differential for the cochain complex $\cloc^*(\Omega^*_{\RR_{>0}} \tensor (A_d \tensor \fg))$. In particular, the factorization Lie algebras $\sG_1$ and $\sG_1'$ are quasi-isomorphic (as $L_\infty$ algebras). An explicit quasi-isomorphism is given by the $L_\infty$ map $\Phi_1 : \sG_1 \to \sG_1'$ that sends the central element $K$ to itself and an element $(\varphi_0 a_0 X_0,\ldots, \varphi_d a_d X_d) \in \Sym^{d+1}(\Omega^*_c \tensor (A_d \tensor \fg)$ to 
\[
(\varphi_0 a_0 X_0,\ldots, \varphi_d a_d X_d) + \eta(\varphi_0 a_0 X_0,\ldots, \varphi_d a_d X_d)\cdot K \in \Sym^{d+1}(\Omega^*_c \tensor (A_d \tensor \fg)) \oplus \CC \cdot K .
\]
\end{lem}


\subsection{An $E_d$ algebra by compactifying along tori} 

There is another direction that one may look to extend the notion of affine algebras to higher dimensions.
The affine algebra is a central extension of the loop algebra on $\fg$. 
Instead of looking at higher dimensional sphere algebras, one can consider higher {\em torus} algebras; or iterated loop algebras:
\[
L^d \fg = \CC[z_1^{\pm}, \cdots, z_d^{\pm}] \tensor \fg .
\]
These iterated loop algebras are algebraic versions of the torus mapping space ${\rm Map}(S^1 \times \cdots \times S^1, \fg)$. 
In this section we show what information the Kac-Moody vertex algebra implies about extensions of such iterated loop algebras.

To do this we specialize the Kac-Moody factorization algebra to the complex manifold $(\CC^\times)^d$, which is homotopy equivalent to the topologists torus $(S^1)^{\times d}$.  
We show, in a similar way as above, how to extract the structure of an $E_d$ algebra from considering the nesting of ``polyannuli" in $(\CC^\times)^d$.
These $E_d$-algebras are related to interesting extensions of the Lie algebra $L^d \fg$.

When $d=1$, we have seen that the nesting of ordinary annuli give rise to the structure of an associative algebra. For $d > 1$, a polyannulus is a complex submanifold of the form ${\rm Ann}_1 \times \cdots \times {\rm Ann}_d \subset (\CC^\times)^d$ where each ${\rm Ann}_i \subset \CC^\times$ is an ordinary annulus. Equivalently, a polyannulus is the complement of a closed polydisk inside of a larger open polydisk. We will see how the nesting of annuli in each component gives rise to the structure of a locally constant factorization algebra in $d$ {\em real} dimensions, and hence defines an $E_d$ algebra. 

A result of Knudsen \cite{KnudsenEn}, which we recall below, states that every dg Lie algebra determines an $E_d$-algebra, for any $d>1$, called the universal $E_d$ enveloping algebra.
To state the result precisely we need to be in the context of $\infty$-categories.

\begin{thm}[\cite{KnudsenEn}] Let $\sC$ be a stable, $\CC$-linear, presentable, symmetric monoidal $\infty$-category.
There is an adjunction
\[
U^{E^d} : {\rm LieAlg}(\sC) \leftrightarrows E_d{\rm Alg} (\sC): F
\]
such that for any object $X \in \sC$ one has ${\rm Free}_{E_d}(X) \simeq U^{E_d} {\rm Free}_{Lie}(\Sigma^{d-1} X)$. 
\end{thm}

We are most interested in the case $\sC$ is the category of chain complexes with tensor product $\Ch^{\tensor}$. 
In this situation, the enveloping algebra $U^{E^d}$ agrees with the ordinary universal enveloping algebra when $d=1$.

When the twisting cocycle defining the Kac-Moody factorization algebra is zero we will see that the $E_d$ algebra coming from the product of polyannuli is equivalent to $U^{E_d} (L^d \fg)$.
When we turn on a twisting cocycle we will find the $E_d$-enveloping algebra of a central extension of the iterated loop algebra. 

The Kac-Moody factorization algebra on the $d$-fold $(\CC^\times)^d$ determines a real $d$-dimensional factorization algebra by considering the radius in each complex direction. 
This factorization algebra on $(\RR_{>0})^d$ is defined by the pushforward $\vec{r}_*\left(\sG_{\CC^{\times d}}\right)$, 
where $\vec{r} : (\CC^\times)^d \to (\RR_{>0})^d$ is the projection $(z_1,\ldots,z_d) \mapsto (|z_1|, \cdots, |z_d|)$. 

On the Lie algebra side, it is an immediate calculation to see that the following formula defines a cocycle on $L^d \fg$ of degree $(d+1)$:
\[
\begin{array}{cccl}
\displaystyle L^d \theta : & (L^d \fg)^{\tensor d + 1} & \to & \CC \\
\displaystyle & (f_0 \tensor X_0)\tensor \cdots \tensor (f_d \tensor X_d) & \mapsto & \displaystyle  \theta(X_0,\ldots,X_d)  \oint_{|z_1| = 1} \cdots \oint_{|z_d| = 1} f_0 \d f_1 \cdots \d f_d .
\end{array}
\]
Here $f_i \tensor X_i \in L^d \fg = \CC[z_1^{\pm}, \cdots, z_d^{\pm}] \tensor \fg$. 
The above is just an iterated version of the usual residue pairing.
This cocycle determines a shifted Lie algebra extension of the iterated loop algebra
\[
\CC[d-1] \to \Hat{L^d \fg}_\theta \to L^d \fg,
\]
that appears in the theorem below. 

The following can be proved in exact analogy as the above result for sphere algebras and we omit the proof here.

\begin{prop}
Fix $\theta \in \Sym^{d+1}(\fg^*)^\fg$ and let $\vec{r}_* \UU_\theta \sG_{(\CC^\times)^d}$ be the factorization algebra on $(\RR_{>0})^d$ obtained by reducing the Kac-Moody factorization algebra along the $d$-torus.
There exists a dense $d$-dimensional subfactorization algebra $\sF^{lc}$ that is locally constant and is equivalent, as $E_d$-algebras, to
\[
U^{E_d} \left( \Hat{L^d \fg}_{\theta} \right) .
\]
\end{prop}

%\begin{thm} There is a dense injective map of factorization algebras on $\RR^d$: 
%\[
%\Phi^{L^d} : \left(U_{E_d} \left(\Hat{L^d g}_\theta\right)\right)^{fact} \to \vec{r}_*\left(\sG_{\CC^{\times d}}\right) .
%\] 
%\end{thm}

%\subsection{The disk as a module}

\subsection{Large $N$ limits}

\def\cycls{{\rm Cyc}_*}
\def\lqt{{\ell q t}}
\def\colim{{\rm colim}}
\def\sl{\mathfrak{sl}}

We take a slight detour from the main course of this paper to remark on something special that happens for the case of $\gl_N$ as $N$ goes to infinity.
The observations we make here are borrowed from unpublished work of the first author with Greg Ginot and Mahmoud Zeinalian,
but they are closely related to prior work of Costello-Li \cite{} and Movshev-Schwarz~\cite{}.

The essential fact is the remarkable theorem of Loday-Quillen \cite{LQ} and Tsygan~\cite{Tsy},
which yields a natural map \owen{ugly notation so lets find a better one}
\[
\lqt(A) :\colim_{N}\, \cliels(\gl_N(A)) \cong \cliels(\gl_\infty(A)) \to \Sym(\cycls(A)[1])
\]
for any dg algebra $A$ over a field $k$ of characteristic~0.
(It works even for $A_\infty$ algebras.)
Naturality here means that it works over the category of dg algebras and maps of dg algebras.
When restricted to the $\sl_\infty(k)$-invariants, we obtain a quasi-isomorphism
\[
\lqt(A) :\cliels(\gl_\infty(A))^{\sl_\infty(k)} \xto{\simeq} \Sym(\cycls(A)[1]),
\]
even when $A$ is nonunital. 
(When $A$ is unital, the $\sl_\infty(k)$-invariants are quasi-isomorphic to the full Chevalley-Eilenberg chains,
making for a very nice relationship. 
Note that it is potentially problematic to use strict invariants with a particular model for derived coinvariants of a Lie algebra,
namely Chevalley-Eilenberg chains.)

By taking $A$ to be the cosheaf $\Omega^{0,*}_c$ on a complex manifold $X$,
we obtain the following, whose proof is deferred to the end of this section.

\begin{prop}
Let $\sG l_N$ denote the local Lie algebra $\Omega^{0,*} \otimes \gl_N$.
For every $N$, there is a map of prefactorization algebras
\[
\lqt_N: \UU \sG l_N \to \Sym(\cycls(\Omega^{0,*}_c)[1])
\]
that factors through a map of prefactorization algebras
\[
\lqt: \UU \sG l_\infty \to \Sym(\cycls(\Omega^{0,*}_c)[1]).
\]
On any complex $d$-fold $X$, there is a quasi-isomorphism
\[
\lqt(X): \UU \sG l_\infty(X)^{\sl_\infty(\CC)} \to \Sym(\cycls(\Omega^{0,*}_c(X))[1]),
\]
and on closed $X$, there is a quasi-isomorphism
\[
\lqt(X): \UU \sG l_\infty(X) \to \Sym(\cycls(\Omega^{0,*}_c(X))[1]).
\]
\end{prop}

\begin{rmk}
We note that, as with the definition of the Chevalley-Eilenberg chains of a local Lie algebra,
we use here a construction of cyclic chains that plays nicely with the kind of vector spaces relevant to this situation,
namely smooth sections of vector bundles.
Where the cyclic quotient $A^{\otimes n}/C_n$ would appear for an ordinary algebra in complex vector spaces,
we take the $\Omega^{0,*}(X^n)/C_n$ and so on.
\owen{I need to check that the $\Sym$ doesn't lead to issues \dots If we must, we can ignore the quasi-isomorphism and focus on the map just to cyclic homology.}
\end{rmk}

\brian{Would it also be a good idea to remark on the ``local cyclic cohomology"?
I think that's even easier to compute in this case, and we could point to the extensions.
I can put that in if you'd like.
}

This result has teeth because it is possible to compute the relevant cyclic homology.
For simplicity, consider the case where $X$ is closed, 
so that we are working with the Dolbeault complex and hence are implicitly computing the cyclic homology of the structure sheaf $\cO$ on $X$.
Standard results \owen{e.g., Thm 3.4.12 of Loday} then imply that
\[
H^*(\cycls(\Omega^{0,*}(X))) \cong \bigoplus_{n \geq 0} \left( H^*(X, \Omega^n_{hol}/\partial \Omega^{n-1}_{hol}) \oplus \bigoplus_{k > 0} H^{n-2k}_{dR}(X) \right)[-n]
\]
In conjunction with the proposition, we see that the large $N$ limit of the enveloping factorization algebras $\UU \sG l_\infty$ depends primarily on the underlying topology of the complex manifold $X$, 
along with a subtle dependence on the complex geometry through the cohomology of the quotient sheaves $\Omega^n_{hol}/\partial \Omega^{n-1}_{hol}$.
In the future we hope to pursue the consequences of this observation, 
as it indicates that there is an important class of currents that can be understand through cyclic methods.
In particular, it would be interesting to relate these results to aspects of the large $N$ limits of holomorphic gauge theories.

\begin{rmk}
Loday and Procesi proved variants of the Loday-Quillen-Tsygan theorem for the Lie algebras $\mathfrak{o}_n$ and $\mathfrak{sp}_{2n}$,
in which cyclic homology of the algebra is replaced by its dihedral homology.
As nothing substantive changes in proving analogous versions of our results above, 
we do not spell out the details here.
It would be interesting to pursue the analogues of questions just raised for these Lie algebras.
\end{rmk}

\begin{proof}
The main issue is to show that $\Sym(\cycls(\Omega^{0,*}_c)[1])$ is a prefactorization algebra,
since the Loday-Quillen-Tsygan construction then implies the rest of the claim.

As $\cycls$ is a functor on the category of dg algebras, 
we see that $\cycls(\Omega^{0,*}_c)$ is a precosheaf
and hence $\cC = \Sym(\cycls(\Omega^{0,*}_c)[1])$ is also a precosheaf. 

It remains to provide the structure maps of the putative prefactorization algebra~$\cC$.
We note that for two algebras $A$ and $B$,
\[
\cycls(A) \oplus \cycls(B) \simeq \cycls(A \times B)
\] 
by \owen{find convenient reference (use the two idempotents)}.
Hence, for the cosheaf $\Omega^{0,*}_c$ on pairwise disjoint opens $U_1,\ldots, U_n$,
the isomorphism of dg algebras
\[
\Omega^{0,*}_c(U_1) \times \cdots \times \Omega^{0,*}_c(U_n) \cong \Omega^{0,*}_c(U_1 \sqcup \cdots \sqcup U_n),
\]
determines a quasi-isomorphism
\beqn
\label{eqn:cyccosheaf}
\cycls(\Omega^{0,*}_c(U_1)) \oplus \cdots \oplus \cycls(\Omega^{0,*}_c(U_n)) \xto{\simeq} \cycls(\Omega^{0,*}_c(U_1 \sqcup \cdots \sqcup U_n)).
\eeqn
Now suppose these pairwise disjoint opens $U_1,\ldots, U_n$ sit inside a larger open $V$.
We need to provide a multilinear structure map 
\beqn
\label{eqn: desiredmap}
\cC(U_1) \times \cdots \times \cC(U_n) \to \cC(V)
\eeqn
to describe $\cC$ as a prefactorization algebra.
The inclusion $U_1 \sqcup \cdots \sqcup U_n \hookrightarrow V$ provides a map
\[
\cycls(\Omega^{0,*}_c(U_1 \sqcup \cdots \sqcup U_n)) \to \cycls(V),
\]
via the precosheaf $\cycls(\Omega^{0,*}_c)$,
and so applying $\Sym$ gives us
\beqn
\label{eqn:map2}
\cC(U_1 \sqcup \cdots \sqcup U_n) \to \cC(V).
\eeqn
Likewise, applying $\Sym$ to map \eqref{eqn:cyccosheaf} provides
\[
\cC(U_1) \times \cdots \times \cC(U_n) \to \cC(U_1 \sqcup \cdots \sqcup U_n).
\]
We thus obtain the desired map \eqref{eqn: desiredmap} as a composite.
This construction is automatically associative for nested inclusions of pairwise disjoint opens,
and so $\cC$ is a prefactorization algebra.
\end{proof}





