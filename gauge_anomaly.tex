\documentclass[10pt]{amsart}

\usepackage{macros,slashed}

\linespread{1.25}

\usepackage{tikz}
\usetikzlibrary{arrows,shapes}
\usetikzlibrary{trees}
\usetikzlibrary{matrix,arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{calc,through}
\usetikzlibrary{decorations.pathreplacing}
\usepackage{pgffor}

\def\sAd{\sA{\rm d}}

\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{decorations.markings}
\tikzset{
	% >=stealth', %%  Uncomment for more conventional arrows
    vector/.style={decorate, decoration={snake}, draw},
	provector/.style={decorate, decoration={snake,amplitude=2.5pt}, draw},
	antivector/.style={decorate, decoration={snake,amplitude=-2.5pt}, draw},
    fermion/.style={draw=black, postaction={decorate},
        decoration={markings,mark=at position .55 with {\arrow[draw=black]{>}}}},
    fermionbar/.style={draw=black, postaction={decorate},
        decoration={markings,mark=at position .55 with {\arrow[draw=black]{<}}}},
    fermionnoarrow/.style={draw=black},
    gluon/.style={decorate, draw=black,
        decoration={coil,amplitude=4pt, segment length=5pt}},
    scalar/.style={dashed,draw=black, postaction={decorate},
        decoration={markings,mark=at position .55 with {\arrow[draw=black]{>}}}},
    scalarbar/.style={dashed,draw=black, postaction={decorate},
        dwecoration={markings,mark=at position .55 with {\arrow[draw=black]{<}}}},
    scalarnoarrow/.style={dashed,draw=black},
    electron/.style={draw=black, postaction={decorate},
        decoration={markings,mark=at position .55 with {\arrow[draw=black]{>}}}},
	bigvector/.style={decorate, decoration={snake,amplitude=4pt}, draw},
}

\usepackage[final]{pdfpages}

\title{Local symmetries of holomorphic theories}

\def\brian{\textcolor{blue}{BW: }\textcolor{blue}}


\begin{document}
\maketitle
\tableofcontents

\section{A very local Grothendieck-Riemann-Roch theorem}

The main goal of the BV formalism developed in \cite{CostelloRenormalization} is to rigorously construct quantum field theories using a combination of homological methods and a rigorous model for renormalization. 
A particular nicety of this approach is the ability to study {\em families} of field theories, which we will turn into an equivariant version of BV quantization, see Section \ref{sec: equiv BV}. 
In this section we will consider a family of QFT's parametrized by the moduli space of principal $G$-bundles. 
Our main result is to interpret a certain anomaly coming from BV quantization as a families index over ${\rm Bun}_G(X)$. 
This anomaly is computed via an explicit Feynman diagrammatic calculation and is related to a local cocycle of the current algebra discussed in Section \ref{sec: g j functional}.
 
We interpret this result as a formal universal version of the Grothendieck-Riemann-Roch theorem over the moduli space of bundles. 
The main idea is that the local cocycles we have just discussed in Section \ref{sec: g j functional} can be interpreted as characteristic classes on the (formal neighborhood) of the moduli space of $G$-bundles.

We will arrive at the result in a way that is local-to-global on spacetime which we formulate in terms of factorization algebras.
The main them of Costello and Gwilliam's approach to QFT is that the observables of a QFT determine a factorization algebra. 
We study the associated family of factorization algebras associated to the family of QFT's over the moduli space of $G$-bundles.
We will recollect a formulation of Noether's theorem for symmetries of a theory in terms of factorization algebras developed in Chapter 11 of \cite{CG2}. 
The central object in this discussion is a ``local index" which describes how the Kac-Moody factorization algebra acts on the observables of the QFT. 
Locally on spacetime we see how Noether's theorem provides a {\em free field realization} of the Kac-Moody factorization algebra generalizing that of the Kac-Moody vertex algebra in chiral conformal field theory \cite{FrenkelFree}. 

We now give a brief summary of the results, with a background for the situation we consider.
Suppose that $P$ is a fixed holomorphic $G$-bundle on a complex manifold $X$.
We have already seen how to express the formal deformation space of $P$ inside of the moduli of $G$-bundles using the dg Lie algebra $\sAd(P)(X) = \Omega^{0,*}(X , \ad (P))$.
In particular, any Maurer-Cartan element of $\sAd(P)(X)$ defines a deformation of $P$. 
We have seen that there is a refinement of this dg Lie algebra to a local Lie algebra $\sAd(P)$ whose factorization envelope defines the higher Kac-Moody factorization algebra above.
To any $G$-representation $V$ we will define a holomorphic theory with fields $\sE_V$ that is equivariant for this local Lie algebra. 
Equivalently, we can think of $\sE_V$ as defining a family of theories over the formal completion of $P$ in the moduli of $G$-bundles
\ben
\xymatrix{
\sE_V|_{P'} \ar[d] \ar[r] & \sE_V \ar[d] \\
\{P'\} \ar[r] & {\rm Bun}_G(X)^{\wedge}_P .
}
\een
Over each fiber $P'$ the theory $\sE_V|_{P'}$ is a {\em free} theory, so admits a canonical BV quantization. 
Our formulation of equivariant BV quantization is codification of the problem of gluing together these quantizations in a compatible way.
We will show how this presents itself in the failure of the BV quantization to be a {\em flat} family. 
Our main result is the following. 

\begin{thm}\label{thm ggrr}
Let $P$ be any principal $G$-bundle over a compact affine complex manifold $X$ of dimension $d$.
Suppose   $V$ is a $G$-representation.
Then, the factorization homology $\int_X \Obs^\q_{V}$ defines a line bundle over the formal neighborhood of $P$ inside of the moduli of $G$-bundles.
Moreover, its first Chern class is 
\ben
c_1\left(\int_X \Obs^\q_{V}\right) = C \ch_{d+1}^\fg (V)
\een
under the identification of $\ch_{d+1}^{\fg} (V)$ as a cohomology class on the formal neighborhood of $P$ inside of the moduli of $G$-bundles in Equation (\ref{cohbung}) explained below.
Here, $C$ is some nonzero complex number.
\end{thm}

There is an elucidating geometric description of how the classes $\ch_{d+1}(V)$ appear: they describe curvatures of line bundles over the moduli of $G$-bundles.
Let ${\rm Bun}_{G}(X)$ denote the moduli space of $G$-bundles on the complex $d$-fold $X$. \footnote{For $d > 1$ \cite{FHK} have constructed a global smooth derived realization of this space, but its full structure will not be used in this discussion.}
Over the space ${\rm Bun}_G(X) \times X$ there is the {\em universal} $G$-bundle. 
If $P \to X$ is a $G$-bundle, the fiber over the point $\{[P]\} \times X$ is precisely the $G$-bundle $P \to X$. 
This universal $G$-bundle is classified by a map $f : {\rm Bun}_G(X) \times X \to B G$. 
Consider the following diagram
\ben
\xymatrix{
& {\rm Bun}_G(X) \times X \ar[dr]^-{f} \ar[dl]_-{\pi} & \\
{\rm Bun}_G(X) & & B G
}
\een
where $\pi : {\rm Bun}_G(X) \times X \to {\rm Bun}_G(X)$ denotes the projection. 
If $\theta \in \Sym^{d+1}(\fg^*)^\fg \cong H^{d+1}(G , \Omega^{d+1}) \subset H^{2d+2}(BG)$ then we obtain via push-pull in the diagram above
\ben
\int_\pi \circ f^* \theta \in H^2({\rm Bun}_G(X)) .
\een 

Let $\sP$ denote the universal principal $G$-bundle.
This is the $G$-bundle over ${\rm Bun}_G(X) \times X$ whose fiber over $\{[P\to X]\} \times X$ is the principal $G$-bundle $P \to X$ itself. 
Given any representation $V$ we can define the vector bundle
\ben
\sV = \sP \times^G V
\een
over ${\rm Bun}_G(X) \times X$.
The fiber of this bundle over $\{[P\to X]\} \times X$ is the associated vector bundle $P \times^G V$. 
We take the determinant of the derived pushforward of $\sV$ along $\pi$ to obtain a line bundle $\det(\RR \pi_* \sV)$ on ${\rm Bun}_G(X)$. 
We will see how the global observables $\int_X \Obs^\q_{P,V}$ provide a formal version of this line bundle near a fixed principal bundle $P$. 
Moreover, if we naively apply the Grothendieck-Riemann-Roch theorem in this universal context one finds
\ben
c_1(\det(\RR \pi_* \sV)) = \int_\pi {\rm Td}_X \cdot {\rm ch}(\sV) \in H^2(\Bun_G(X)) .
\een
In the case that $X$ is affine, so that ${\rm Td}_X = 1$, our theorem provides a proof of this formula using methods of perturbative QFT. 
To prove the theorem on a general complex manifold we need to take into account the action of holomorphic vector fields, which is the content of the next section.

\subsection{The classical family}\label{sec: classical g equiv} 

In this section, we consider a BV theory that is equivariant for the local Lie algebra $\sAd(P)$ in the language of Section \ref{sec: local equiv} 
Let $V$ be any $G$-representation, and define the associated vector bundle $\sV_P = P \times^G V$ on $X$.
The holomorphic theory we consider is based on the graded holomorphic vector bundle $\sV_P \oplus K_X \tensor \sV_P^* [d-1]$, where $\sV^*_P$ is the linear dual bundle. 
The fields of the associated free BV theory are
\ben
\sE_{P,V} = \Omega^{0,*}(X, \sV_P) \oplus \Omega^{d,*}(X , \sV_P^*)[d-1] .
\een
This is simply the $\beta\gamma$ system on $X$ twisted by the vector bundle $\sV_P$. 
The action functional is $\int \<\beta, \dbar \gamma\>_{V}$ where the pairing is between $V$ and its dual. 
In particular, the theory $\sE_V$ is free.
Let $\Obs^\q_{P,V}$ denote the corresponding factorization algebra of quantum observables.

The action of $\fg$ on $V$ extends to an action of the local Lie algebra $\sAd(P)$ on this classical BV theory.
To define this equivariance we need to presribe a Noether current. 

\begin{lem} 
The local Noether current $I^{\fg} \in \cloc^*(\sAd(P)) \tensor \oloc(\sE_{P,V})$ defined by
\ben
I^\fg(\alpha, \gamma,\beta) = \int_X \<\beta, \alpha \cdot \gamma\>_V
\een
satisfies the equivariant classical master equation
\ben
(\d_{\fg} + \dbar) I^\fg + \frac{1}{2}\{I^\fg, I^\fg\} = 0 ,
\een 
where $\d_{\fg}$ encodes the Lie algebra structure on $\sAd(P)$.
Hence, $I^\fg$ gives $\sE_V$ the structure of a classical $\sAd(P)$-equivariant theory.
\end{lem}
\begin{proof}
If $\alpha$ is an element in $\sAd(P)$ and $\gamma \in \Omega^{0,*}(X, \sV_P)$ we define $\alpha \cdot \gamma$ through the $\fg$-module structure of $\fg$ on $V$ combined with the wedge product of Dolbeault forms. 
Note that $I^\fg$ is arises from holomorphic differential operators so that $\dbar I^\fg = 0$.
From the definition of the bracket we see that for $\alpha_1,\alpha_2$ one has $\{\int \<\beta, \alpha_1 \cdot \gamma\>, \int \<\beta, \alpha_2\cdot \gamma\>\} = \int \<\beta, [\alpha_1,\alpha_2] \cdot \gamma\>$ which cancels the term coming from $\d_{\fg}$. 
\end{proof}

\subsection{BV quantization in families}

The main technique we employ is equivariant BV quantization, which we have reviewed in Section \ref{sec: equiv BV}. 
Our main result holds for a compact affine manifold, which we will view as coming from a quotient of an open set in affine space $\CC^d$. 
Thus, we will mostly work with the theory defined on $\CC^d$ and afterwards deduce our main result on the quotient via descent.
Thus, we will work with the $\beta\gamma$ system
\ben
\sE_V = \Omega^{0,*}(\CC^d, V) \oplus \Omega^{d,*}(\CC^d, V^*)[d-1]
\een
where $V$ is some $\fg$-module.
The local Lie algebra which acts on this theory is $\sG = \Omega^{0,*}(\CC^d , \fg)$. 

Our first step is to construct an equivariant effective prequantization.
for the $\sG$-equivariant theory.
As has been the case over and over again in this thesis, our situation for constructing the prequantization is vastly simplified since our theory comes from holomorphic data. 
Indeed, the equivariant $\beta\gamma$ system is a holomorphic theory on $\CC^d$ so that we can apply Lemma \ref{lem: hol renorm}.
As an immediate corollary, the following definition is well-defined. 

\begin{dfn}
For $L > 0$, let
\ben
I^{\rm \fg}[L] := \lim_{\epsilon \to 0} W(P_{\epsilon < L}, I^{\rm \fg}) 
= \lim_{\epsilon \to 0} \sum_{\Gamma } \frac{\hbar^{g(\Gamma)}}{|{\rm Aut}(\Gamma)|} W_\Gamma(P_{\epsilon<L}, I^{\fg}) . 
\een 
Here the sum is over all isomorphism classes of stabled connected graphs, but only graphs of genus $\leq 1$ contribute nontrivially. 
By construction, the collection satisfies the RG flow equation and its tree-level $L \to 0$ limit is manifestly $I^{\fg}$.
Hence $\{I^{\rm \fg}[L]\}_{L \in (0,\infty)}$ is a \emph{$\sG$-equivariant prequantization}.
\end{dfn}

Our next step is to compute the obstruction to quantization of the $\sG$-equivariant theory.
By definition, the scale $L$ {\em obstruction cocycle} $\Theta_{V}[L]$ is 
the failure for the interaction $I^{\rm \fg}[L]$ to satisfy the scale $L$ equivariant quantum master equation. 
Explicitly, one has
\ben
\hbar \Theta_V [L] = (\d_{\fg} + Q)I^{\fg}[L] + \hbar \Delta_L I^{\rm \fg}[L] + \{I^{\fg}[L], I^{\fg}[L]\}_L.
\een
A completely analogous argument as in Corollary 16.0.5 of \cite{WG2} we see that the scale $L$ obstruction is given by a sum over wheels. 

\begin{lem}
Only wheels contribute to the anomaly cocycle $\Theta_V[L]$. 
Moreover, one has
\ben
\Theta_V[L] = \sum_{\substack{\Gamma \in \text{\rm Wheels}\\ e \in {\rm Edge}(\Gamma)}} W_{\Gamma,e}(P_{\epsilon<L}, K_\epsilon,
I^{\rm \fg}),
\een
where the sum is over wheels and distinguished edges.
The notation $W_{\Gamma,e}(P_{\epsilon<1}, K_\epsilon,
I^{\rm \fg}[\epsilon])$ means we place the propagator at all edges besides the distinguished one, where we place $K_\epsilon$. 
\end{lem}

The only fields that propagate are the $\beta\gamma$ fields with values in $V$. 
Since all vertices are trivalent we see that the anomaly cocycle is only a functional of the background fields $\sG$, see Figure \ref{fig:liewheel}.\footnote{We use squiggly arrows for elements in $\sG$ to be consistent with usual physics conventions for gauge fields.}

\begin{figure}
\begin{center}
\begin{tikzpicture}[line width=.2mm, scale=1.5]

%\pgfmathsetmacro{\ex}{0}
%\pgfmathsetmacro{\ey}{1}

%\draw (\ex,\ey) ++(45:.8) arc (45:-45:.8);

		\draw[fill=black] (0,0) circle (1cm);
		%\draw[fill=red] (0,0) arc (145:215:1);
		\draw[fill=white] (0,0) circle (0.99cm);
		\draw[line width=0.35mm,red] ++(145:0.995) arc (145:215:0.995);
		%\draw[red] (0,0) arc (30:60:3);

		\draw[vector](145:2) -- (145:1);
		\node at (145:2.3) {$\alpha^{(0)}$};
			%\node at (145:0.85) {$v_0$};
		\node at (60:0.75) {$P_{\epsilon<L}$};
		\node at (-60:0.75) {$P_{\epsilon<L}$};
		\draw[vector](215:2) -- (215:1cm);
		\node at (215:2.3) {$\alpha^{(2)}$};
			%\node at (215:0.85) {$v_{d}$};
		\node[red] at (180:0.8) {$K_\epsilon$};
		\draw[vector](0:2) -- (0:1);
		\node at (0:2.3) {$\alpha^{(1)}$};
			%\node at (35:0.85) {$v_{\alpha}$};
		%\node at (0:0.8) {$P_{\epsilon<L}$};
		%\node at (270:0.8) {$P_{\epsilon<L}$};
	    	\clip (0,0) circle (1cm);
\end{tikzpicture}
\caption{The diagram representing the weight $W_{\Gamma, e}(P_{\epsilon<L}, K_\epsilon, I^\fg)$ in the case $d=2$. 
On the black internal edges are we place the propagator $P_{\epsilon < L}$ of the $\beta\gamma$ system. 
On the red edge labeled by $e$ we place the heat kernel $K_\epsilon$.
The external edges are labeled by elements $\alpha^{(i)} \in \Omega^{0,*}_c(\CC^2)$.}
\label{fig:liewheel}
\end{center}
\end{figure}

In particular, there is no obstruction to having an {\em action} by $\sG$, only an obstruction to having an {\em inner action}. 
Concretely, the external edges of any closed wheel occurring in the expansion of the anomaly must be labeled by $\sG$. 
As an immediate consequence we have the following.

\begin{lem}
The effective family $\{I^{\fg}[L]\}$ defines a one-loop exact $\sG$-equivariant quantum field theory.
In other words, it satisfies the $\sG$-equivariant quantum master equation modulo functionals purely of the background fields $\sG$. 
\end{lem}

It follows that the anomaly $\{\Theta[L]\}$ measures the obstruction to $\{I^\fg[L]\}$ to defining an {\em inner} action. 

%\begin{lem} 
%The one-loop effective family $\{I^\fg[L]\}$ 
%\ben
%I^\fg [L] = \lim_{\epsilon \to 0} W(P_{\epsilon < L}, I^\fg) \mod \hbar^2
%\een
%is well-defined and satisfies the equivariant quantum master equation modulo $\cloc^*(\sG)[[\hbar]]$. 
%\end{lem}
%
%Working modulo $\hbar^2$ Lemma \ref{lem: inner action} implies that the anomaly to $\{I^{\fg}[L]\}$ to satisfying the quantum master equation modulo $\hbar^2$ is an element 
%\ben
%\Theta_V \in \hbar \cloc^*(\sG) .
%\een
%The next subsection is devoted to an explicit calculation of this anomaly using Feynman diagrams. 

\subsubsection{The anomaly calculation}

We now perform the main technical calculation of the anomaly cocycle.

\begin{prop}\label{prop: inner anomaly}
The $L\to 0$ limit of the anomaly cocycle $\Theta = \lim_{L \to 0} \Theta_V[L]  \in \cloc^*(\sG)$ is of the form
\ben
\Theta_V = C \cdot J_{\CC^d}(\ch_{d+1}^\fg (V)),
\een
where $\ch_{d+1}^\fg(V) \in \Sym^{d+1}(\fg^*)^\fg$ and where $J_{\CC^d} : \Sym^{d+1}(\fg^*)^\fg \to \cloc^*(\sG)$ is the map of Lemma \ref{prop j map} and where $C$ some constant only depending on the dimension $d$. 
\end{prop}

To compute the anomaly we refer to the following result about the expression for the anomaly cocycle in terms of the Feynman diagram expansion.
As a direct corollary of our general characterization of chiral anomalies, Lemma \ref{lem: chiral anomaly}, we have the following result.

\begin{lem}\label{lem: g anomaly}
The limit $\Theta_{V} := \lim_{L \to 0} \Theta_{V}[L]$ exists and 
is an element of degree one in $\clie^*(\Vect,\Cloc^*(\fg_n^\CC))$. 
Moreover, it is given by
\ben
\Theta_V = \lim_{\epsilon \to 0} \sum_{\substack{\Gamma \in (d+1)\text{\rm -vertex wheels}\\ e \in {\rm Edge}(\Gamma)}} W_{\Gamma,e}(P_{\epsilon<1}, K_\epsilon,
I^{\rm \fg}[\epsilon]),
\een
where the sum is over wheels $\Gamma$ with $(d+1)$ vertices and a distinguished inner edge $e$.
\end{lem}

%Part of the data of a free theory is a gauge fixing condition $Q^{GF}$. 
%This is an operation on fields of cohomological degree $-1$ and enables us to fix the propagator uniquely. 
%For the $\beta\gamma$ system on $\CC^d$ with values in the vector space $V$ the gauge fixing operator we choose is 
%\ben
%Q^{GF} = \dbar^* \tensor \id_V = \pm \sum_i \frac{\partial}{\partial z_i} \frac{\partial}{\partial (\d \zbar_i)} \tensor \id_V .
%\een

%The propagator with UV-IR cutoff $\epsilon,L$ is equal to
%\ben
%P_{\epsilon, L} (z, w) = \int_{t = \epsilon}^L \dbar^* K_t(z,w)\d t .
%\een
%Here, 
%\ben
%K_t (z,w) = k_t(z,w) \Omega(z,w) (\id_V \tensor 1 + 1 \tensor \id_{V^*})
%\een
%where $k_t$ the heat kernel for the Dolbeault Laplacian $\dbar^* \dbar + \dbar \dbar^*$ acting on smooth functions on $\CC^d$, $\Omega(z,w)$ is a constant coefficient differential form on~$\CC^d_z \times \CC^d_w$ satisfying
%\ben
%\int_{z \in \CC^d} \phi(z) \wedge \Omega(z,w) = \pm \phi(w),
%\een
%and $\id_V , \id_{V^*} \in \Sym^2(V \oplus V^*)$ represent the identity maps $V \to V$, $V^* \to V^*$. 
%Explicitly, if we choose a basis $\{e_a\}$ for $V$ with dual basis $\{e_a^*\}$ we have the following formula for $K_t(z,w)$: 
%\ben
%K_t(z,w) = \frac{1}{(4 \pi t)^d} e^{-|z-w|^2/ t} \left((\d^d z - \d^d w) \wedge \prod_{i} (\d \zbar_i - \d \Bar{w}_i) \right) \left(\sum_{a = 1}^{\dim V} (e_a \tensor e_a^* + e_a^* \tensor e_a) \right).
%\een

%Now, we are ready to apply Lemma \ref{lem anomaly} to compute the anomaly cocycle. 
%The fact that the limit of $W(P_{\epsilon,L}, I^{\sL})$ as $\epsilon \to 0$ exists is technical and left in the appendix. 
%We provide an explicit analysis of the sum of the Feynman weights corresponding to wheels.
%We find that the sum reduces to evaluating the weight of a single wheel with $d+1$ vertices. 

%Fix $k \geq 1$ to be the number of vertices of the wheel $\Gamma$. 
%By differential form type reasons, the wheels with number of vertices $k \leq d$ vanish identically. 
%To see this, note that the integral computing the Feynman weight is an integral over $\CC^{dk}$. 
%Each propagator contributes a differential form of Dolbeault type $(d, d-1)$.
%The heat kernel contributes a differential form of type $(d,d)$. 
%Thus, in total the internal edges contribute a differential form of type 
%\ben
%(kd, (k-1)(d-1) + d) = (kd, (k-1)d + 1).
%\een
%Now, t	he anomaly is a cocycle of $\sL$ of cohomological degree $+1$.
%\brian{finish}
%
%The reason that the wheels of valency $k > d+1$ vanish is more subtle, and relies on analytic bounds of the integral computing the weight. 
%We provide this argument in the appendix. 

The lemma implies that we only need to consider the wheel with $d+1$ vertices. 
Each trivalent vertex is labeled by both an analytic factor and Lie algebraic factor. 
The Lie algebraic part of each vertex can be thought of as the defining map of the representation $\rho : \fg \to {\rm End}(V)$. 
The diagrammitcs of the wheel amounts to taking the trace of the symmetric $(d+1)$st power of this Lie algebra factor. 
Thus, the Lie algebraic factor of the weight of the wheel is the $(d+1)$st component of the character of the representation
\ben
{\rm ch}_{d+1}^\fg(V) = \frac{1}{(d+1)!} {\rm Tr}\left(\rho(X)^{d+1}\right) \in \Sym^{d+1}(\fg^*) .
\een

To finish the calculation we must compute the analytic weight of the wheel with $d+1$ vertices. 
Recall, our goal is to identify the anomaly $\Theta$ with the image of ${\rm ch}_{d+1}^\fg(V)$ under the map
\ben
J : \Sym^{d+1}(\fg^*)^\fg \to \cloc^*(\Omega^{0,*}(\CC^d)\tensor \fg)
\een
that sends an element $\theta$ to the local functional $\int \theta(\alpha \partial \alpha \cdots \partial \alpha)$. 
We have just seen that the Lie algebra factor in local functional representing the anomaly agrees with the $(d+1)$st Chern character. 
Thus, to finish we must show the following.

\begin{lem} 
As a functional on the abelian dg Lie algebra $\Omega^{0,*}(\CC^d)$, the analytic factor of the weight $\lim_{L\to 0} \lim_{\epsilon \to 0} W_{\Gamma, e} (P_{\epsilon < L}, K_\epsilon, I^\fg)$ is equal to a multiple of the local functional
\ben
\int \alpha \partial \alpha \cdots \partial \alpha \in \cloc^*(\Omega^{0,*}(\CC^d)) .
\een
\end{lem}

\begin{proof}

Let's fix some notation. 
We enumerate the vertices by integers $a = 0,\ldots, d$. 
Label the coordinate at the $i$th vertex by $z^{(a)} = (z_1^{(a)}, \ldots, z_d^{(a)})$. 
The incoming edges of the wheel will be denoted by homogeneous Dolbeault forms 
\ben
\alpha^{(a)} = \sum_{J} A^{(a)}_J \d \zbar_J^{(a)} \in \Omega_c^{0,*}(\CC^d) .
\een
where the sum is over the multiindex $J = (j_1,\ldots, j_k)$ where $j_a = 1,\ldots, d$ and $(0,k)$ is the homogenous Dolbeault form type. 
For instance, if $\alpha$ is a $(0,2)$ form we would write
\ben
\alpha = \sum_{j_1 < j_2} A_{(j_1,j_2)} \d \zbar_{j_1} \d\zbar_{j_2} .
\een
Denote the functional obtained as the $\epsilon \to 0$ weight of the wheel with $(d+1)$ vertices from Lemma \ref{lem: g anomaly} by $W_L$.
The $L\to 0$ limit of $W_L$ is the local functional representing the one-loop anomaly $\Theta$. 

The weight has the form
\ben
W_L(\alpha^{(0)},\ldots,\alpha^{(d)}) = \pm \lim_{\epsilon \to 0} \int_{\CC^{d(d+1)}} \left(\alpha^{(0)}(z^{(0)}) \cdots \alpha^{(d)}(z^{(d)}) \right) K_\epsilon(z^{(0)},z^{(d)}) \prod_{a =1}^d P_{\epsilon,L} (z^{(a-1)}, z^{(a)}) .
\een
We introduce coordinates
\begin{align*}
w^{(0)} & = z^{(0)} \\
w^{(a)} & = z^{(a)} - z^{(a-1)} \;\;\; 1 \leq a \leq d .
\end{align*}
The heat kernel and propagator part of the integral is of the form
\[
\begin{array}{ccl}
\displaystyle
K_\epsilon(w^{(0)},w^{(d)}) \prod_{a =1}^d P_{\epsilon,L} (w^{(a-1)}, w^{(a)}) & = & \displaystyle \frac{1}{(4 \pi \epsilon)^d} \int_{t_1,\ldots,t_d = \epsilon}^L \frac{\d t_1 \cdots \d t_d}{(4 \pi t_1)^d \cdots (4 \pi t_d)^d} \frac{1}{t_1\cdots t_d}  \\ & & \displaystyle \times \d^d w^{(0)} \prod_{i=1}^d (\d \Bar{w}^{(1)}_i + \cdots + \d \Bar{w}^{(d)}_i) \prod_{a = 1}^d \d^d w^{(a)} \left(\sum_{i = 1}^d \Bar{w}_i^{(a)} \prod_{j \ne i} \d \Bar{w}_{j}^{(a)}\right)
\\ & & \displaystyle \times e^{-\sum_{a,b = 1}^d M_{a b} w^{(a)} \cdot \Bar{w}^{(b)}} .
\end{array}
\]
Here, $M_{ab}$ is the $d \times d$ square matrix satisfying
\ben
\sum_{a,b = 1}^d M_{a b} w^{(a)} \cdot \Bar{w}^{(b)} = |\sum_{a = 1}^d w^{(a)} |^2 / \epsilon + \sum_{a = 1}^d |w^{(a)}|^2 / t_a .
\een
Note that
\ben
\prod_{i=1}^d (\d \Bar{w}^{(1)}_i + \cdots + \d \Bar{w}^{(d)}_i) \prod_{a = 1}^d \left(\sum_{i = 1}^d \Bar{w}_i^{(a)} \prod_{j \ne i} \d \Bar{w}_{j}^{(a)}\right) = \left( \sum_{i_1,\ldots i_d} \epsilon_{i_1\cdots i_d} \prod_{a=1}^d \Bar{w}^{(a)}_{i_a}\right) \prod_{a=1}^d \d^d \Bar{w}^{(a)} .
\een
In particular, only the $\d w_i^{(0)}$ components of $\alpha^{(0)} \cdots \alpha^{(d)}$ can contribute to the weight.

For some compactly supported function $\Phi$ we can write the weight as
\ben
\begin{array}{ccl}
W (\alpha^{(0)}, \ldots, \alpha^{(d)}) & = & \lim_{\epsilon \to 0} \displaystyle \int_{\CC^{d(d+1)}} \left(\prod_{a = 0}^{d} \d^d w^{(a)} \d^d \Bar{w}^{(a)}\right) \Phi \\ & \times & \displaystyle \frac{1}{(4 \pi \epsilon)^d} \int_{t_1,\ldots,t_d = \epsilon}^L \frac{\d t_1 \cdots \d t_d}{(4 \pi t_1)^d \cdots (4 \pi t_d)^d} \frac{1}{t_1\cdots t_d} \sum_{i_1,\ldots, i_d} \epsilon_{i_1\cdots i_d} \Bar{w}_{i_1}^{(1)} \cdots \Bar{w}_{i_d}^{(d)} e^{-\sum_{a,b = 1}^d M_{a b} w^{(a)} \cdot \Bar{w}^{(b)}} 
\end{array}
\een

Applying Wick's lemma in the variables $w^{(1)}, \ldots, w^{(d)}$, together with some elementary analytic bounds, we find that the weight above becomes to the following integral over $\CC^d$
\ben
f(L) \int_{w^{(0)} \in \CC^d}  \d^d w^{(0)} \d^d \Bar{w}^{(0)} \sum_{i_1,\ldots, i_d} \epsilon_{i_1\cdots i_d}  
\left(\frac{\partial}{\partial w_{i_1}^{(1)}} \cdots \frac{\partial}{\partial w_{i_d}^{(d)}} \Phi\right)|_{w^{(1)}=\cdots=w^{(d)} = 0} 
\een
where
\ben
f(L) = \lim_{\epsilon \to 0} \int_{t_1,\ldots,t_d = \epsilon}^L \frac{\epsilon}{(\epsilon + t_1 + \cdots + t_d)^{d+1}} \d^d t .
\een
In fact, $f(L)$ is independent of $L$ and is equal to some nonzero constant $C \ne 0$.
Finally, plugging in the forms $\alpha^{(0)}, \ldots, \alpha^{(d)}$, we observe that the integral over $w^{(0)} \in \CC^d$ simplifies to
\ben
C \int_{\CC^d} \alpha^{(0)} \partial \alpha^{(1)} \cdots\partial \alpha^{(d)}
\een
as desired.
\end{proof}

This completes the proof of Proposition \ref{prop: inner anomaly}.

\subsection{Local to global}

In this section we finish the proof of our main result Theorem \ref{thm ggrr} by showing how our local calculation above implies the formula for the anomaly on a general compact affine manifold $X$.
By an complex affine manifold, we mean a quotient 
\ben
q : U \subset \CC^d \to X
\een
of an open subset $U \subset \CC^d$ by a free and proper action of a discrete subgroup of the affine group $U(d) \ltimes \CC^d$. 
We consider affine manifolds that are also compact. 
To deduce our main theorem we will show that the theory and the anomaly above also exhibit equivariance for the affine group on $\CC^d$, thus it will descend to any affine manifold.

We have stated the main result for an arbitrary principal $G$-bundle $P$ on the affine manifold $X$. 
Suppose the discrete subgroup $\Gamma \leq U(d) \ltimes \CC^d$ defines the affine manifold $q : U \to X = U / \Gamma$ as above. 
Then, principal $G$-bundles on $X$ are equivalent to $\Gamma$-equivariant principal $G$-bundles on $U$. 

Let $\sE$ be an arbitrary elliptic complex on $X$, and suppose the Lie algebra $\fh$ acts on $\sE$. 
Since $X$ is compact, the cohomology $H^*(\sE(X))$ is finite dimensional.
It therefore makes sense to define the character of the action of $\fh$ on $H^*(\sE(X))$.
\be\label{superchar}
\chi_\sE : \fh \to \CC \;\; , \;\; M \in \fh \mapsto {\rm STr}_{H^*(\sE(X))} (M) .
\ee
Here, STr denotes the supertrace. 
The character factors through the determinant of the representation.
For the graded character above, we must use the superdeterminant which we denote by $\det (H^*(\sE(X)))$. 
Free BV quantization gives a natural field theoretic interpretation of this determinant.

\begin{prop}[\cite{CG2} Lemma 12.7.0.1] 
Let $\sE$ be any elliptic complex on a compact manifold $X$ and let $T^*[-1] \sE$ be the corresponding free BV theory given by the shifted cotangent bundle. 
Let $\Obs^\q_\sE$ be the factorization algebra of quantum observables of this theory.
Then, there is an isomorphism
\ben
H^* \left(\Obs^\q_{\sE}(X) \right) \cong \det H^*(\sE(X)) [n]
\een
where $n$ is the Euler characteristic of $\sE(X)$ modulo $2$. 
\end{prop}

\begin{rmk}
In \cite{GwilliamHaugseng} they prove that an abstracted version of linear BV quantization behaves like a determinant over formal moduli problems.
An immediate consequence is that given a classical theory with an action of a Lie algebra $\fg$, the BV quantization as we consider produces a line bundle over the moduli space $B \fg$. 
Our calculation of the obstruction produces a calculation in terms of Feynman diagrams of the first Chern class of this line bundle. 
\end{rmk}
 
Notice that the classical free theory $\sE_V$ is equivariant for the affine group $U(d) \ltimes \CC^d$.
Thus, it defines a classical theory on any affine manifold $X$.
This theory is free and of the form
\ben
\sE_V (X) = T^*[-1] (\Omega^{0,*}(X , V))
\een
where $T^*[-1]$ denotes the shifted cotangent bundle.
Thus, the global quantum observables satisfy
\be\label{quantum obs}
H^*(\Obs^\q_{V}(X)) = \det \left(H^*(X, \sO^{hol}) \tensor V \right)
\ee
 
%Similarly, the functional $I^\fg$ is equivariant for the affine group, so that it also descents to a functional on $X$.
%Thus, the Noether current $I^\fg$ defines a \brian{finish}

In Section \ref{sec: classical g equiv} we have showed how the classical theory $\sE_{V}$ has an an action by the local Lie algebra $\sG_X$.
This arose from an action of $\sG(X) = \Omega^{0,*}(X, \fg)$ on the elliptic complex $\Omega^{0,*}(X, V)$. 
At the level of cohomology we have an action of $H^*(\sG(X))$ on $H^*(\Omega^{0,*}(X, V))$ and hence a character $\chi_{V}$ as in Equation (\ref{superchar}) which is an element in $H^*_{red}(\sG(X))$. 

The local Lie algebra cohomology of any local Lie algebra embeds inside its ordinary (reduced) Lie algebra cohomology of global sections $\cloc^*(\sL(X)) \subset \cred^*(\sL(X))$. 
The character (\ref{superchar}) is an element in $H_{red}^*(\sL(X))$.
As an immediate corollary of \cite{CG2} Theorem 12.6.0.1 we have the following relationship between the anomaly cocycle and the character.

\begin{prop}\label{inner char}
Suppose $\sL$ is a local Lie algebra that acts on the elliptic complex $\sE$ on a compact manifold $X$.
Let $\Theta_\sE \in \cloc^*(\sL)$ be the local cocycle measuring the failure to satisfy the $\sL$-equivariant classical master equation (that is, the obstruction to having an inner action).
Then, its global cohomology class satisfies $[\Theta_\sE (X)] = \chi_{\sE} \in \cred^*(\sL(X))$ where $\chi_\sE$ is the trace of the action of $H^*(\sL(X))$ on $H^*(\sE(X))$. 
\end{prop}

%\begin{proof}
%A version of this is proved in Section 7 of \cite{GwilliamThesis}, but we will sketch the proof here.
%\end{proof}

For the case of $\sL = \sG_X$ we have an embedding of cochain complexes
\ben
\cloc^*(\sG(X)) \hookrightarrow \cred^*(\sG(X)) = \cred^*(\Omega^{0,*}(X) \tensor \fg) .
\een
By Kodaira-Spencer theory have already seen that the global sections of the local Lie algebra $\sG(X)$ is a model for the formal neighborhood of the trivial $G$-bundle inside of $G$-bundles. 
In particular, the $\sG(X)$-module of quantum observables defines a line bundle $\int_X \Obs^\q_{\sE_V}$ over this formal neighborhood.
Its character as a $\sG(X)$-module is identified with the first Chern class of the corresponding line bundle $\chi_\sE(\Obs^\q_{V}(X)) = c_1(\int_X \Obs^\q_{V})$. 

Now, notice that the one-loop quantization we constructed in the previous section, as well as the anomaly cocycle $\Theta_V \in \cloc^*(\sG_{\CC^d})$ are equivariant for the group $U(d) \ltimes \CC^d$. 
Thus, they descend to the global sections of $\cloc^*(\sG_X)$ for any affine manifold $X$.
Explicitly, if $\Gamma\subset U(d) \ltimes \CC^d$ is the discrete subgroup such that $X = U / \Gamma$ where $U \subset \CC^d$, then under the isomorphism 
\ben
\cloc^*(\sG(X)) \cong \cloc^*(\sG(U))^\Gamma
\een
we have $\Theta_V(X) \leftrightarrow \Theta_V(U)$.

Further, we have an identification
\ben
\cred^*(\Omega^{0,*}(X) \tensor \fg) = \sO_{red}\left({\rm Bun}_G(X)^{\wedge}_{triv}\right) \cong  \Omega^1_{cl} \left({\rm Bun}_G(X)^{\wedge}_{triv}\right) 
\een
where we have used the equivalence of reduced functions and closed one-forms which makes sense on any formal moduli space.
At the level of $H^1$ we have the composition composition
\be\label{cohbung}
\Sym^{d+1}(\fg^*)^\fg \xto{J^X} H^1_{\rm loc} (\sG(X)) \to H^1(\Omega^1_{cl}\left({\rm Bun}_G(X)^{\wedge}_{triv}\right) .
\ee
As a corollary of Proposition \ref{inner char} and our calculation of the local anomaly cocycle we see that the image of $\ch_{d+1}^\fg(V)$ is equal to $[\Theta_V(X)] = [c_1(\int_X \Obs^\q_V)]$. 

The same holds when we work around any holomorphic principal bundle $P$ on $X$, so that we have an embedding of cochain complexes
\ben
\cloc^*(\sAd(P)(X)) \hookrightarrow  \Omega^1_{cl} \left({\rm Bun}_G(X)^{\wedge}_{P}\right) . 
\een
which determines a composition
\be\label{cohbung}
\Sym^{d+1}(\fg^*)^\fg \xto{J_P^X} H^1_{\rm loc} (\sAd(P)(X)) \to H^1(\Omega^1_{cl}\left({\rm Bun}_G(X)^{\wedge}_{P}\right) .
\ee
Since every principal $G$-bundle $P$ on $X$ is trivial when we pull it back to $U\subset \CC^d$, the above local anomaly calculation proves that $[c_1(\int_X \Obs^\q_{P,V})] = C \ch_{d+1}^\fg (V)$ in this case as well.
This completes the proof of Theorem \ref{thm ggrr}. 

\subsection{A module for the higher Kac-Moody}

The last part of this section we diverge to deduce a consequence of the quantum Noether theorem using our analysis above by exhibiting a module for the higher affine algebras from the previous section. 
For convenience, we fix the trivial $\fg$-bundle $P = {\rm triv}$ so that $\sAd(P) = \sG_X$.

On any manifold $X$, the quantum Noether theorem, Theorem 12.1.0.1 of \cite{CG2}, provides a map of factorization algebras
\ben
\Phi_X : \UU_\alpha (\sG_X) \to \Obs^\q_{V} ,
\een
for some $\alpha \in H^1_{\rm loc}(\sG_X)$.
The factorization algebra $\Obs^\q_V$ is the quantum observables of the $\beta\gamma$ system on $X$ with values in the $\fg$-module $V$. 
This is a free field theory, thus the above map has the flavor of a {\em free field realization} of the Kac-Moody factorization algebra.
In particular when $X = \CC^d$, or any affine manifold, the calculation above shows that there is a map of factorization algebras
\ben
\Phi_{\CC^d} : \UU_{\ch_{d+1}(V)} (\sG_{\CC^d}) \to \Obs^\q_{V} .
\een

Next, consider the case $X = \CC^d \setminus  \{0\}$. 
By functoriality of pushforwards, the quantum Noether theorem produces a map of one-dimensional factorization algebras
\ben
\rho_* \Phi : \rho_* \UU_{\ch_{d+1}(V)} (\sG_{\CC^d \setminus \{0\}}) \to \rho_* \Obs^\q_{V} .
\een
We have exhibited a locally constant dense subfactorization algebra $\sF^{lc}_{1d}$ of $\rho_* \UU_\alpha (\sG_X)$ which is equivalent, as an $E_1$-algebra, to $U \Hat{\fg}_{d, \ch_{d+1}(V)}$. 
Similarly, in Section \ref{sec: sphere ops} we have shown that there is a locally constant dense subfactorization algebra that is equivalent to the dg algebra $\sA_V$. 

The map $\rho_* \Phi$ restricts to these dense subfactorization algebras and so defines a map of $E_1$ algebras
\ben
\rho_* \Phi : U \Hat{\fg}_{d, \ch_{d+1}(V)}\to \sA_V .
\een
Also, in Section \ref{sec: disk module} we have shown how the disk operators $\sV_V$ form a module, through the factorization product, for the dg algebra $\sA_V$. 
This is essentially the Fock module of the algebra $\sA_V$, thus we should view the above map $\rho_*\Phi$ as being a higher dimensional analog of the ``free field realization" for the higher dimensional affine algebras. 

Further, by induction along the map $\rho_* \Phi$, we obtain the following.

\begin{prop}
The map $\rho_*\Phi$ endows the space $\sV_V$ with the structure of a module over the $E_1$-algebra $U \Hat{\fg}_{d, \ch_{d+1}(V)}$.
Equivalently, $\sV_V$ is an $A_\infty$-module for $U \Hat{\fg}_{d, \ch_{d+1}(V)}$. 
\end{prop}

The module $\sV_V$ is the prototype for a higher dimensional version of the vacuum Verma module for ordinary affine algebras. 
It is enticing to construct the higher excitation Verma modules as dg modules for the higher affine algebras we've considered in this thesis.
We do not do that here, but hope to return to it in future work.

\end{document}