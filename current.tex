\section{Lie algebras of currents}

\subsection{Motivational discussion}

\owen{I'm just letting it flow. This paragraph might profitably go elsewhere.}

Our focus in this paper is upon field theories that depend upon complex geometry, 
specifically upon the symmetries they possess.
Our overarching goal is to explain tools for understanding such symmetries that provide a systematic generalization of methods used in chiral conformal field theory on Riemann surfaces,
notably the Kac-Moody vertex algebras.
These tools will use ideas and techniques from the Batalin-Vilkovisky formalism, as articulated by Costello, and factorization algebras, following \cite{CG1,CG2}.
In this subsection, however, we will try to explain the key objects and constructions with a light touch,
in a way that does not require familiarity with that formalism,
merely comfort with basic complex geometry and ideas of quantum field theory.

\subsubsection{}

A running example is the following version of the $\beta\gamma$ system.

Let $X$ be a complex $d$-dimensional manifold.
Let $G$ be a complex algebraic group, such as $GL_n(\CC)$, 
and let $P \to X$ be a holomorphic principal $G$-bundle.
Fix a finite-dimensional $G$-representation $V$ and let $V^*$ denote the dual vector space with the natural induced $G$-action.
Let $\cV \to X$ denote the holomorphic associated bundle $P \times^G V$, 
and let $\cV^! \to X$ denote the holomorphic bundle $K_X \otimes \cV^*$,
where $\cV^* \to X$ is the holomorphic associated bundle $P \times^G V^*$.
Note that there is a natural fiberwise pairing
\[
\langle-,-\rangle: \cV \otimes \cV^! \to K_X
\]
arising from the evaluation pairing between $V$ and~$V^*$.

The field theory involves fields $\gamma$, for a smooth section of $\cV$, and $\beta$, for a smooth section of $\cV^!$.
\owen{I need to adjust where $\beta$ lives in a way depending on dimension $d$.}
The action functional is
\[
S(\beta,\gamma) = \int_X \langle \beta, \dbar \gamma \rangle,
\]
so that the equations of motion are
\[
\dbar \gamma = 0 = \dbar \beta.
\]
Thus, the classical theory is manifestly holomorphic: it picks out holomorphic sections of $\cV$ and $\cV^!$ as solutions.

The theory also enjoys a natural symmetry with respect to $G$,
arising from the $G$-action on $\cV$ and $\cV^!$.
For instance, if $\dbar \gamma = 0$ and $g \in G$, then the section $g \gamma$ is also holomorphic.
In fact, there is a local symmetry as well.
Let $\ad(P) \to X$ denote the Lie algebra-valued bundle $P \times^G \fg \to X$ arising from the adjoint representation $\ad(G)$.
Then a holomorphic section $f$ of $\ad(P)$ acts on a holomorphic section $\gamma$ of $\cV$,
and 
\[
\dbar(f \gamma) =  (\dbar f) \gamma + f \dbar \gamma = 0,
\]
so that the sheaf of holomorphic sections of $\ad(P)$ encodes a class of local symmetries of this classical theory.

\subsubsection{}

If one takes a BV/BRST approach to field theory, as we will in this paper,
then one works with a cohomological version of fields and symmetries.
For instance, it is natural to view the classical fields as consisting of the graded vector space of Dolbeault forms
\[
\gamma \in \Omega^{0,*}(X,\cV) \quad \text{and} \quad \beta \in \Omega^{0,*}(X, \cV^!) \cong \Omega^{d,*}(X, \cV^*),
\]
but using the same action functional, extended in the natural way.
As we are working with a free theory and hence have only a quadratic action,
the equations of motion are linear and can be viewed as equipping the fields with the differential $\dbar$.
In this sense, the sheaf $\cE$ of solutions to the equations of motion can be identified with the elliptic complex that assigns to an open set $U \subset X$, the complexe
\[
\cE(U) = \Omega^{0,*}(U,\cV) \oplus \Omega^{0,*}(U, \cV^!),
\]
with $\dbar$ as the differential.
This dg approach is certainly appealing from the perspective of complex geometry,
where one routinely works with the Dolbeault complex of a holomorphic bundle.

It is natural then to encode the local symmetries in the same way.
Let $\cAd(P)$ denote the Dolbeault complex of $\ad(P)$ viewed as a sheaf.
That is, it assigns to the open set $U \subset X$, the dg Lie algebra 
\[
\cAd(P)(U) = \Omega^{0,*}(U,\ad(P))
\]
with differential $\dbar$ for this bundle.
By construction, $\cAd(P)$ acts on $\cE$.
In words, $\cE$ is a sheaf of dg modules for the sheaf of dg Lie algebra~$\cAd(P)$.

\subsubsection{}

So far, we have simply lifted the usual discussion of symmetries to a dg setting,
using standard tools of complex geometry.
We now introduce a novel maneuver that is characteristic of the BV/factorization package of~\cite{CG1,CG2}.

The idea is to work with compactly supported sections of $\cAd(P)$, 
i.e., to work with the precosheaf $\cAd(P)_c$ of dg Lie algebras that assigns to an open $U$,
the dg Lie algebra
\[
\cAd(P)_c(U) = \Omega^{0,*}_c(U,\ad(P)).
\]
The terminology {\em precosheaf} encodes the fact that there is natural way to extend a section supported in $U$ to a larger open $V \supset U$ (namely, extend by zero),
and so one has a functor $\cAd(P) \colon {\rm Opens}(X) \to {\rm Alg}_{\rm Lie}$.

There are several related reasons to consider compact support.\footnote{In Section \ref{sec: fact} we extract factorization algebras from $\cAd(P)_c$,
and then extract associative and vertex algebras of well-known interest.
We postpone discussions within that framework till that section.}
First, it is common in physics to consider compactly-supported modifications of a field.
Recall the variational calculus, where one extracts the equations of motion by working with precisely such first-order perturbations.
Hence, it is natural to focus on such symmetries as well.
Second, one could ask how such compactly supported actions of $\cAd(P)$ affect observables.
More specifically, one can ask about the charges of the theory with respect to this local symmetry.\footnote{We remark that it is precisely this relationship with traditional physical terminology of currents and charges that led de Rham to use {\em current} to mean a distributional section of the de Rham complex.}
Third---and this reason will become clearer in a moment---the anomaly that appears when trying to quantize this symmetry are naturally local in $X$, and hence it is encoded by a kind of Lagrangian density $L$ on sections of $\cAd(P)$.
Such a density only defines a functional on compactly supported sections,
since when evaluated a noncompactly supported section $f$, the density $L(f)$ may be non-integrable.
Thus $L$ determines a central extension of $\cAd(P)_c$ as a precosheaf of dg Lie algebras,
but not as a sheaf.\footnote{We remark that to stick with sheaves, one must turn to quite sophisticated tools \cite{WittenGr,GetzlerGM,ManBeilSch} that can be tricky to interpret, much less generalize to higher dimension, whereas the cosheaf-theoretic version is quite mundane and easy to generalize, as we'll see.}

\subsubsection{}

Let us sketch how to make these reasons explicit.
The first step is to understand how $\cAd(P)_c$ acts on the observables of this theory.

Modulo functional analytic issues,
we say that the observables of this classical theory are the commutative dg algebra
\[
(\Sym(\Omega^{0,*}(X,\cV)^* \oplus \Omega^{0,*}(X, \cV^!)^*), \dbar),
\]
i.e., the polynomial functions on $\cE(X)$.
More accurately, we work with a commutative dg algebra essentially generated by the continuous linear functionals on $\cE(X)$, 
which are compactly supported distributional sections of certain Dolbeault complexes ({\it aka} Dolbeault currents).
We could replace $X$ by any open set $U \subset X$, 
in which case the observables with support in $U$ arise from such distributions supported in $U$.
We denote this commutative dg algebra by $\Obs^{cl}(U)$.
Since observables on an open $U$ extend to observables on a larger open $V \supset U$,
we recognize that $\Obs^{cl}$ forms a precosheaf.

Manifestly, $\cAd(P)_c(U)$ acts on $\Obs^{cl}(U)$,
by precomposing with its action on fields.
Moreover, these actions are compatible with the extension maps of the precosheaves,
so that $\Obs^{cl}$ is a module for $\cAd(P)_c$ in precosheaves of cochain complexes.
This relationship already exhibits why one might choose to focus on $\cAd(P)_c$,
as it naturally intertwines with the structure of the observables.

But Noether's theorem provides a further reason,
when understood in the context of the BV formalism.
The idea is that $\Obs^{cl}$ has a Poisson bracket $\{-,-\}$ of degree 1
(although there are some issues with distributions here that we suppress for the moment).
Hence one can ask to realize the action of $\cAd(P)_c$ via the Poisson bracket.
In other words, we ask to find a map of (precosheaves of) dg Lie algebras
\[
J \colon \cAd(P)_c \to \Obs^{cl}[-1]
\]
such that for any $f \in \cAd(P)_c(U)$ and $F \in \Obs^{cl}(U)$,
we have
\[
f \cdot F = \{J(f),F\}.
\]
Such a map would realize every symmetry as given by an observable,
much as in Hamiltonian mechanics.

In this case, there is such a map:
\[
J(f)(\gamma,\beta) = \int_U \langle\beta, f \gamma\rangle.
\]
This functional is local, and it is natural to view it as describing the ``minimal coupling'' between our free $\beta\gamma$ system and a kind of gauge field implicit in $\cAd(P)$.
\owen{This is a little misleading, given the nature of the forms, but I think it is fixable.}
This construction thus shows again that it is natural to work with compactly supported sections of $\cAd(P)$,
since it allows one to encode the Noether map in a natural way.
We call $\cAd(P)_c$ the Lie algebra of {\em classical currents} as we have explained how, via $J$, we realize these symmetries as classical observables.

\begin{rmk}
We remark that it is not always possible to produce such a Noether map,
but the obstruction always determines a central extension of $\cAd(P)_c$ as a precosheaf of dg Lie algebras,
and one can then produce such a map to the classical observables.
\end{rmk}

\subsubsection{}

In the BV formalism, quantization amounts to a deformation of the differential on $\Obs^{cl}$,
where the deformation is required to satisfy certain properties.
Two conditions are preeminent:
\begin{itemize}
\item the differential satisfies a {\em quantum master equation}, which ensures that $\Obs^q(U)[-1]$ is still a dg Lie algebra via the bracket,\footnote{Again, we are suppressing---for the moment important---issues about renormalization, which will play a key role when we get to the real work.} and
\item it respects support of observables so that $\Obs^q$ is still a precosheaf.
\end{itemize}
The first condition is more or less what  BV quantization means, 
whereas the second is a version of the locality of field theory.

We can now ask whether the Noether map $J$ determines a map of precosheaves of dg Lie algebras from $\cAd(P)_c$ to $\Obs^q[-1]$.
Since the Lie bracket has not changed on the observables, 
the only question is where $J$ is a cochain map for the new differential $\d^q$
If we write $\d^q = \d^{cl} + \hbar \Delta$,\footnote{By working with smeared observables, one really can work with the naive BV Laplacian $\Delta$. Otherwise, one must take a little more care.} then 
\[
[\d,J] = \hbar \Delta \circ J.
\]
Naively---i.e., ignoring renormalization issues---this term is the functional $ob$ on $\cAd(P)_c$ given 
\[
ob(f) = \int \langle f K_\Delta \rangle,
\]
where $K_\Delta$ is the integral kernel for the identity with respect to the pairing $\langle-,-\rangle$.
(It encodes a version of the trace of $f$ over $\cE$.)
This obstruction should resemble standard anomalies.
\owen{Is that transition too abrupt? Should we provide an example?}

This functional $ob$ is a cocycle in Lie algebra cohomology for $\cAd(P)$ and hence determines a central extension $\widehat{\cAd(P)}_c$ as precosheaves of dg Lie algebras.
It is the Lie algebra of {\em quantum} currents, as there is a lift of $J$ to a map $J^q$ out of this extension to the quantum observables.

\subsection{Definitions}

We now introduce some definitions that aim to capture the abstract structure of the example just discussed.

\subsubsection{}

It will be convenient to generalize Lie algebras to $L_\infty$ algebras,
which involve multilinear brackets that satisfy higher versions of the Jacobi relation up to homotopy.

\owen{Just wanted to mention that your original definition of local Lie algebra was a little misleading, because it used $n \in \ZZ$ (not just positive integers) and said $\ell_n: \sL^{\otimes n} \to \sL[2-n]$. This tensor product might mislead people into thinking you mean tensor of sheaves of $C^\infty$-modules, which isn't correct. }

\begin{dfn} 
A {\em local $L_\infty$ algebra} on $X$ is the following data:
\begin{itemize}
\item[(i)] a $\ZZ$-graded vector bundle $L$ on $X$, whose sheaf of smooth sections we denote $\sL^{sh}$, and
\item[(ii)] for each positive integer $n$, a polydifferential operator in $n$ inputs
\ben
\ell_n : \underbrace{\sL^{sh} \times \cdots \times \sL^{sh}}_{\text{$n$ times}} \to \sL[2-n]
\een
\end{itemize}
such that the collection $\{\ell_n\}_{n \in \NN}$ satisfy the conditions of an $L_\infty$ algebra.
Thus, $\sL^{sh}$ is a sheaf of $L_\infty$ algebras. 
\end{dfn}

In practice, we prefer to work with the compactly supported sections of $L$,
as explained in \owen{cross ref}, for which we reserve the more succinct notation~$\sL$.

\begin{dfn}
Given a local $L_\infty$ algebra $(L, \{\ell_n\})$ on $X$, 
let $\sL$ denote the precosheaf of $L_\infty$ algebras that assigns compactly supported sections of $L$ to each open of~$X$.
\end{dfn}

We typically refer to the local $L_\infty$ algebra $(L, \{\ell_n\})$ by $\sL$. 
We will often use local {\em Lie} algebra, especially if $\sL$ is a precosheaf of dg Lie algebras and hence has trivial~$\ell_{n \geq 3}$.

\begin{eg}
Our favorite example, of course, arises from the adjoint bundle $\ad(P) \to X$ associated to a holomorphic principal $G$-bundle $P \to X$. 
We will hereafter use $\cAd(P)$ to denote the compactly supported sections of Dolbeault complex of $\ad(P)$.
\owen{Is that too confusing?}
\end{eg}

\begin{eg}
Another key local Lie algebra makes sense on an arbitrary complex $d$-fold.
Let $\fg$ be an ordinary Lie algebra, such as ${\frak{s}\frak{l}}_n$.
Let
\[
\sG^{sh} = \Omega^{0,*} \otimes \fg,
\]
which is a sheaf of dg Lie algebras on the category of complex $d$-folds and local biholomorphisms,\footnote{A biholomorphism is a map $\phi: X \to Y$ that is biijective and both $\phi$ and $\phi^{-1}$ are holomorphic. A {\em local} biholomorphism means a map $\phi: X \to Y$ such that for every point $x \in X$ has a neighborhood on which $\phi$ is a biholomorphism.
\owen{Not sure what you think of burying this in a footnote, but it seems tangential and not worth elaborating on in the main text.}}
and $\sG$ to denote $\Omega^{0,*}_c \otimes \fg$.
We use $\sG|_X$ to denote the restriction of $\sG$ to a fixed complex $d$-fold~$X$.
\end{eg}

\subsubsection{}

We are interested in a certain class of central extensions of such an~$\sL$.

\begin{dfn}
A {\em local functional} on $\sL$ of cohomological degree $k$ is \owen{yuck} 
\end{dfn}

The graded vector space of local functionals is a subcomplex of $\clie^*(\sL)$, 
the naive Lie algebra cochains of $\sL$.
Let $\cloc^*(\sL)$ denote this cochain complex, as explained in detail in \owen{give precise citation}.
The differential is, in essence, just precomposition with the polydifferentials defining the brackets of~$\sL$.\footnote{Altogether $\cloc^*(\sL)$ is just a version of diagonal Gelfand-Fuks cohomology for this kind of Lie algebra.} 

\begin{dfn}
A cocycle $\theta$ of degree $2+k$ in $\cloc^*(\sL)$ determines a {\em $k$-shifted central extension}
\be\label{kext}
0 \to \CC[k] \to \Hat{\sL}_\theta \to \sL \to 0
\ee
of precosheaves of $L_\infty$ algebras,
where
\[
\Hat{\ell}_n(x_1,\ldots,x_n) = (\ell_n(x_1,\ldots,x_n), \theta(x_1,\ldots,x_n)).
\]
\end{dfn}

Cohomologous cocycles determine quasi-isomorphic extensions. 

\begin{eg}
Let $X$ be a Riemann surface, i.e., a complex $1$-fold, and let $\fg$ be a simple Lie algebra with Killing form $\kappa$.
Consider the local Lie algebra $\sG|_X$.
There is a natural cocycle depending precisely on two inputs:
\[
\theta( \alpha \otimes x, \beta \otimes y) = \kappa(x,y) \, \int_X \alpha \wedge \partial \beta  ,
\]
where $\alpha, \beta \in \Omega^{0,*}_c(X)$ and $x,y \in \fg$.
As explained in \owen{cross ref} and Section ??? of \cite{CG1},
this cocycle determines an affine Kac-Moody algebra extending the loop algebra $L\fg = \fg[z,z^{-1}]$.
\end{eg}

Much of the rest of the section is devoted to constructing and analyzing various cocycles and extensions.

\subsubsection{}

There is a particular family of local cocycles that has special importance for us and
that generalizes the preceding example.

Let $p$ be an invariant polynomial on $\fg$ of homogenous degree $d+1$. 
That is, $p$ is an element of $\Sym^{d+1}(\fg^\vee)^\fg$. 
We can extend $p$ to a functional $J(p)$ on $\sG(X) = \Omega^{0,*}_c(X) \tensor \fg$ by the formula
\[
J(p) (\omega_1 \tensor x_1,\ldots,\omega_{d+1} \tensor x_{d+1}) = p(x_1,\ldots,x_{d+1}) \int_X \omega_1\wedge \partial \omega_2 \cdots \wedge \partial \omega_{d+1}.
\]
Note that we use $d$ copies of the holomorphic derivative $\partial: \Omega^{0,*} \to \Omega^{1,*}$ to obtain an element of $\Omega^{d,*}_c$ in the integrand (and hence something that has a chance of being integrated).

This formula clearly makes sense for any complex $d$-fold $X$, 
and since integration is local on $X$, 
it intertwines nicely with the structure maps of~$\sG$.

\begin{prop}\label{prop j map} 
The assignment
\ben
J : \Sym^{d+1} (\fg^\vee)^\fg [-1] \to \cloc^*(\sG)
\een
is a cochain map. Moreover, it is injective at the level of cohomology. 
\end{prop}

\owen{Need to prove it.}

\owen{We have another notational challenge here. For a fixed manifold $X$, one can talk about the local cochains $\cloc^*(\sG|_X)$, but we don't yet say what we mean by the thing that works on all $d$-folds simultaneously. If one takes a little care, it is a sheaf on that site, but I'm not sure we should do all that heavy lifting in this section.}

\subsection{The sphere Lie algebras, or FHK current algebras}

Our goal in this section is to develop a higher-dimensional analogue of the loop algebra $L\fg = \fg[z,z^{-1}]$ and its central extensions.
As the title might suggest, the analogue explored in this section has been developed substantially by Faonte-Hennion-Kapranov \cite{FHK},
and our treatment will bear a strong imprint from their approach.
For further discussion on their work and its connection with ours,
see Remark \ref{} and Section~\ref{sec: cf with FHK}.

One common approach is to take iterated loops (and we discuss that direction \owen{somewhere else}), 
but a different natural generalization is to generalize the circle $S^1$ by the sphere $S^{2d-1}$.
That is, we work with a ``sphere algebra'' of maps from $S^{2d-1}$ into $\fg$.
For topologists, this direction might seem natural,
but it may not seem too natural from the perspective of algebraic geometry.
In particular, an algebro-geometric sphere is given by a punctured affine $d$-space $\dAA^d = \AA^d \setminus \{0\}$ or a punctured formal $d$-disk,
but every map from these spaces to $\fg$ extends to a map from $\AA^d$ or the formal $d$-disk into $\fg$ (essentially, by Hartog's lemma).
Thus, this direction seems fruitless.
The key to evading this issue is to work with the derived space of maps,
since the derived sections of $\cO$ on the punctured affine $d$-space is interesting.

This fact ought not to be too surprising: 
as a smooth manifold, punctured affine $d$-space is equivalent to $\RR_{> 0} \times S^{2d-1}$,
and this equivalence manifests itself in the cohomology of the structure sheaf.
Explicitly,
\[
H^*(\dAA^d, \cO_{alg}) = 
\begin{cases} 0, & * \neq 0, d-1 \\ \CC[z_1,\ldots,z_d], & * = 0 \\ \CC[z_1^{-1},\ldots,z_d^{-1}] \frac{1}{z_1 \cdots z_d}, & * = d-1 \end{cases}
\]
as one can show by direct computation (e.g., use the cover by the affine opens of the form $\AA^d \setminus \{z_i =0\}$).
When $d = 1$, this recovers the usual Laurent series;
and it is natural to view the above as the higher-dimensional analogue of the Laurent series,
with the polar part now in degree~$d-1$.

Hence, the derived global sections $\RR\Gamma(\dAA^d,\cO)$ of $\cO$ provide a homotopy-commutative algebra,
and thus one obtains a homotopy-Lie algebra by tensoring with $\fg$,
which we will call the sphere Lie algebra by analogy with the loop Lie algebra.
One can then study central extensions of this homotopy-Lie algebra,
which are analogous to the affine Kac-Moody Lie algebras.
For explicit constructions, it is convenient to have a commutative dg algebra that models the derived global sections.
It should be no surprise that we like to work with the Dolbeault complex.
We will use this approach to relate the sphere Lie algebra and its extensions to the current algebras that we've already introduced.

\begin{rmk}
We strongly encourage the reader to examine the seminal work \cite{FHK},
as it puts these constructions into a clear geometric context and offers a systematic generalization in derived algebraic geometry of the rich, fruitful relationship between affine Kac-Moody algebras and the moduli of $G$-bundles on algebraic curves.
Indeed, for us, the lack of such an interpretation was a long-standing conceptual obstacle,
as we had found these higher extensions and the action of these current algebras on holomorphic field theories by direct computation;
but we did not have the toolkit to understand them in derived geometry.
In turn we hope our work here helps derived geometers recognize how such constructions fit into field theory.
\end{rmk}

\subsubsection{Compactification along the sphere}

\subsubsection{Comparison with the FHK approach}
\label{sec: cf with FHK}

We use the punctured algebraic disk $D^{1\times} = {\rm Spec} \;  \CC [z,z^{-1}]$, but the definition also makes sense for the puncture formal disk (formal loops). 

Let $D^d = {\rm Spec} \; \CC[z_1,\ldots, z_d]$ be the $d$-dimensional algebraic disk.
The punctured $d$-disk is no longer affine, in fact its cohomology is given by
\ben
H^*(D^{d \times}, \sO) = 
\een
Instead of working with the naive commutative algebra $\Gamma(D^{d \times}, \sO)$ we will use the dg commutative algebra of {\em derived} sections $\RR \Gamma(D^{d \times}, \sO)$. 
An explicit model for this has been written down in \cite{FHK} based on the Jouanolou method for resolving singularities. 
We recall its definition.

\begin{dfn} 
Let $A_d$ be the commutative dg algebra generated by elements $$z_1,\ldots,z_d, z_1^*,\ldots,z_d^*, (z_1 z_1^*)^{-1}, \ldots (z_1z_d^*)^{-1}$$ in degree zero and $$\d z_1,\ldots , \d z_d, \d z_1^*,\ldots, \d z_d^*$$ in degree one.
Introduce a $*$-weight, so that $z_i^*, \d z_i^*$ have $*$-weight $+1$ and $(z_i^*)^{-1}$ has $*$-weight $-1$.
We require that:
\begin{itemize}
\item[(i)] every element is of total $*$-weight zero and
\item[(ii)] the contraction of every element with the Euler vector field $\sum_{i} z_i^* \partial_{z_{i}^*}$ vanishes.
\end{itemize}
\end{dfn}

The key properties of the dg algebra $A_d$ we will utlilize are summarized in the following result of~\cite{FHK}.

\begin{prop}[\cite{FHK} Proposition 1.3.1]
The commutative dg algebra $A_d$ is a model for $\RR \Gamma(D^{d\times}, \sO)$. 
Moreover, there is a dense map of commutative dg algebras
\ben
j : A_d \to \Omega^{0,*}(\CC^d \setminus 0) 
\een
sending $z_i \mapsto z_i$, $z_i^* \mapsto \Bar{z}_i$, and $\d z_i^* \mapsto \d \zbar_i$.
\end{prop}

We are interested in the dg Lie algebra $A_d \tensor \fg$. 
In \cite{FHK} they show, via knowledge of the Lie algebra cohomology, that there is a central extension of this \brian{not sure what to say}

\begin{dfn} 
Fix an element $\theta \in \Sym^{d+1}(\fg)^{\fg}$. 
Let $\Hat{\fg}_{d,\theta}$ be the dg Lie algebra central extension of $A_d \tensor \fg$ determined by the degree two cocycle $\theta_{\rm FHK} \in \clie^*(A_d \tensor \fg)$ defined by
\ben
\theta_{\rm FHK}(a_0\tensor X_0,\dots,a_d\tensor X_d) = \Reszero \left(a_0 \wedge \d a_1 \wedge \cdots \wedge \d a_d \right) \theta(X_0,\ldots,X_d)
\een
where $a_i \tensor X_i \in A_d \tensor \fg$. 
\end{dfn}






\subsection{Dimension $d$ extensions via Gelfand-Kazhdan geometry}

\owen{Commented out is the earlier stuff about local Lie algebras, to be cannabalized}

%\subsection{Local Lie algebras and factorization}
%
%\subsubsection{A recollection of local Lie algebras} 
%
%\begin{dfn} A {\em local Lie algebra} (or {\em local $L_\infty$ algebra}) on $X$ is the following data:
%\begin{itemize}
%\item[(i)] a $\ZZ$-graded vector bundle $L$ on $X$, with sheaf of sections that we denote $\sL$;
%\item[(ii)] for each $n \in \ZZ$ a polydifferential operator 
%\ben
%\ell_n : \sL^{\tensor n} \to \sL[2-n];
%\een
%\end{itemize}
%such that the collection $\{\ell_n\}$ endow $\sL$ with the structure of a sheaf of $L_\infty$ algebras. 
%\end{dfn}
%
%We often refer to a local Lie algebra $(L, \{\ell_n\})$ simply by its sheaf of sections $\sL$. A local Lie algebra defines the sheaf of complexes $\clieu_*(\sL)$ that sends an open set $U \subset X$ to the complex $\clieu_*(\sL(U))$. Note that $\clieu_*(\sL)$ is itself the sheaf of sections of a graded vector bundle and that it has the structure of a sheaf of cocommutative coalgebras. 
%
%\begin{dfn} A map $f : \sL \to \sL'$ of local Lie algebras on $X$ is a polydifferential operator 
%\ben
%f : \clieu_*(\sL) \to \clieu_*(\sL')
%\een
%that is, in addition, a map of sheaves of cocommutative coalgebras. 
%\end{dfn}
%
%\subsubsection{Universal objects}
%
%\def\CplxMan{{\rm CplxMan}}
%\def\Hol{{\rm Hol}}
%\def\VB{{\rm VB}}
%
%Let $\CplxMan$ be the category of complex manifolds with holomorphic maps. There is a fibered category $\VB$ of holomorphic vector bundles over $\CplxMan$. Likewise, there is a category of local Lie algebras fibered over $\CplxMan$. Its objects are pairs $(X,L)$ consisting of a complex manifold $X$ together with a local Lie algebra $L$ on $X$. Maps between $(f,F) : (X,L) \to (X',L')$ is a holomorphic map $f : X \to X'$ together with a map of local Lie algebras on $X$, $F : L \to f^*L'$.
%...
%
%Given a local Lie algebra with underlying $\ZZ$-graded vector bundle $L$ we can consider both its sheaf of sections $\sL$. This has the structure of a sheaf of $L_\infty$ algebras. We can also consider its cosheaf of compactly supported sections, that we denote $\sL_c$. The cosheaf of compactly supported sections is not, however, a cosheaf of Lie algebras. It does, however, have a certain ``factorization" property that we will exploit to define factorization algebras on the underlying manifold. 
%
%\begin{dfn} A {\em prefactorization Lie algebra} $\sG$ on a manifold $X$ is the data:
%\begin{itemize}
%\item[(i)] for each open set $U \subset X$ an $L_\infty$ algebra $\sG(U)$;
%\item[(ii)] for each pairwise disjoint collection of open sets $U_1,\ldots,U_n$ contained inside some open set $V \subset X$ a map of $L_\infty$ algebras
%\ben
%\sG(U_1) \oplus \cdots \oplus \sG(U_n) \to \sG(V) .
%\een 
%\end{itemize} 
%\end{dfn}
%There is a symmetric monoidal structure on the category of $L_\infty$ algebras $\Lcat$ given by the direct sum $\oplus$ of underlying chain complexes. Thus, a prefactorization Lie algebra is simply a symmetric monoidal functor
%\ben
%\sG : {\rm Op}(X)^{\sqcup} \to \Lcat^{\oplus} .
%\een
%In particular, $\sG$ is a precosheaf of $L_\infty$ algebras. 
%
%In the holomorphic setting the above definition makes sense in a wider context, where we consider all complex manifolds of a fixed dimension uniformly. 
%
%\begin{dfn} A {\em universal holomorphic prefactorization Lie algebra} of dimension $d$ is a symmetric monoidal functor
%\ben
%\sG: {\rm Hol}^{\sqcup}_d \to \Lcat^{\oplus}
%\een
%from the symmetric monoidal category of holomorphic manifolds with embeddings equipped with disjoint union to the category of $L_\infty$ algebras equipped with direct sum.
%\end{dfn}
%
%Just like in the case of factorization algebras, we have the following definition. 
%
%\begin{dfn} A {\em factorization Lie algebra} on $X$ is a prefactorization Lie algebra satisfying descent for Weiss covers on $X$. Likewise, a {\em universal holomorphic factorization Lie algebra} is a universal holomorphic prefactorization Lie algebra satisfying descent for Weiss covers in $\Hol_d$. 
%\end{dfn}
%
%Local Lie algebras provide a nice class of factorization Lie algebras. 
%
%\begin{lem} Suppose $L$ is a local Lie algebra on $X$. Then the precosheaf of compactly supported sections $\sL_c$ is a factorization Lie algebra on $X$. Similarly, if $L$ is a universal holomorphic local Lie algebra then its functor of compactly supported sections $\sL_c$ is a universal holomorphic factorization Lie algebra.
%\end{lem}
%
%We briefly elaborate by what we mean by the compactly supported sections of a universal local Lie algebra $L$. Such an object determines a functor
%\ben
%\sL_c : \Hol_d \to \Lcat
%\een
%defined by sending a complex $d$-fold $X$ to the space of compactly supported sections of the bundle $L(X)$. This has the structure of an $L_\infty$ algebra by definition. Given a holomorphic embedding $f : X \to Y$ one defines the map
%\ben
%f_c : \sL_c(X) \to \sL_c(Y)
%\een
%by \brian{finish}...
%
%Given a Lie algebra $\fg$ one can define the cocoummutative coalgebra $\clieu_*(\fg)$ of Chevalley--Eilenberg chains. 
%This is the cochain complex computing Lie algebra homology. 
%
%From a factorization Lie algebra, we construct a factorization algebra in a similar way.
%We show that the construction also works to define, from universal Lie algebras, universal factorization algebras. Much of this section is a recollection of  the material in Section 3.6 of \cite{fact1}.
%
%\begin{lem} Suppose $\sG$ is a factorization Lie algebra on $X$. Then, the assignment 
%\ben
%\clieu_*(\sG) : U \mapsto \clieu_*(\sG(U))
%\een
%defines a factorization algebra on $X$. 
%If $\sG$ is a universal holomorphic factorization Lie algebra then $\clieu_*(\sG)$ defines a universal holomorphic factorization algebra. 
%\end{lem}
%
%\subsection{The Kac--Moody factorization algebra}
%
%In this section we introduce the local Lie algebra that will be the main focus of the paper. The local Lie algebra will be defined on any complex manifold and is constructed using the data of a Lie algebra $\fg$. For most of this paper we will assume that we have an ordinary Lie algebra, but a very slight generalization can be used to handle dg Lie or $L_\infty$ algebras. 
%
%Fix a complex manifold $X$ of complex dimension $d$. The complex structure determines a splitting of the tangent bundle $TX = TX^{1,0} \oplus TX^{0,1}$ into its holomorphic and anti-holomorphic sub-bundles. Likewise, the cotangent bundle splits as $T^*X = TX^{1,0} \oplus TX^{0,1}$. Define the following $\ZZ$-graded vector bundle on $X$
%\ben
%\fg(X) := \wedge^* T^*X^{0,1} \tensor \ul{\fg} = \oplus_{i =0}^d \wedge^{i} T^*X^{0,1} [-i] 
%\een
%where $\ul{\fg}$ denotes the trivial vector bundle on $X$ with fiber $\fg$. The differential operator $\dbar$ on $X$ extends to a degree one operator on $\fg(X)$. On the $i$th graded piece it is defined by
%\ben
%\dbar \tensor \id_\fg : \wedge^{i} T^*X^{0,1} \tensor \ul{\fg} \to \wedge^{i+1} T^*X^{0,1} \tensor \ul{\fg} .
%\een
%The Lie bracket on $[-,-]_{\fg} $ on $\fg$ extends to a polydifferential operator on $\fg(X)$ of degree zero 
%\ben
%[-,-] := \wedge \tensor [-,-]_{\fg} :  \left(\wedge^i T^*X^{0,1} \tensor \ul{\fg}\right) \tensor \left(\wedge^j T^*X^{0,1} \tensor \ul{\fg}\right) = \left(\wedge^i T^*X^{0,1} \tensor \wedge^j T^*X^{0,1}\right) \tensor (\ul{\fg} \tensor \ul{\fg}) \to \wedge^{i+j} T^*X^{0,1} \tensor \ul{\fg} .
%\een
%Here $\wedge$ denotes the wedge product of differential forms. The sheaf of sections of $\wedge^{i} T^*X^{0,1}$ is denoted $\Omega^{0,*}_X$ and we write the sheaf of sections of $\fg(X)$ as $\fg^X = \Omega^{0,*}_X \tensor \fg$.
%
%\begin{dfn/lem} The $\ZZ$-graded bundle $\fg(X)$ together with the polydifferential operators $\dbar, [-,-]$ determine the structure of local Lie algebra on $X$.  We call $\fg(X)$, or its sheaf of sections $\fg^X$, the {\em holomorphic $\fg$-current algebra} on $X$. 
%\end{dfn/lem}
%\begin{proof} It suffices to show that $\fg^X$ is a presheaf of dg Lie algebras. For each open $U \subset X$ 
%the restriction of the polydifferential operators $\dbar$ and $[-,-]$ to the vector space $\fg^X(U)$ coincides with structure of a dg Lie algebra obtained by tensoring the dg commutative algebra $\Omega^{0,*}(U)$ with the Lie algebra $\fg$. Now, if $U \hookrightarrow V$ is an inclusion of open sets we need to show that the induced map $\Omega^{0,*}(V) \tensor \fg \to \Omega^{0,*}(U) \tensor \fg$ is a map of dg Lie algebras. This follows from the general fact that if $f : A \to B$ to is a map of commutative dg algebras then the induced map $f \tensor \id_{\fg} : A \tensor \fg \to B \tensor \fg$ is a map of dg Lie algebras (where the dg Lie structure on $A \tensor \fg$ and $B \tensor \fg$ is the one mentioned above). 
%\end{proof}
%
%\begin{rmk} 
%The sheaf of dg Lie algebras $\fg^X$ has the following geometric description.
%Any dg Lie algebra $\fh$ can be interpreted as a formal moduli problem $B \fh$. 
%If $U \subset X$ is an open set, the dg Lie algebra $\fg^X(U)$ describes the formal neighborhood of the trivial bundle inside the moduli space of holomorphic $G$-bundles on $X$ that are trivialized away from $U$. 
%In particular, $\fg^X(X)$ describes the moduli space of holomorphic $G$-bundles on $X$.
%Suppose $\alpha \in \fg^X(X)$ is a Maurer--Cartan element.
%That is, $\alpha$ is a $\fg$-valued $(0,1)$-form satisfying the Maurer--Cartan equation $\dbar \alpha  + \frac{1}{2}[\alpha, \alpha] = 0$.
%We obtain a connection on the trivial $G$-bundle of the form $\dbar + \alpha$. 
%In fact, all first order deformations of the trivial $G$-bundle are of this form.
%The gauge transformations are of the form $\alpha \mapsto \alpha + \dbar \lambda + [\lambda, \alpha]$ where $\lambda : X \to \fg$ is a smooth map. 
%In general $H^2_{\rm Lie} (\fg^X(X))$ is non-trivial, except when $d=1$ in which it vanishes for degree reasons.
%This reflects the possibility for obstructions to first-order deformations of the trivial bundle. 
% 
%The work in \cite{FHK} has made this perspective precise in general complex dimension by giving a derived model for the moduli space of $G$-bundles.
%They show that the cohomology of the shifted tangent space at the trivial bundle is the $\dbar$-cohomology of $\fg^X(X)$:
%\ben
%H^*\left(T_{triv} {\rm Bun}_G(X)\right) [-1] \cong H^*_{\dbar}(\fg^X(X)) = H^*(X , \sO^{hol}) \tensor \fg
%\een
%as graded Lie algebras.
%\end{rmk}
%
%Given the local Lie algebra $\fg(X)$ we obtain a factorization Lie algebra on $X$ by considering its compactly supported sections $\fg_c^X : U \subset X \mapsto \Omega^{0,*}_c(U) \tensor \fg$. 
%
%The local Lie algebra $\fg(X)$ makes sense on any complex manifold and is functorial in the universal sense discussed above. That is, we have a bundle $\fg(-)$ on the category of all complex dimensional $d$-folds. Thus, its compactly supported sections restricted to the subcategory $\Hol_d$ defines a universal holomorphic factorization Lie algebra. Explicitly, this is the functor
%\ben
%\fg^d_c : \Hol_d \to \Lcat
%\een
%sending $X \to \fg^X_c(X)$. 
%
%In fact, there is a certain functoriality in the complex manifold that we now describe 
%
%\subsection{Central extensions from local cocycles}
%
%In this section we describe the extensions of the local Lie algebra $\fg^X$. Let $\ul{C}[k]$ be the local Lie algebra defined on any complex manifold $X$ given by the constant bundle concentrated in cohomological degree $-k$. We wish to describe extensions of a local Lie algebra $\sL$ on $X$ by the constant Lie algebra $\CC[k]$. This is a local Lie algebra $\Hat{\sL}$ that fits into an exact sequence of local Lie algebras
%\be\label{kext}
%0 \to \ul{\CC}[k] \to \Hat{\sL} \to \sL \to 0 .
%\ee
%
%Every cocycle $\alpha \in \cloc^*(\sL)(X)$ of total degree $2+k$ determines a central extension as in (\ref{kext}) as follows. The underlying vector bundle for the extended local Lie algebra is given by $L \oplus \ul{\CC
%}[k]$. 
%
%Moreover, any two cohomologous cocycles determine quasi-isomorphic extensions. 
%
%\begin{lem} The space of $k$-shifted central extensions as in Equation (\ref{kext}) is a torsor for the abelian group $H^{2+k}(\sL)(X)$. 
%\end{lem}
%
%
%\ben
%\cloc^*(\fg^X) = 
%\een
%Recall, a local $k$-cocycle of a local Lie algebra determines a $(k-2)$-shifted central extension, by the constant sheaf $\ul{\CC}$. We are interested in $(-1)$-shifted central extensions, and hence, local $1$-cocycles. 
%If $\theta$ is such a local cocycle, denote by $\fg^X_\theta$ the corresponding centrally extended local Lie algebra. 
%
%There is a particular family of local cocycles that we will be especially interested in.
%Let $P$ be an invariant polynomial of $\fg$ of homogenous degree $d+1$. 
%That is, $P \in \Sym^{d+1}(\fg^\vee)^\fg$. We can extend $P$ to a functional on $\Omega^{0,*}(X) \tensor \fg$ by the rule
%\ben
%\begin{array}{cccc}
%P^X : & \Sym^{d+1}(\Omega^{0,*}(X) \tensor \fg) & \to & \CC \\
%	 & (\omega_1 \tensor X_1,\ldots,\omega_{d+1} \tensor X_{d+1}) & \mapsto & (\omega_1\wedge \cdots \wedge \omega_{d+1}) P(X_1,\ldots,X_{d+1})
%\end{array}
%\een
%
%\begin{prop}\label{prop j map} The assignment
%\ben
%J : \Sym^{d+1} (\fg^\vee)^\fg [-1] \to \cloc^*(\fg^X)
%\een
%sending and invariant polynomial $P$, of homogeneous degree $d+1$, to the local functional 
%\ben
%(\alpha_1,\ldots, \alpha_{d+1}) \mapsto \int P^X\left(\alpha_1, \partial \alpha_2,\ldots, \partial \alpha_{d+1}\right)
%\een
%is a cochain map. Moreover, it is injective at the level of cohomology. 
%\end{prop}
%
%\begin{rmk} We extend the operator $\partial : \Omega^{k,l} \to \Omega^{k+1,l}$ to $\Omega^{0,*}(X) \tensor \fg \to \Omega^{1,*}(X)\tensor \fg$ by the operator $\partial \tensor 1$. 
%\end{rmk}
